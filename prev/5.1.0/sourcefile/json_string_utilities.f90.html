<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="JSON-Fortran â€“ A Fortran 2008 JSON API">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>json_string_utilities.F90 &ndash; JSON-Fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">JSON-Fortran <small>5.1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>json_string_utilities.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title="187.4% of total for source files.">313 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/json_string_utilities.F90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">json_string_utilities.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/json_string_utilities.html">json_string_utilities</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/json_string_utilities.f90.html#src">json_string_utilities.F90</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/jf_test_1.f90.html">jf_test_1.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_10.f90.html">jf_test_10.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_11.f90.html">jf_test_11.F90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_12.f90.html">jf_test_12.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_13.f90.html">jf_test_13.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_14.f90.html">jf_test_14.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_15.f90.html">jf_test_15.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_16.f90.html">jf_test_16.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_17.f90.html">jf_test_17.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_18.f90.html">jf_test_18.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_19.f90.html">jf_test_19.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_2.f90.html">jf_test_2.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_20.f90.html">jf_test_20.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_3.f90.html">jf_test_3.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_4.f90.html">jf_test_4.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_5.f90.html">jf_test_5.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_6.f90.html">jf_test_6.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_7.f90.html">jf_test_7.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_8.f90.html">jf_test_8.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_9.f90.html">jf_test_9.f90</a>
      
      <a class="list-group-item" href="../sourcefile/json_file_module.f90.html">json_file_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_kinds.f90.html">json_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_module.f90.html">json_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_parameters.f90.html">json_parameters.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_string_utilities.f90.html">json_string_utilities.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_value_module.f90.html">json_value_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_iso_10646_support.f90.html">test_iso_10646_support.f90</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    <div class="col-md-9" id='text'>
    
    
    <h3>This File Depends On</h3>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~json_string_utilities.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilejson_string_utilitiesf90EfferentGraph" width="406pt" height="54pt"
 viewBox="0.00 0.00 406.00 54.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~json_string_utilities.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 50)">
<title>sourcefile~~json_string_utilities.f90~~EfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-50 403,-50 403,5 -4,5"/>
<!-- sourcefile~json_string_utilities.f90 -->
<g id="node1" class="node"><title>sourcefile~json_string_utilities.f90</title>
<polygon fill="none" stroke="black" points="398,-46 274,-46 274,-20 398,-20 398,-46"/>
<text text-anchor="middle" x="336" y="-30.55" font-family="Helvetica,sans-Serif" font-size="10.50">json_string_utilities.F90</text>
</g>
<!-- sourcefile~json_kinds.f90 -->
<g id="node2" class="node"><title>sourcefile~json_kinds.f90</title>
<a xlink:href="../sourcefile/json_kinds.f90.html" xlink:title="json_kinds.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="85,-46 1,-46 1,-20 85,-20 85,-46"/>
<text text-anchor="middle" x="43" y="-30.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_kinds.F90</text>
</a>
</g>
<!-- sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_string_utilities.f90 -->
<g id="edge4" class="edge"><title>sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_string_utilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M85.6357,-34.277C97.4154,-34.576 110.202,-34.8507 122,-35 173.551,-35.6524 186.447,-35.526 238,-35 246.317,-34.9151 255.03,-34.7898 263.685,-34.6425"/>
<polygon fill="#ff0000" stroke="#ff0000" points="263.856,-38.1401 273.792,-34.4606 263.73,-31.1412 263.856,-38.1401"/>
</g>
<!-- sourcefile~json_parameters.f90 -->
<g id="node3" class="node"><title>sourcefile~json_parameters.f90</title>
<a xlink:href="../sourcefile/json_parameters.f90.html" xlink:title="json_parameters.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="237,-26 123,-26 123,-1.24345e-14 237,-3.55271e-15 237,-26"/>
<text text-anchor="middle" x="180" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_parameters.F90</text>
</a>
</g>
<!-- sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_parameters.f90 -->
<g id="edge2" class="edge"><title>sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_parameters.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M85.5967,-26.7815C94.0431,-25.5485 103.106,-24.2255 112.153,-22.9047"/>
<polygon fill="#00ffff" stroke="#00ffff" points="112.938,-26.3272 122.328,-21.4193 111.927,-19.4006 112.938,-26.3272"/>
</g>
<!-- sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_string_utilities.f90 -->
<g id="edge6" class="edge"><title>sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_string_utilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M237.645,-20.3904C246.13,-21.4781 254.959,-22.6101 263.693,-23.7299"/>
<polygon fill="#ff0000" stroke="#ff0000" points="263.511,-27.2352 273.875,-25.0353 264.402,-20.292 263.511,-27.2352"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>


<p>Solid arrows point from a file to a file which depends upon it. A file 
is dependent upon another if the latter must be compiled before the former
can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    
      
      <h3>Files Dependent On This One</h3>
      
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~json_string_utilities.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilejson_string_utilitiesf90AfferentGraph" width="641pt" height="799pt"
 viewBox="0.00 0.00 641.00 798.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~json_string_utilities.f90~~AfferentGraph" class="graph" transform="scale(0.918338 0.918338) rotate(0) translate(4 866)">
<title>sourcefile~~json_string_utilities.f90~~AfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-866 695,-866 695,5 -4,5"/>
<!-- sourcefile~json_string_utilities.f90 -->
<g id="node1" class="node"><title>sourcefile~json_string_utilities.f90</title>
<polygon fill="none" stroke="black" points="124,-444 4.9738e-14,-444 0,-418 124,-418 124,-444"/>
<text text-anchor="middle" x="62" y="-428.55" font-family="Helvetica,sans-Serif" font-size="10.50">json_string_utilities.F90</text>
</g>
<!-- sourcefile~json_file_module.f90 -->
<g id="node2" class="node"><title>sourcefile~json_file_module.f90</title>
<a xlink:href="../sourcefile/json_file_module.f90.html" xlink:title="json_file_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439,-465 325,-465 325,-439 439,-439 439,-465"/>
<text text-anchor="middle" x="382" y="-449.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_file_module.F90</text>
</a>
</g>
<!-- sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="edge48" class="edge"><title>sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.079,-435.074C178.661,-438.656 257.946,-443.859 314.178,-447.549"/>
<polygon fill="#ff0000" stroke="#ff0000" points="314.191,-451.057 324.398,-448.22 314.649,-444.072 314.191,-451.057"/>
</g>
<!-- sourcefile~json_value_module.f90 -->
<g id="node3" class="node"><title>sourcefile~json_value_module.f90</title>
<a xlink:href="../sourcefile/json_value_module.f90.html" xlink:title="json_value_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="287,-424 161,-424 161,-398 287,-398 287,-424"/>
<text text-anchor="middle" x="224" y="-408.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_value_module.F90</text>
</a>
</g>
<!-- sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_value_module.f90 -->
<g id="edge50" class="edge"><title>sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_value_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M124.17,-423.325C132.7,-422.272 141.524,-421.182 150.236,-420.107"/>
<polygon fill="#ff0000" stroke="#ff0000" points="150.892,-423.552 160.387,-418.853 150.034,-416.605 150.892,-423.552"/>
</g>
<!-- sourcefile~json_module.f90 -->
<g id="node4" class="node"><title>sourcefile~json_module.f90</title>
<a xlink:href="../sourcefile/json_module.f90.html" xlink:title="json_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="571,-444 477,-444 477,-418 571,-418 571,-444"/>
<text text-anchor="middle" x="524" y="-428.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_module.F90</text>
</a>
</g>
<!-- sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_module.f90 -->
<g id="edge42" class="edge"><title>sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.757,-443.458C448.477,-442.169 457.473,-440.839 466.194,-439.549"/>
<polygon fill="#ff0000" stroke="#ff0000" points="466.891,-442.984 476.272,-438.058 465.867,-436.059 466.891,-442.984"/>
</g>
<!-- sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="edge44" class="edge"><title>sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M274.427,-424.085C289.466,-427.988 306.101,-432.305 321.704,-436.354"/>
<polygon fill="#00ffff" stroke="#00ffff" points="321.223,-439.845 331.781,-438.969 322.981,-433.069 321.223,-439.845"/>
</g>
<!-- sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_module.f90 -->
<g id="edge46" class="edge"><title>sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_module.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M287.622,-415.241C340.401,-418.76 414.823,-423.722 465.987,-427.132"/>
<polygon fill="#00ffff" stroke="#00ffff" points="466.005,-430.641 476.215,-427.814 466.47,-423.657 466.005,-430.641"/>
</g>
<!-- sourcefile~jf_test_9.f90 -->
<g id="node5" class="node"><title>sourcefile~jf_test_9.f90</title>
<a xlink:href="../sourcefile/jf_test_9.f90.html" xlink:title="jf_test_9.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-862 614,-862 614,-836 684,-836 684,-862"/>
<text text-anchor="middle" x="649" y="-846.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_9.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_9.f90 -->
<g id="edge2" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_9.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.31,-444.232C531.62,-505.783 560.551,-763.756 608,-827 608.473,-827.63 608.969,-828.244 609.486,-828.842"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.41,-831.682 617.19,-835.755 612.085,-826.472 607.41,-831.682"/>
</g>
<!-- sourcefile~jf_test_13.f90 -->
<g id="node6" class="node"><title>sourcefile~jf_test_13.f90</title>
<a xlink:href="../sourcefile/jf_test_13.f90.html" xlink:title="jf_test_13.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-818 611,-818 611,-792 687,-792 687,-818"/>
<text text-anchor="middle" x="649" y="-802.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_13.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_13.f90 -->
<g id="edge4" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_13.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.697,-444.273C533.24,-501.592 565.256,-727.5 608,-783 608.582,-783.756 609.198,-784.489 609.843,-785.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.823,-788.081 617.675,-791.979 612.405,-782.788 607.823,-788.081"/>
</g>
<!-- sourcefile~jf_test_20.f90 -->
<g id="node7" class="node"><title>sourcefile~jf_test_20.f90</title>
<a xlink:href="../sourcefile/jf_test_20.f90.html" xlink:title="jf_test_20.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-774 611,-774 611,-748 687,-748 687,-774"/>
<text text-anchor="middle" x="649" y="-758.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_20.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_20.f90 -->
<g id="edge6" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_20.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M526.142,-444.01C534.969,-496.359 569.858,-691.082 608,-739 608.594,-739.747 609.221,-740.471 609.876,-741.174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.894,-744.083 617.777,-747.899 612.43,-738.752 607.894,-744.083"/>
</g>
<!-- sourcefile~jf_test_14.f90 -->
<g id="node8" class="node"><title>sourcefile~jf_test_14.f90</title>
<a xlink:href="../sourcefile/jf_test_14.f90.html" xlink:title="jf_test_14.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-730 611,-730 611,-704 687,-704 687,-730"/>
<text text-anchor="middle" x="649" y="-714.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_14.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_14.f90 -->
<g id="edge8" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_14.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M524.773,-444.173C527.857,-485.766 542.537,-616.196 608,-695 608.61,-695.734 609.25,-696.447 609.918,-697.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.985,-700.084 617.91,-703.791 612.463,-694.704 607.985,-700.084"/>
</g>
<!-- sourcefile~jf_test_17.f90 -->
<g id="node9" class="node"><title>sourcefile~jf_test_17.f90</title>
<a xlink:href="../sourcefile/jf_test_17.f90.html" xlink:title="jf_test_17.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-686 611,-686 611,-660 687,-660 687,-686"/>
<text text-anchor="middle" x="649" y="-670.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_17.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_17.f90 -->
<g id="edge10" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_17.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.747,-444.036C531.288,-480.809 551.56,-586.846 608,-651 608.747,-651.849 609.535,-652.671 610.357,-653.467"/>
<polygon fill="#ff0000" stroke="#ff0000" points="608.487,-656.45 618.499,-659.917 612.834,-650.963 608.487,-656.45"/>
</g>
<!-- sourcefile~jf_test_8.f90 -->
<g id="node10" class="node"><title>sourcefile~jf_test_8.f90</title>
<a xlink:href="../sourcefile/jf_test_8.f90.html" xlink:title="jf_test_8.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-642 614,-642 614,-616 684,-616 684,-642"/>
<text text-anchor="middle" x="649" y="-626.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_8.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_8.f90 -->
<g id="edge12" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_8.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.21,-444.113C535.538,-475.739 560.56,-557.267 608,-607 608.91,-607.953 609.87,-608.875 610.87,-609.764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="609.058,-612.779 619.164,-615.96 613.247,-607.171 609.058,-612.779"/>
</g>
<!-- sourcefile~jf_test_15.f90 -->
<g id="node11" class="node"><title>sourcefile~jf_test_15.f90</title>
<a xlink:href="../sourcefile/jf_test_15.f90.html" xlink:title="jf_test_15.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-598 611,-598 611,-572 687,-572 687,-598"/>
<text text-anchor="middle" x="649" y="-582.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_15.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_15.f90 -->
<g id="edge14" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_15.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M529.599,-444.168C541.054,-469.828 569.38,-527.146 608,-563 609.11,-564.031 610.277,-565.028 611.488,-565.992"/>
<polygon fill="#ff0000" stroke="#ff0000" points="609.735,-569.036 619.947,-571.858 613.724,-563.284 609.735,-569.036"/>
</g>
<!-- sourcefile~jf_test_5.f90 -->
<g id="node12" class="node"><title>sourcefile~jf_test_5.f90</title>
<a xlink:href="../sourcefile/jf_test_5.f90.html" xlink:title="jf_test_5.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-554 614,-554 614,-528 684,-528 684,-554"/>
<text text-anchor="middle" x="649" y="-538.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_5.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_5.f90 -->
<g id="edge16" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_5.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.311,-444.189C549.16,-462.581 578.084,-496.231 608,-519 609.591,-520.211 611.257,-521.393 612.97,-522.541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="611.431,-525.704 621.781,-527.969 615.103,-519.744 611.431,-525.704"/>
</g>
<!-- sourcefile~jf_test_16.f90 -->
<g id="node13" class="node"><title>sourcefile~jf_test_16.f90</title>
<a xlink:href="../sourcefile/jf_test_16.f90.html" xlink:title="jf_test_16.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-510 611,-510 611,-484 687,-484 687,-510"/>
<text text-anchor="middle" x="649" y="-494.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_16.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_16.f90 -->
<g id="edge18" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_16.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M548.696,-444.039C567.785,-454.119 594.411,-468.177 615.433,-479.277"/>
<polygon fill="#ff0000" stroke="#ff0000" points="613.878,-482.414 624.355,-483.988 617.146,-476.223 613.878,-482.414"/>
</g>
<!-- sourcefile~jf_test_2.f90 -->
<g id="node14" class="node"><title>sourcefile~jf_test_2.f90</title>
<a xlink:href="../sourcefile/jf_test_2.f90.html" xlink:title="jf_test_2.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-466 614,-466 614,-440 684,-440 684,-466"/>
<text text-anchor="middle" x="649" y="-450.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_2.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_2.f90 -->
<g id="edge20" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_2.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M571.614,-439.38C581.963,-441.201 592.89,-443.125 603.169,-444.934"/>
<polygon fill="#ff0000" stroke="#ff0000" points="602.73,-448.41 613.185,-446.697 603.943,-441.516 602.73,-448.41"/>
</g>
<!-- sourcefile~jf_test_7.f90 -->
<g id="node15" class="node"><title>sourcefile~jf_test_7.f90</title>
<a xlink:href="../sourcefile/jf_test_7.f90.html" xlink:title="jf_test_7.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-422 614,-422 614,-396 684,-396 684,-422"/>
<text text-anchor="middle" x="649" y="-406.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_7.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_7.f90 -->
<g id="edge22" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_7.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M571.614,-422.62C581.963,-420.799 592.89,-418.875 603.169,-417.066"/>
<polygon fill="#ff0000" stroke="#ff0000" points="603.943,-420.484 613.185,-415.303 602.73,-413.59 603.943,-420.484"/>
</g>
<!-- sourcefile~jf_test_1.f90 -->
<g id="node16" class="node"><title>sourcefile~jf_test_1.f90</title>
<a xlink:href="../sourcefile/jf_test_1.f90.html" xlink:title="jf_test_1.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-378 614,-378 614,-352 684,-352 684,-378"/>
<text text-anchor="middle" x="649" y="-362.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_1.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_1.f90 -->
<g id="edge24" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_1.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M548.696,-417.961C567.785,-407.881 594.411,-393.823 615.433,-382.723"/>
<polygon fill="#ff0000" stroke="#ff0000" points="617.146,-385.777 624.355,-378.012 613.878,-379.586 617.146,-385.777"/>
</g>
<!-- sourcefile~jf_test_4.f90 -->
<g id="node17" class="node"><title>sourcefile~jf_test_4.f90</title>
<a xlink:href="../sourcefile/jf_test_4.f90.html" xlink:title="jf_test_4.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-334 614,-334 614,-308 684,-308 684,-334"/>
<text text-anchor="middle" x="649" y="-318.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_4.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_4.f90 -->
<g id="edge26" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_4.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M534.311,-417.811C549.16,-399.419 578.084,-365.769 608,-343 609.591,-341.789 611.257,-340.607 612.97,-339.459"/>
<polygon fill="#ff0000" stroke="#ff0000" points="615.103,-342.256 621.781,-334.031 611.431,-336.296 615.103,-342.256"/>
</g>
<!-- sourcefile~jf_test_10.f90 -->
<g id="node18" class="node"><title>sourcefile~jf_test_10.f90</title>
<a xlink:href="../sourcefile/jf_test_10.f90.html" xlink:title="jf_test_10.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-290 611,-290 611,-264 687,-264 687,-290"/>
<text text-anchor="middle" x="649" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_10.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_10.f90 -->
<g id="edge28" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_10.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M529.599,-417.832C541.054,-392.172 569.38,-334.854 608,-299 609.11,-297.969 610.277,-296.972 611.488,-296.008"/>
<polygon fill="#ff0000" stroke="#ff0000" points="613.724,-298.716 619.947,-290.142 609.735,-292.964 613.724,-298.716"/>
</g>
<!-- sourcefile~jf_test_19.f90 -->
<g id="node19" class="node"><title>sourcefile~jf_test_19.f90</title>
<a xlink:href="../sourcefile/jf_test_19.f90.html" xlink:title="jf_test_19.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-246 611,-246 611,-220 687,-220 687,-246"/>
<text text-anchor="middle" x="649" y="-230.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_19.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_19.f90 -->
<g id="edge30" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_19.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M527.21,-417.887C535.538,-386.261 560.56,-304.733 608,-255 608.91,-254.047 609.87,-253.125 610.87,-252.236"/>
<polygon fill="#ff0000" stroke="#ff0000" points="613.247,-254.829 619.164,-246.04 609.058,-249.221 613.247,-254.829"/>
</g>
<!-- sourcefile~jf_test_6.f90 -->
<g id="node20" class="node"><title>sourcefile~jf_test_6.f90</title>
<a xlink:href="../sourcefile/jf_test_6.f90.html" xlink:title="jf_test_6.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-202 614,-202 614,-176 684,-176 684,-202"/>
<text text-anchor="middle" x="649" y="-186.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_6.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_6.f90 -->
<g id="edge32" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_6.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.747,-417.964C531.288,-381.191 551.56,-275.154 608,-211 608.747,-210.151 609.535,-209.329 610.357,-208.533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.834,-211.037 618.499,-202.083 608.487,-205.55 612.834,-211.037"/>
</g>
<!-- sourcefile~jf_test_11.f90 -->
<g id="node21" class="node"><title>sourcefile~jf_test_11.f90</title>
<a xlink:href="../sourcefile/jf_test_11.f90.html" xlink:title="jf_test_11.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="689,-158 609,-158 609,-132 689,-132 689,-158"/>
<text text-anchor="middle" x="649" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_11.F90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_11.f90 -->
<g id="edge34" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_11.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M524.773,-417.827C527.857,-376.234 542.537,-245.804 608,-167 608.61,-166.266 609.25,-165.553 609.918,-164.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.463,-167.296 617.91,-158.209 607.985,-161.916 612.463,-167.296"/>
</g>
<!-- sourcefile~jf_test_3.f90 -->
<g id="node22" class="node"><title>sourcefile~jf_test_3.f90</title>
<a xlink:href="../sourcefile/jf_test_3.f90.html" xlink:title="jf_test_3.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="684,-114 614,-114 614,-88 684,-88 684,-114"/>
<text text-anchor="middle" x="649" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_3.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_3.f90 -->
<g id="edge36" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_3.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M526.142,-417.99C534.969,-365.641 569.858,-170.918 608,-123 608.594,-122.253 609.221,-121.529 609.876,-120.826"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.43,-123.248 617.777,-114.101 607.894,-117.917 612.43,-123.248"/>
</g>
<!-- sourcefile~jf_test_12.f90 -->
<g id="node23" class="node"><title>sourcefile~jf_test_12.f90</title>
<a xlink:href="../sourcefile/jf_test_12.f90.html" xlink:title="jf_test_12.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-70 611,-70 611,-44 687,-44 687,-70"/>
<text text-anchor="middle" x="649" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_12.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_12.f90 -->
<g id="edge38" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_12.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.697,-417.727C533.24,-360.408 565.256,-134.5 608,-79 608.582,-78.244 609.198,-77.5109 609.843,-76.8003"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.405,-79.2121 617.675,-70.021 607.823,-73.9195 612.405,-79.2121"/>
</g>
<!-- sourcefile~jf_test_18.f90 -->
<g id="node24" class="node"><title>sourcefile~jf_test_18.f90</title>
<a xlink:href="../sourcefile/jf_test_18.f90.html" xlink:title="jf_test_18.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="687,-26 611,-26 611,-1.24345e-14 687,-3.55271e-15 687,-26"/>
<text text-anchor="middle" x="649" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_18.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_18.f90 -->
<g id="edge40" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_18.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.31,-417.768C531.62,-356.217 560.551,-98.2439 608,-35 608.473,-34.37 608.969,-33.7561 609.486,-33.1579"/>
<polygon fill="#ff0000" stroke="#ff0000" points="612.085,-35.5283 617.19,-26.2446 607.41,-30.3184 612.085,-35.5283"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilejson_string_utilitiesf90AfferentGraph = svgPanZoom('#sourcefilejson_string_utilitiesf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>


<p>Solid arrows point from a file to a file which depends upon it. A file 
is dependent upon another if the latter must be compiled before the former
can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
</p>

                      </div>
                    </div>
                  </div>
                </div>
                
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/json_string_utilities.html">json_string_utilities</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/json_string_utilities.f90.html#src">json_string_utilities.F90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-3"></a><span class="c">!  license: BSD</span>
<a name="ln-4"></a><span class="c">!</span>
<a name="ln-5"></a><span class="c">!  JSON-Fortran support module for string manipulation.</span>
<a name="ln-6"></a><span class="c">!</span>
<a name="ln-7"></a><span class="c">!## License</span>
<a name="ln-8"></a><span class="c">!  * JSON-Fortran is released under a BSD-style license.</span>
<a name="ln-9"></a><span class="c">!    See the [LICENSE](https://github.com/jacobwilliams/json-fortran/blob/master/LICENSE)</span>
<a name="ln-10"></a><span class="c">!    file for details.</span>
<a name="ln-11"></a>
<a name="ln-12"></a>    <span class="k">module </span><span class="n">json_string_utilities</span>
<a name="ln-13"></a>
<a name="ln-14"></a>    <span class="k">use </span><span class="n">json_kinds</span>
<a name="ln-15"></a>    <span class="k">use </span><span class="n">json_parameters</span>
<a name="ln-16"></a>
<a name="ln-17"></a>    <span class="k">implicit none</span>
<a name="ln-18"></a>
<a name="ln-19"></a><span class="k">    private</span>
<a name="ln-20"></a>
<a name="ln-21"></a>    <span class="c">!******************************************************</span>
<a name="ln-22"></a>    <span class="c">!&gt;</span>
<a name="ln-23"></a>    <span class="c">!  Convert a &#39;DEFAULT&#39; kind character input to</span>
<a name="ln-24"></a>    <span class="c">!  &#39;ISO_10646&#39; kind and return it</span>
<a name="ln-25"></a>    <span class="k">interface </span><span class="n">to_unicode</span>
<a name="ln-26"></a>        <span class="k">module procedure </span><span class="n">to_uni</span><span class="p">,</span> <span class="n">to_uni_vec</span>
<a name="ln-27"></a>    <span class="k">end interface</span>
<a name="ln-28"></a>    <span class="c">!******************************************************</span>
<a name="ln-29"></a>
<a name="ln-30"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-31"></a>    <span class="c">!******************************************************</span>
<a name="ln-32"></a>    <span class="c">!&gt;</span>
<a name="ln-33"></a>    <span class="c">! Provide a means to convert to UCS4 while</span>
<a name="ln-34"></a>    <span class="c">! concatenating UCS4 and default strings</span>
<a name="ln-35"></a>    <span class="k">interface </span><span class="n">operator</span><span class="p">(</span><span class="o">//</span><span class="p">)</span>
<a name="ln-36"></a>       <span class="k">module procedure </span><span class="n">ucs4_join_default</span><span class="p">,</span> <span class="n">default_join_ucs4</span>
<a name="ln-37"></a>    <span class="k">end interface</span>
<a name="ln-38"></a><span class="k">    public</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">//</span><span class="p">)</span>
<a name="ln-39"></a>    <span class="c">!******************************************************</span>
<a name="ln-40"></a>
<a name="ln-41"></a>    <span class="c">!******************************************************</span>
<a name="ln-42"></a>    <span class="c">!&gt;</span>
<a name="ln-43"></a>    <span class="c">! Provide a string `==` operator that works</span>
<a name="ln-44"></a>    <span class="c">! with mixed kinds</span>
<a name="ln-45"></a>    <span class="k">interface </span><span class="n">operator</span><span class="p">(</span><span class="o">==</span><span class="p">)</span>
<a name="ln-46"></a>       <span class="k">module procedure </span><span class="n">ucs4_comp_default</span><span class="p">,</span> <span class="n">default_comp_ucs4</span>
<a name="ln-47"></a>    <span class="k">end interface</span>
<a name="ln-48"></a><span class="k">    public</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">==</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="c">!******************************************************</span>
<a name="ln-50"></a>
<a name="ln-51"></a>    <span class="c">!******************************************************</span>
<a name="ln-52"></a>    <span class="c">!&gt;</span>
<a name="ln-53"></a>    <span class="c">! Provide a string `/=` operator that works</span>
<a name="ln-54"></a>    <span class="c">! with mixed kinds</span>
<a name="ln-55"></a>    <span class="k">interface </span><span class="n">operator</span><span class="p">(</span><span class="o">/=</span><span class="p">)</span>
<a name="ln-56"></a>       <span class="k">module procedure </span><span class="n">ucs4_neq_default</span><span class="p">,</span> <span class="n">default_neq_ucs4</span>
<a name="ln-57"></a>    <span class="k">end interface</span>
<a name="ln-58"></a><span class="k">    public</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(</span><span class="o">/=</span><span class="p">)</span>
<a name="ln-59"></a>    <span class="c">!******************************************************</span>
<a name="ln-60"></a><span class="cp">#endif</span>
<a name="ln-61"></a>
<a name="ln-62"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">integer_to_string</span>
<a name="ln-63"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">real_to_string</span>
<a name="ln-64"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">valid_json_hex</span>
<a name="ln-65"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">to_unicode</span>
<a name="ln-66"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">escape_string</span>
<a name="ln-67"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">unescape_string</span>
<a name="ln-68"></a>    <span class="k">public</span> <span class="kd">::</span> <span class="n">lowercase_string</span>
<a name="ln-69"></a>
<a name="ln-70"></a>    <span class="k">contains</span>
<a name="ln-71"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-74"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-75"></a><span class="c">!  date: 12/4/2013</span>
<a name="ln-76"></a><span class="c">!</span>
<a name="ln-77"></a><span class="c">!  Convert an integer to a string.</span>
<a name="ln-78"></a>
<a name="ln-79"></a>    <span class="k">pure subroutine </span><span class="n">integer_to_string</span><span class="p">(</span><span class="n">ival</span><span class="p">,</span><span class="n">int_fmt</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="k">implicit none</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="k">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">ival</span>    <span class="c">!! integer value.</span>
<a name="ln-84"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">int_fmt</span> <span class="c">!! format for integers</span>
<a name="ln-85"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>     <span class="c">!! `ival` converted to a string.</span>
<a name="ln-86"></a>
<a name="ln-87"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-88"></a>
<a name="ln-89"></a>    <span class="k">write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">int_fmt</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span> <span class="n">ival</span>
<a name="ln-90"></a>
<a name="ln-91"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istat</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-92"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-93"></a>    <span class="k">else</span>
<a name="ln-94"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">star</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>
<a name="ln-95"></a>    <span class="k">end if</span>
<a name="ln-96"></a>
<a name="ln-97"></a><span class="k">    end subroutine </span><span class="n">integer_to_string</span>
<a name="ln-98"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-99"></a>
<a name="ln-100"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-101"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-102"></a><span class="c">!  date: 12/4/2013</span>
<a name="ln-103"></a><span class="c">!</span>
<a name="ln-104"></a><span class="c">!  Convert a real value to a string.</span>
<a name="ln-105"></a><span class="c">!</span>
<a name="ln-106"></a><span class="c">!# Modified</span>
<a name="ln-107"></a><span class="c">!  * Izaak Beekman : 02/24/2015 : added the compact option.</span>
<a name="ln-108"></a><span class="c">!  * Jacob Williams : 10/27/2015 : added the star option.</span>
<a name="ln-109"></a>
<a name="ln-110"></a>    <span class="k">subroutine </span><span class="n">real_to_string</span><span class="p">(</span><span class="n">rval</span><span class="p">,</span><span class="n">real_fmt</span><span class="p">,</span><span class="n">compact_real</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-111"></a>
<a name="ln-112"></a>    <span class="k">implicit none</span>
<a name="ln-113"></a>
<a name="ln-114"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">rval</span>         <span class="c">!! real value.</span>
<a name="ln-115"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">real_fmt</span>     <span class="c">!! format for real numbers</span>
<a name="ln-116"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">compact_real</span> <span class="c">!! compact the string so that it is</span>
<a name="ln-117"></a>                                                         <span class="c">!! displayed with fewer characters</span>
<a name="ln-118"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>          <span class="c">!! `rval` converted to a string.</span>
<a name="ln-119"></a>
<a name="ln-120"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-121"></a>
<a name="ln-122"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">real_fmt</span><span class="o">==</span><span class="n">star</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-123"></a><span class="k">        write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">fmt</span><span class="o">=*</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span> <span class="n">rval</span>
<a name="ln-124"></a>    <span class="k">else</span>
<a name="ln-125"></a><span class="k">        write</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="n">real_fmt</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span> <span class="n">rval</span>
<a name="ln-126"></a>    <span class="k">end if</span>
<a name="ln-127"></a>
<a name="ln-128"></a><span class="k">    if</span> <span class="p">(</span><span class="n">istat</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-129"></a>        <span class="c">!in this case, the default string will be compacted,</span>
<a name="ln-130"></a>        <span class="c">! so that the same value is displayed with fewer characters.</span>
<a name="ln-131"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">compact_real</span><span class="p">)</span> <span class="k">call </span><span class="n">compact_real_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-132"></a>    <span class="k">else</span>
<a name="ln-133"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">star</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>
<a name="ln-134"></a>    <span class="k">end if</span>
<a name="ln-135"></a>
<a name="ln-136"></a><span class="k">    end subroutine </span><span class="n">real_to_string</span>
<a name="ln-137"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-138"></a>
<a name="ln-139"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-140"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-141"></a><span class="c">!  date: 02/24/2015</span>
<a name="ln-142"></a><span class="c">!</span>
<a name="ln-143"></a><span class="c">!  Compact a string representing a real number, so that</span>
<a name="ln-144"></a><span class="c">!  the same value is displayed with fewer characters.</span>
<a name="ln-145"></a><span class="c">!</span>
<a name="ln-146"></a><span class="c">!# See also</span>
<a name="ln-147"></a><span class="c">!  * [[real_to_string]]</span>
<a name="ln-148"></a>
<a name="ln-149"></a>    <span class="k">subroutine </span><span class="n">compact_real_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-150"></a>
<a name="ln-151"></a>    <span class="k">implicit none</span>
<a name="ln-152"></a>
<a name="ln-153"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string representation of a real number.</span>
<a name="ln-154"></a>
<a name="ln-155"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">significand</span>
<a name="ln-156"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">expnt</span>
<a name="ln-157"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="kd">::</span> <span class="n">separator</span>
<a name="ln-158"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">exp_start</span>
<a name="ln-159"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">decimal_pos</span>
<a name="ln-160"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sig_trim</span>
<a name="ln-161"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">exp_trim</span>
<a name="ln-162"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>  <span class="c">!! counter</span>
<a name="ln-163"></a>
<a name="ln-164"></a>    <span class="n">str</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-165"></a>    <span class="n">exp_start</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">CK_</span><span class="s1">&#39;eEdD&#39;</span><span class="p">)</span>
<a name="ln-166"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">exp_start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">exp_start</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">CK_</span><span class="s1">&#39;-+&#39;</span><span class="p">,</span><span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-167"></a>    <span class="n">decimal_pos</span> <span class="o">=</span> <span class="nb">scan</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">CK_</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-168"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">exp_start</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">separator</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="n">exp_start</span><span class="p">:</span><span class="n">exp_start</span><span class="p">)</span>
<a name="ln-169"></a>
<a name="ln-170"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">exp_start</span> <span class="o">&lt;</span> <span class="n">decimal_pos</span> <span class="p">)</span> <span class="k">then</span> <span class="c">!possibly signed, exponent-less float</span>
<a name="ln-171"></a>
<a name="ln-172"></a>        <span class="n">significand</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-173"></a>        <span class="n">sig_trim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">significand</span><span class="p">))</span>
<a name="ln-174"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">significand</span><span class="p">)),</span><span class="n">decimal_pos</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="c">!look from right to left at 0s</span>
<a name="ln-175"></a>                                                       <span class="c">!but save one after the decimal place</span>
<a name="ln-176"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-177"></a><span class="k">                </span><span class="n">sig_trim</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-178"></a>            <span class="k">else</span>
<a name="ln-179"></a><span class="k">                exit</span>
<a name="ln-180"></a><span class="k">            end if</span>
<a name="ln-181"></a><span class="k">        end do</span>
<a name="ln-182"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">sig_trim</span><span class="p">))</span>
<a name="ln-183"></a>
<a name="ln-184"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">exp_start</span> <span class="o">&gt;</span> <span class="n">decimal_pos</span><span class="p">)</span> <span class="k">then</span> <span class="c">!float has exponent</span>
<a name="ln-185"></a>
<a name="ln-186"></a>        <span class="n">significand</span> <span class="o">=</span> <span class="n">str</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">exp_start</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-187"></a>        <span class="n">sig_trim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">significand</span><span class="p">))</span>
<a name="ln-188"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">significand</span><span class="p">)),</span><span class="n">decimal_pos</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="c">!look from right to left at 0s</span>
<a name="ln-189"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-190"></a><span class="k">                </span><span class="n">sig_trim</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-191"></a>            <span class="k">else</span>
<a name="ln-192"></a><span class="k">                exit</span>
<a name="ln-193"></a><span class="k">            end if</span>
<a name="ln-194"></a><span class="k">        end do</span>
<a name="ln-195"></a><span class="k">        </span><span class="n">expnt</span> <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">exp_start</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-196"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">expnt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">expnt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-197"></a><span class="k">            </span><span class="n">separator</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">separator</span><span class="p">))</span><span class="o">//</span><span class="n">expnt</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-198"></a>            <span class="n">exp_start</span> <span class="o">=</span> <span class="n">exp_start</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-199"></a>            <span class="n">expnt</span>     <span class="o">=</span> <span class="nb">adjustl</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">exp_start</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span>
<a name="ln-200"></a>        <span class="k">end if</span>
<a name="ln-201"></a><span class="k">        </span><span class="n">exp_trim</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-202"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,(</span><span class="nb">len</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">expnt</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!look at exponent leading zeros saving last</span>
<a name="ln-203"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">expnt</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-204"></a><span class="k">                </span><span class="n">exp_trim</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-205"></a>            <span class="k">else</span>
<a name="ln-206"></a><span class="k">                exit</span>
<a name="ln-207"></a><span class="k">            end if</span>
<a name="ln-208"></a><span class="k">        end do</span>
<a name="ln-209"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">significand</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">sig_trim</span><span class="p">)))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-210"></a>              <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">separator</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-211"></a>              <span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">expnt</span><span class="p">(</span><span class="n">exp_trim</span><span class="p">:)))</span>
<a name="ln-212"></a>
<a name="ln-213"></a>    <span class="c">!else ! mal-formed real, BUT this code should be unreachable</span>
<a name="ln-214"></a>
<a name="ln-215"></a>    <span class="k">end if</span>
<a name="ln-216"></a>
<a name="ln-217"></a><span class="k">    end subroutine </span><span class="n">compact_real_string</span>
<a name="ln-218"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-219"></a>
<a name="ln-220"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-221"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-222"></a><span class="c">!  date: 1/21/2014</span>
<a name="ln-223"></a><span class="c">!</span>
<a name="ln-224"></a><span class="c">!  Add the escape characters to a string for adding to JSON.</span>
<a name="ln-225"></a>
<a name="ln-226"></a>    <span class="k">subroutine </span><span class="n">escape_string</span><span class="p">(</span><span class="n">str_in</span><span class="p">,</span> <span class="n">str_out</span><span class="p">)</span>
<a name="ln-227"></a>
<a name="ln-228"></a>    <span class="k">implicit none</span>
<a name="ln-229"></a>
<a name="ln-230"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">str_in</span>
<a name="ln-231"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str_out</span>
<a name="ln-232"></a>
<a name="ln-233"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>    <span class="c">!! counter</span>
<a name="ln-234"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ipos</span> <span class="c">!! accumulated string size</span>
<a name="ln-235"></a>                        <span class="c">!! (so we can allocate it in chunks for</span>
<a name="ln-236"></a>                        <span class="c">!! greater runtime efficiency)</span>
<a name="ln-237"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>  <span class="c">!! for reading `str_in` one character at a time.</span>
<a name="ln-238"></a><span class="cp">#if defined __GFORTRAN__</span>
<a name="ln-239"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tmp</span> <span class="c">!! workaround for bug in gfortran 6.1</span>
<a name="ln-240"></a><span class="cp">#endif</span>
<a name="ln-241"></a>
<a name="ln-242"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">specials</span> <span class="o">=</span> <span class="n">quotation_mark</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-243"></a>                                                     <span class="n">backslash</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-244"></a>                                                     <span class="n">slash</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-245"></a>                                                     <span class="n">bspace</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-246"></a>                                                     <span class="n">formfeed</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-247"></a>                                                     <span class="n">newline</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-248"></a>                                                     <span class="n">carriage_return</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-249"></a>                                                     <span class="n">horizontal_tab</span>
<a name="ln-250"></a>
<a name="ln-251"></a>    <span class="c">!Do a quick scan for the special characters,</span>
<a name="ln-252"></a>    <span class="c">! if any are present, then process the string,</span>
<a name="ln-253"></a>    <span class="c">! otherwise, return the string as is.</span>
<a name="ln-254"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">scan</span><span class="p">(</span><span class="n">str_in</span><span class="p">,</span><span class="n">specials</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="k">        </span><span class="n">str_out</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">chunk_size</span><span class="p">)</span>
<a name="ln-257"></a>        <span class="n">ipos</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-258"></a>
<a name="ln-259"></a>        <span class="c">!go through the string and look for special characters:</span>
<a name="ln-260"></a>        <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">str_in</span><span class="p">)</span>
<a name="ln-261"></a>
<a name="ln-262"></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">str_in</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>    <span class="c">!get next character in the input string</span>
<a name="ln-263"></a>
<a name="ln-264"></a>            <span class="c">!if the string is not big enough, then add another chunk:</span>
<a name="ln-265"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span><span class="o">+</span><span class="mi">3</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">str_out</span><span class="p">))</span> <span class="n">str_out</span> <span class="o">=</span> <span class="n">str_out</span> <span class="o">//</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
<a name="ln-266"></a>
<a name="ln-267"></a>            <span class="k">select case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-268"></a>            <span class="k">case</span><span class="p">(</span><span class="n">quotation_mark</span><span class="p">,</span><span class="n">backslash</span><span class="p">,</span><span class="n">slash</span><span class="p">)</span>
<a name="ln-269"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">backslash</span><span class="o">//</span><span class="n">c</span>
<a name="ln-270"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-271"></a>            <span class="k">case</span><span class="p">(</span><span class="n">bspace</span><span class="p">)</span>
<a name="ln-272"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;\b&#39;</span>
<a name="ln-273"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-274"></a>            <span class="k">case</span><span class="p">(</span><span class="n">formfeed</span><span class="p">)</span>
<a name="ln-275"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;\f&#39;</span>
<a name="ln-276"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-277"></a>            <span class="k">case</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span>
<a name="ln-278"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;\n&#39;</span>
<a name="ln-279"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-280"></a>            <span class="k">case</span><span class="p">(</span><span class="n">carriage_return</span><span class="p">)</span>
<a name="ln-281"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;\r&#39;</span>
<a name="ln-282"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-283"></a>            <span class="k">case</span><span class="p">(</span><span class="n">horizontal_tab</span><span class="p">)</span>
<a name="ln-284"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;\t&#39;</span>
<a name="ln-285"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-286"></a>            <span class="k">case </span><span class="n">default</span>
<a name="ln-287"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">ipos</span><span class="p">:</span><span class="n">ipos</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span>
<a name="ln-288"></a>                <span class="n">ipos</span> <span class="o">=</span> <span class="n">ipos</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-289"></a>            <span class="k">end select</span>
<a name="ln-290"></a>
<a name="ln-291"></a><span class="k">        end do</span>
<a name="ln-292"></a>
<a name="ln-293"></a>        <span class="c">!trim the string if necessary:</span>
<a name="ln-294"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ipos</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">str_out</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-295"></a><span class="k">            if</span> <span class="p">(</span><span class="n">ipos</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-296"></a><span class="k">                </span><span class="n">str_out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-297"></a>            <span class="k">else</span>
<a name="ln-298"></a><span class="cp">#if defined __GFORTRAN__</span>
<a name="ln-299"></a>                <span class="n">tmp</span> <span class="o">=</span> <span class="n">str_out</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>      <span class="c">!workaround for bug in gfortran 6.1</span>
<a name="ln-300"></a>                <span class="n">str_out</span> <span class="o">=</span> <span class="n">tmp</span>
<a name="ln-301"></a><span class="cp">#else</span>
<a name="ln-302"></a>                <span class="n">str_out</span> <span class="o">=</span> <span class="n">str_out</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ipos</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c">!original</span>
<a name="ln-303"></a><span class="cp">#endif</span>
<a name="ln-304"></a>            <span class="k">end if</span>
<a name="ln-305"></a><span class="k">        end if</span>
<a name="ln-306"></a>
<a name="ln-307"></a><span class="k">    else</span>
<a name="ln-308"></a>
<a name="ln-309"></a><span class="k">        </span><span class="n">str_out</span> <span class="o">=</span> <span class="n">str_in</span>
<a name="ln-310"></a>
<a name="ln-311"></a>    <span class="k">end if</span>
<a name="ln-312"></a>
<a name="ln-313"></a><span class="k">    end subroutine </span><span class="n">escape_string</span>
<a name="ln-314"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-315"></a>
<a name="ln-316"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-317"></a><span class="c">!&gt;</span>
<a name="ln-318"></a><span class="c">!  Remove the escape characters from a JSON string and return it.</span>
<a name="ln-319"></a><span class="c">!</span>
<a name="ln-320"></a><span class="c">!  The escaped characters are denoted by the &#39;\&#39; character:</span>
<a name="ln-321"></a><span class="c">!````</span>
<a name="ln-322"></a><span class="c">!    &#39;\&quot;&#39;        quotation mark</span>
<a name="ln-323"></a><span class="c">!    &#39;\\&#39;        reverse solidus</span>
<a name="ln-324"></a><span class="c">!    &#39;\/&#39;        solidus</span>
<a name="ln-325"></a><span class="c">!    &#39;\b&#39;        backspace</span>
<a name="ln-326"></a><span class="c">!    &#39;\f&#39;        formfeed</span>
<a name="ln-327"></a><span class="c">!    &#39;\n&#39;        newline (LF)</span>
<a name="ln-328"></a><span class="c">!    &#39;\r&#39;        carriage return (CR)</span>
<a name="ln-329"></a><span class="c">!    &#39;\t&#39;        horizontal tab</span>
<a name="ln-330"></a><span class="c">!    &#39;\uXXXX&#39;    4 hexadecimal digits</span>
<a name="ln-331"></a><span class="c">!````</span>
<a name="ln-332"></a>
<a name="ln-333"></a>    <span class="k">subroutine </span><span class="n">unescape_string</span><span class="p">(</span><span class="n">str_in</span><span class="p">,</span> <span class="n">str_out</span><span class="p">,</span> <span class="n">error_message</span><span class="p">)</span>
<a name="ln-334"></a>
<a name="ln-335"></a>    <span class="k">implicit none</span>
<a name="ln-336"></a>
<a name="ln-337"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">str_in</span>  <span class="c">!! string as stored in a [[json_value]]</span>
<a name="ln-338"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str_out</span> <span class="c">!! decoded string</span>
<a name="ln-339"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">error_message</span> <span class="c">!! will be allocated if there was an error</span>
<a name="ln-340"></a>
<a name="ln-341"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>   <span class="c">!! counter</span>
<a name="ln-342"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>   <span class="c">!! length of str_in</span>
<a name="ln-343"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">m</span>   <span class="c">!! length of str_out</span>
<a name="ln-344"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>  <span class="c">!! for scanning each character in string</span>
<a name="ln-345"></a>
<a name="ln-346"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">scan</span><span class="p">(</span><span class="n">str_in</span><span class="p">,</span><span class="n">backslash</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-347"></a>
<a name="ln-348"></a>        <span class="c">!there is at least one escape character, so process this string:</span>
<a name="ln-349"></a>
<a name="ln-350"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_in</span><span class="p">)</span>
<a name="ln-351"></a>        <span class="n">str_out</span> <span class="o">=</span> <span class="nb">repeat</span><span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="c">!size the output string (will be trimmed later)</span>
<a name="ln-352"></a>        <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!counter in str_out</span>
<a name="ln-353"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!counter in str_in</span>
<a name="ln-354"></a>
<a name="ln-355"></a>        <span class="k">do</span>
<a name="ln-356"></a>
<a name="ln-357"></a><span class="k">            </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-358"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="n">n</span><span class="p">)</span> <span class="k">exit</span> <span class="c">! finished</span>
<a name="ln-359"></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">str_in</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="c">! get next character in the string</span>
<a name="ln-360"></a>
<a name="ln-361"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">backslash</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-362"></a>
<a name="ln-363"></a><span class="k">                if</span> <span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-364"></a>
<a name="ln-365"></a><span class="k">                    </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-366"></a>                    <span class="n">c</span> <span class="o">=</span> <span class="n">str_in</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="c">!character after the escape</span>
<a name="ln-367"></a>
<a name="ln-368"></a>                    <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="p">[</span><span class="n">quotation_mark</span><span class="p">,</span><span class="n">backslash</span><span class="p">,</span><span class="n">slash</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-369"></a>                         <span class="n">to_unicode</span><span class="p">([</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">])]))</span> <span class="k">then</span>
<a name="ln-370"></a>
<a name="ln-371"></a><span class="k">                        select case</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a name="ln-372"></a>                        <span class="k">case</span> <span class="p">(</span><span class="n">quotation_mark</span><span class="p">,</span><span class="n">backslash</span><span class="p">,</span><span class="n">slash</span><span class="p">)</span>
<a name="ln-373"></a>                            <span class="c">!use d as is</span>
<a name="ln-374"></a>                        <span class="k">case</span> <span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<a name="ln-375"></a>                             <span class="n">c</span> <span class="o">=</span> <span class="n">bspace</span>
<a name="ln-376"></a>                        <span class="k">case</span> <span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<a name="ln-377"></a>                             <span class="n">c</span> <span class="o">=</span> <span class="n">formfeed</span>
<a name="ln-378"></a>                        <span class="k">case</span> <span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<a name="ln-379"></a>                             <span class="n">c</span> <span class="o">=</span> <span class="n">newline</span>
<a name="ln-380"></a>                        <span class="k">case</span> <span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<a name="ln-381"></a>                             <span class="n">c</span> <span class="o">=</span> <span class="n">carriage_return</span>
<a name="ln-382"></a>                        <span class="k">case</span> <span class="p">(</span><span class="n">CK_</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<a name="ln-383"></a>                             <span class="n">c</span> <span class="o">=</span> <span class="n">horizontal_tab</span>
<a name="ln-384"></a>                        <span class="k">end select</span>
<a name="ln-385"></a>
<a name="ln-386"></a><span class="k">                        </span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-387"></a>                        <span class="n">str_out</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span>
<a name="ln-388"></a>
<a name="ln-389"></a>                    <span class="k">else if</span> <span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span> <span class="k">then</span> <span class="c">!expecting 4 hexadecimal digits after</span>
<a name="ln-390"></a>                                            <span class="c">!the escape character    [\uXXXX]</span>
<a name="ln-391"></a>
<a name="ln-392"></a>                        <span class="c">!for now, we are just returning them as is</span>
<a name="ln-393"></a>                        <span class="c">![not checking to see if it is a valid hex value]</span>
<a name="ln-394"></a>                        <span class="c">!</span>
<a name="ln-395"></a>                        <span class="c">! Example:</span>
<a name="ln-396"></a>                        <span class="c">!   123456</span>
<a name="ln-397"></a>                        <span class="c">!   \uXXXX</span>
<a name="ln-398"></a>
<a name="ln-399"></a>                        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-400"></a><span class="k">                            </span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-401"></a>                            <span class="n">str_out</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="n">m</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">str_in</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-402"></a>                            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span>
<a name="ln-403"></a>                            <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">5</span>
<a name="ln-404"></a>                        <span class="k">else</span>
<a name="ln-405"></a><span class="k">                            </span><span class="n">error_message</span> <span class="o">=</span> <span class="s1">&#39;Error in unescape_string:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-406"></a>                                                 <span class="s1">&#39; Invalid hexadecimal sequence&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-407"></a>                                                 <span class="s1">&#39; in string: &#39;</span><span class="o">//</span><span class="n">str_in</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:)</span>
<a name="ln-408"></a>                            <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">str_out</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">str_out</span><span class="p">)</span>
<a name="ln-409"></a>                            <span class="k">return</span>
<a name="ln-410"></a><span class="k">                        end if</span>
<a name="ln-411"></a>
<a name="ln-412"></a><span class="k">                    else</span>
<a name="ln-413"></a>                        <span class="c">!unknown escape character</span>
<a name="ln-414"></a>                        <span class="n">error_message</span> <span class="o">=</span> <span class="s1">&#39;Error in unescape_string:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-415"></a>                                             <span class="s1">&#39; unknown escape sequence in string &quot;&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-416"></a>                                             <span class="nb">trim</span><span class="p">(</span><span class="n">str_in</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; [&#39;</span><span class="o">//</span><span class="n">backslash</span><span class="o">//</span><span class="n">c</span><span class="o">//</span><span class="s1">&#39;]&#39;</span>
<a name="ln-417"></a>                        <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">str_out</span><span class="p">))</span> <span class="k">deallocate</span><span class="p">(</span><span class="n">str_out</span><span class="p">)</span>
<a name="ln-418"></a>                        <span class="k">return</span>
<a name="ln-419"></a><span class="k">                    end if</span>
<a name="ln-420"></a>
<a name="ln-421"></a><span class="k">                else</span>
<a name="ln-422"></a>                    <span class="c">!an escape character is the last character in</span>
<a name="ln-423"></a>                    <span class="c">! the string [this may not be valid syntax,</span>
<a name="ln-424"></a>                    <span class="c">! but just keep it]</span>
<a name="ln-425"></a>                    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-426"></a>                    <span class="n">str_out</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span>
<a name="ln-427"></a>                <span class="k">end if</span>
<a name="ln-428"></a>
<a name="ln-429"></a><span class="k">            else</span>
<a name="ln-430"></a><span class="k">                </span><span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-431"></a>                <span class="n">str_out</span><span class="p">(</span><span class="n">m</span><span class="p">:</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span>
<a name="ln-432"></a>            <span class="k">end if</span>
<a name="ln-433"></a>
<a name="ln-434"></a><span class="k">        end do</span>
<a name="ln-435"></a>
<a name="ln-436"></a>        <span class="c">!trim trailing space:</span>
<a name="ln-437"></a>        <span class="n">str_out</span> <span class="o">=</span> <span class="n">str_out</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">m</span><span class="p">)</span>
<a name="ln-438"></a>
<a name="ln-439"></a>    <span class="k">else</span>
<a name="ln-440"></a>        <span class="c">!there are no escape characters, so return as is:</span>
<a name="ln-441"></a>        <span class="n">str_out</span> <span class="o">=</span> <span class="n">str_in</span>
<a name="ln-442"></a>    <span class="k">end if</span>
<a name="ln-443"></a>
<a name="ln-444"></a><span class="k">    end subroutine </span><span class="n">unescape_string</span>
<a name="ln-445"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-446"></a>
<a name="ln-447"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-448"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-449"></a><span class="c">!  date:6/14/2014</span>
<a name="ln-450"></a><span class="c">!</span>
<a name="ln-451"></a><span class="c">!  Returns true if the string is a valid 4-digit hex string.</span>
<a name="ln-452"></a><span class="c">!</span>
<a name="ln-453"></a><span class="c">!# Examples</span>
<a name="ln-454"></a><span class="c">!```fortran</span>
<a name="ln-455"></a><span class="c">!    valid_json_hex(&#39;0000&#39;)  !returns true</span>
<a name="ln-456"></a><span class="c">!    valid_json_hex(&#39;ABC4&#39;)  !returns true</span>
<a name="ln-457"></a><span class="c">!    valid_json_hex(&#39;AB&#39;)    !returns false (&lt; 4 characters)</span>
<a name="ln-458"></a><span class="c">!    valid_json_hex(&#39;WXYZ&#39;)  !returns false (invalid characters)</span>
<a name="ln-459"></a><span class="c">!```</span>
<a name="ln-460"></a>
<a name="ln-461"></a>    <span class="k">pure function </span><span class="n">valid_json_hex</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
<a name="ln-462"></a>
<a name="ln-463"></a>    <span class="k">implicit none</span>
<a name="ln-464"></a>
<a name="ln-465"></a><span class="k">    </span><span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">valid</span>  <span class="c">!! is str a value 4-digit hex string</span>
<a name="ln-466"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>    <span class="c">!! the string to check.</span>
<a name="ln-467"></a>
<a name="ln-468"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">n</span>  <span class="c">!! length of `str`</span>
<a name="ln-469"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>  <span class="c">!! counter</span>
<a name="ln-470"></a>
<a name="ln-471"></a>    <span class="c">!&gt; an array of the valid hex characters</span>
<a name="ln-472"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">22</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">valid_chars</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-473"></a>        <span class="p">[</span> <span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span><span class="mi">57</span><span class="p">),</span> <span class="p">&amp;</span> <span class="c">! decimal digits</span>
<a name="ln-474"></a>          <span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">),</span> <span class="p">&amp;</span> <span class="c">! capital A-F</span>
<a name="ln-475"></a>          <span class="p">(</span><span class="nb">achar</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="mi">97</span><span class="p">,</span><span class="mi">102</span><span class="p">)</span> <span class="p">]</span> <span class="c">! lowercase a-f</span>
<a name="ln-476"></a>
<a name="ln-477"></a>    <span class="c">!initialize</span>
<a name="ln-478"></a>    <span class="n">valid</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-479"></a>
<a name="ln-480"></a>    <span class="c">!check all the characters in the string:</span>
<a name="ln-481"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-482"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-483"></a><span class="k">        do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<a name="ln-484"></a>            <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">valid_chars</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-485"></a><span class="k">        end do</span>
<a name="ln-486"></a><span class="k">        </span><span class="n">valid</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>    <span class="c">!all are in the set, so it is OK</span>
<a name="ln-487"></a>    <span class="k">end if</span>
<a name="ln-488"></a>
<a name="ln-489"></a><span class="k">    end function </span><span class="n">valid_json_hex</span>
<a name="ln-490"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-491"></a>
<a name="ln-492"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-493"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-494"></a><span class="c">!</span>
<a name="ln-495"></a><span class="c">!  Convert string to unicode (CDK to CK).</span>
<a name="ln-496"></a>
<a name="ln-497"></a>    <span class="k">pure function </span><span class="n">to_uni</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-498"></a>
<a name="ln-499"></a>    <span class="k">implicit none</span>
<a name="ln-500"></a>
<a name="ln-501"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-502"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>       <span class="kd">::</span> <span class="n">to_uni</span>
<a name="ln-503"></a>
<a name="ln-504"></a>    <span class="n">to_uni</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-505"></a>
<a name="ln-506"></a>    <span class="k">end function </span><span class="n">to_uni</span>
<a name="ln-507"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-508"></a>
<a name="ln-509"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-510"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-511"></a><span class="c">!</span>
<a name="ln-512"></a><span class="c">!  Convert array of strings to unicode (CDK to CK).</span>
<a name="ln-513"></a><span class="c">!</span>
<a name="ln-514"></a><span class="c">!@note JW: may be able to remove this by making [[to_uni]] PURE ELEMENTAL ?</span>
<a name="ln-515"></a>
<a name="ln-516"></a>    <span class="k">pure function </span><span class="n">to_uni_vec</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-517"></a>
<a name="ln-518"></a>    <span class="k">implicit none</span>
<a name="ln-519"></a>
<a name="ln-520"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">str</span>
<a name="ln-521"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)),</span> <span class="k">dimension</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">str</span><span class="p">))</span> <span class="kd">::</span> <span class="n">to_uni_vec</span>
<a name="ln-522"></a>
<a name="ln-523"></a>    <span class="n">to_uni_vec</span> <span class="o">=</span> <span class="n">str</span>
<a name="ln-524"></a>
<a name="ln-525"></a>    <span class="k">end function </span><span class="n">to_uni_vec</span>
<a name="ln-526"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-527"></a>
<a name="ln-528"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-529"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-530"></a><span class="c">!</span>
<a name="ln-531"></a><span class="c">!  `CK`//`CDK` operator.</span>
<a name="ln-532"></a>
<a name="ln-533"></a>    <span class="k">pure function </span><span class="n">ucs4_join_default</span><span class="p">(</span><span class="n">ucs4_str</span><span class="p">,</span><span class="n">def_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-534"></a>
<a name="ln-535"></a>    <span class="k">implicit none</span>
<a name="ln-536"></a>
<a name="ln-537"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ucs4_str</span>
<a name="ln-538"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">def_str</span>
<a name="ln-539"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ucs4_str</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">def_str</span><span class="p">)))</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-540"></a>
<a name="ln-541"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">ucs4_str</span><span class="o">//</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span>
<a name="ln-542"></a>
<a name="ln-543"></a>    <span class="k">end function </span><span class="n">ucs4_join_default</span>
<a name="ln-544"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-545"></a>
<a name="ln-546"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-547"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-548"></a><span class="c">!</span>
<a name="ln-549"></a><span class="c">!  `CDK`//`CK` operator.</span>
<a name="ln-550"></a>
<a name="ln-551"></a>    <span class="k">pure function </span><span class="n">default_join_ucs4</span><span class="p">(</span><span class="n">def_str</span><span class="p">,</span><span class="n">ucs4_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-552"></a>
<a name="ln-553"></a>    <span class="k">implicit none</span>
<a name="ln-554"></a>
<a name="ln-555"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">def_str</span>
<a name="ln-556"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ucs4_str</span>
<a name="ln-557"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">ucs4_str</span><span class="p">)))</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-558"></a>
<a name="ln-559"></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">to_unicode</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span><span class="o">//</span><span class="n">ucs4_str</span>
<a name="ln-560"></a>
<a name="ln-561"></a>    <span class="k">end function </span><span class="n">default_join_ucs4</span>
<a name="ln-562"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-563"></a>
<a name="ln-564"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-565"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-566"></a><span class="c">!</span>
<a name="ln-567"></a><span class="c">!  `CK`==`CDK` operator.</span>
<a name="ln-568"></a>
<a name="ln-569"></a>    <span class="k">pure elemental function </span><span class="n">ucs4_comp_default</span><span class="p">(</span><span class="n">ucs4_str</span><span class="p">,</span><span class="n">def_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-570"></a>
<a name="ln-571"></a>    <span class="k">implicit none</span>
<a name="ln-572"></a>
<a name="ln-573"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ucs4_str</span>
<a name="ln-574"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">def_str</span>
<a name="ln-575"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-576"></a>
<a name="ln-577"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span> <span class="n">ucs4_str</span> <span class="o">==</span> <span class="n">to_unicode</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-578"></a>
<a name="ln-579"></a>    <span class="k">end function </span><span class="n">ucs4_comp_default</span>
<a name="ln-580"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-581"></a>
<a name="ln-582"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-583"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-584"></a><span class="c">!</span>
<a name="ln-585"></a><span class="c">!  `CDK`==`CK` operator.</span>
<a name="ln-586"></a>
<a name="ln-587"></a>    <span class="k">pure elemental function </span><span class="n">default_comp_ucs4</span><span class="p">(</span><span class="n">def_str</span><span class="p">,</span><span class="n">ucs4_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-588"></a>
<a name="ln-589"></a>    <span class="k">implicit none</span>
<a name="ln-590"></a>
<a name="ln-591"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">def_str</span>
<a name="ln-592"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ucs4_str</span>
<a name="ln-593"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-594"></a>
<a name="ln-595"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span> <span class="o">==</span> <span class="n">ucs4_str</span><span class="p">)</span>
<a name="ln-596"></a>
<a name="ln-597"></a>    <span class="k">end function </span><span class="n">default_comp_ucs4</span>
<a name="ln-598"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-599"></a>
<a name="ln-600"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-601"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-602"></a><span class="c">!</span>
<a name="ln-603"></a><span class="c">!  `CK`/=`CDK` operator.</span>
<a name="ln-604"></a>
<a name="ln-605"></a>    <span class="k">pure elemental function </span><span class="n">ucs4_neq_default</span><span class="p">(</span><span class="n">ucs4_str</span><span class="p">,</span><span class="n">def_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-606"></a>
<a name="ln-607"></a>    <span class="k">implicit none</span>
<a name="ln-608"></a>
<a name="ln-609"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ucs4_str</span>
<a name="ln-610"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">def_str</span>
<a name="ln-611"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-612"></a>
<a name="ln-613"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span> <span class="n">ucs4_str</span> <span class="o">/=</span> <span class="n">to_unicode</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-614"></a>
<a name="ln-615"></a>    <span class="k">end function </span><span class="n">ucs4_neq_default</span>
<a name="ln-616"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-617"></a>
<a name="ln-618"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-619"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-620"></a><span class="c">!</span>
<a name="ln-621"></a><span class="c">!  `CDK`/=`CK` operator.</span>
<a name="ln-622"></a>
<a name="ln-623"></a>    <span class="k">pure elemental function </span><span class="n">default_neq_ucs4</span><span class="p">(</span><span class="n">def_str</span><span class="p">,</span><span class="n">ucs4_str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a name="ln-624"></a>
<a name="ln-625"></a>    <span class="k">implicit none</span>
<a name="ln-626"></a>
<a name="ln-627"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">def_str</span>
<a name="ln-628"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ucs4_str</span>
<a name="ln-629"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">res</span>
<a name="ln-630"></a>
<a name="ln-631"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">def_str</span><span class="p">)</span> <span class="o">/=</span> <span class="n">ucs4_str</span><span class="p">)</span>
<a name="ln-632"></a>
<a name="ln-633"></a>    <span class="k">end function </span><span class="n">default_neq_ucs4</span>
<a name="ln-634"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-635"></a>
<a name="ln-636"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-637"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-638"></a><span class="c">!</span>
<a name="ln-639"></a><span class="c">!  Return the lowercase version of the `CK` character.</span>
<a name="ln-640"></a>
<a name="ln-641"></a>    <span class="k">pure elemental function </span><span class="n">lowercase_character</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">c_lower</span><span class="p">)</span>
<a name="ln-642"></a>
<a name="ln-643"></a>    <span class="k">implicit none</span>
<a name="ln-644"></a>
<a name="ln-645"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">c</span>
<a name="ln-646"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">c_lower</span>
<a name="ln-647"></a>
<a name="ln-648"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>  <span class="c">!! index in uppercase array</span>
<a name="ln-649"></a>
<a name="ln-650"></a>    <span class="n">i</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span><span class="n">upper</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
<a name="ln-651"></a>    <span class="n">c_lower</span> <span class="o">=</span> <span class="nb">merge</span><span class="p">(</span><span class="n">lower</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-652"></a>
<a name="ln-653"></a>    <span class="k">end function </span><span class="n">lowercase_character</span>
<a name="ln-654"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-655"></a>
<a name="ln-656"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-657"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-658"></a><span class="c">!</span>
<a name="ln-659"></a><span class="c">!  Returns lowercase version of the `CK` string.</span>
<a name="ln-660"></a>
<a name="ln-661"></a>    <span class="k">pure elemental function </span><span class="n">lowercase_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">s_lower</span><span class="p">)</span>
<a name="ln-662"></a>
<a name="ln-663"></a>    <span class="k">implicit none</span>
<a name="ln-664"></a>
<a name="ln-665"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>      <span class="c">!! input string</span>
<a name="ln-666"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str</span><span class="p">)))</span>   <span class="kd">::</span> <span class="n">s_lower</span>  <span class="c">!! lowercase version of the string</span>
<a name="ln-667"></a>
<a name="ln-668"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>  <span class="c">!! counter</span>
<a name="ln-669"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span>  <span class="c">!! length of input string</span>
<a name="ln-670"></a>
<a name="ln-671"></a>    <span class="n">s_lower</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-672"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-673"></a>
<a name="ln-674"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-675"></a><span class="k">        do </span><span class="n">concurrent</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)</span>
<a name="ln-676"></a>            <span class="n">s_lower</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">lowercase_character</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-677"></a>        <span class="k">end do</span>
<a name="ln-678"></a><span class="k">    end if</span>
<a name="ln-679"></a>
<a name="ln-680"></a><span class="k">    end function </span><span class="n">lowercase_string</span>
<a name="ln-681"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-682"></a>
<a name="ln-683"></a>    <span class="k">end module </span><span class="n">json_string_utilities</span>
<a name="ln-684"></a><span class="c">!*****************************************************************************************</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/jf_test_1.f90.html">jf_test_1.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_10.f90.html">jf_test_10.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_11.f90.html">jf_test_11.F90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_12.f90.html">jf_test_12.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_13.f90.html">jf_test_13.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_14.f90.html">jf_test_14.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_15.f90.html">jf_test_15.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_16.f90.html">jf_test_16.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_17.f90.html">jf_test_17.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_18.f90.html">jf_test_18.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_19.f90.html">jf_test_19.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_2.f90.html">jf_test_2.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_20.f90.html">jf_test_20.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_3.f90.html">jf_test_3.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_4.f90.html">jf_test_4.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_5.f90.html">jf_test_5.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_6.f90.html">jf_test_6.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_7.f90.html">jf_test_7.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_8.f90.html">jf_test_8.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_9.f90.html">jf_test_9.f90</a>
      
      <a class="list-group-item" href="../sourcefile/json_file_module.f90.html">json_file_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_kinds.f90.html">json_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_module.f90.html">json_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_parameters.f90.html">json_parameters.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_string_utilities.f90.html">json_string_utilities.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_value_module.f90.html">json_value_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_iso_10646_support.f90.html">test_iso_10646_support.f90</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2016 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2016-08-14 16:03  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> JSON-Fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>