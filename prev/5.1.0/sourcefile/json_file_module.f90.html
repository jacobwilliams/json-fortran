<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="JSON-Fortran â€“ A Fortran 2008 JSON API">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>json_file_module.F90 &ndash; JSON-Fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">JSON-Fortran <small>5.1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>json_file_module.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title="290.4% of total for source files.">485 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/json_file_module.F90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">json_file_module.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/json_file_module.html">json_file_module</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/json_file_module.f90.html#src">json_file_module.F90</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/jf_test_1.f90.html">jf_test_1.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_10.f90.html">jf_test_10.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_11.f90.html">jf_test_11.F90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_12.f90.html">jf_test_12.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_13.f90.html">jf_test_13.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_14.f90.html">jf_test_14.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_15.f90.html">jf_test_15.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_16.f90.html">jf_test_16.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_17.f90.html">jf_test_17.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_18.f90.html">jf_test_18.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_19.f90.html">jf_test_19.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_2.f90.html">jf_test_2.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_20.f90.html">jf_test_20.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_3.f90.html">jf_test_3.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_4.f90.html">jf_test_4.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_5.f90.html">jf_test_5.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_6.f90.html">jf_test_6.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_7.f90.html">jf_test_7.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_8.f90.html">jf_test_8.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_9.f90.html">jf_test_9.f90</a>
      
      <a class="list-group-item" href="../sourcefile/json_file_module.f90.html">json_file_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_kinds.f90.html">json_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_module.f90.html">json_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_parameters.f90.html">json_parameters.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_string_utilities.f90.html">json_string_utilities.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_value_module.f90.html">json_value_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_iso_10646_support.f90.html">test_iso_10646_support.f90</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    <div class="col-md-9" id='text'>
    
    
    <h3>This File Depends On</h3>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~json_file_module.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilejson_file_modulef90EfferentGraph" width="641pt" height="118pt"
 viewBox="0.00 0.00 641.00 117.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~json_file_module.f90~~EfferentGraph" class="graph" transform="scale(0.887812 0.887812) rotate(0) translate(4 128.889)">
<title>sourcefile~~json_file_module.f90~~EfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-128.889 719,-128.889 719,5 -4,5"/>
<!-- sourcefile~json_file_module.f90 -->
<g id="node1" class="node"><title>sourcefile~json_file_module.f90</title>
<polygon fill="none" stroke="black" points="713,-83.8891 599,-83.8891 599,-57.8891 713,-57.8891 713,-83.8891"/>
<text text-anchor="middle" x="656" y="-68.4391" font-family="Helvetica,sans-Serif" font-size="10.50">json_file_module.F90</text>
</g>
<!-- sourcefile~json_string_utilities.f90 -->
<g id="node2" class="node"><title>sourcefile~json_string_utilities.f90</title>
<a xlink:href="../sourcefile/json_string_utilities.f90.html" xlink:title="json_string_utilities.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="398,-124.889 274,-124.889 274,-98.8891 398,-98.8891 398,-124.889"/>
<text text-anchor="middle" x="336" y="-109.439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_string_utilities.F90</text>
</a>
</g>
<!-- sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="edge14" class="edge"><title>sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M398.163,-109.111C443.727,-106.481 506.969,-101.594 562,-92.8891 573.267,-91.1067 585.188,-88.717 596.618,-86.1689"/>
<polygon fill="#ff0000" stroke="#ff0000" points="597.544,-89.5476 606.508,-83.9001 595.978,-82.7248 597.544,-89.5476"/>
</g>
<!-- sourcefile~json_value_module.f90 -->
<g id="node3" class="node"><title>sourcefile~json_value_module.f90</title>
<a xlink:href="../sourcefile/json_value_module.f90.html" xlink:title="json_value_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="561,-83.8891 435,-83.8891 435,-57.8891 561,-57.8891 561,-83.8891"/>
<text text-anchor="middle" x="498" y="-68.4391" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_value_module.F90</text>
</a>
</g>
<!-- sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_value_module.f90 -->
<g id="edge6" class="edge"><title>sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_value_module.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M387.703,-98.8037C403.27,-94.864 420.505,-90.5021 436.635,-86.4198"/>
<polygon fill="#7fff00" stroke="#7fff00" points="437.674,-89.7671 446.51,-83.9205 435.957,-82.9811 437.674,-89.7671"/>
</g>
<!-- sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="edge16" class="edge"><title>sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M561.809,-70.8891C570.489,-70.8891 579.423,-70.8891 588.17,-70.8891"/>
<polygon fill="#ff0000" stroke="#ff0000" points="588.327,-74.3892 598.327,-70.8891 588.327,-67.3892 588.327,-74.3892"/>
</g>
<!-- sourcefile~json_kinds.f90 -->
<g id="node4" class="node"><title>sourcefile~json_kinds.f90</title>
<a xlink:href="../sourcefile/json_kinds.f90.html" xlink:title="json_kinds.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="85,-47.8891 1,-47.8891 1,-21.8891 85,-21.8891 85,-47.8891"/>
<text text-anchor="middle" x="43" y="-32.4391" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_kinds.F90</text>
</a>
</g>
<!-- sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="edge18" class="edge"><title>sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M81.9385,-21.786C94.5669,-18.1484 108.74,-14.7009 122,-12.8891 287.742,9.75797 333.398,-0.0683332 498,-29.8891"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M498,-29.8891C534.222,-35.766 574.224,-46.1871 604.915,-55.052"/>
<polygon fill="#ff0000" stroke="#ff0000" points="603.955,-58.4179 614.536,-57.8678 605.922,-51.6998 603.955,-58.4179"/>
</g>
<!-- sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_string_utilities.f90 -->
<g id="edge2" class="edge"><title>sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_string_utilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M180,-75.8891C210.979,-82.0049 245.184,-89.7822 273.652,-96.542"/>
<polygon fill="#ff0000" stroke="#ff0000" points="272.927,-99.9674 283.467,-98.8862 274.554,-93.1589 272.927,-99.9674"/>
</g>
<!-- sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_value_module.f90 -->
<g id="edge8" class="edge"><title>sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_value_module.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M79.7305,-47.9772C107.044,-57.1931 145.413,-69.0611 180,-75.8891"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M180,-75.8891C262.399,-92.156 359.15,-87.3264 424.106,-80.7277"/>
<polygon fill="#7fff00" stroke="#7fff00" points="424.673,-84.1873 434.25,-79.6564 423.938,-77.226 424.673,-84.1873"/>
</g>
<!-- sourcefile~json_parameters.f90 -->
<g id="node5" class="node"><title>sourcefile~json_parameters.f90</title>
<a xlink:href="../sourcefile/json_parameters.f90.html" xlink:title="json_parameters.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="237,-47.8891 123,-47.8891 123,-21.8891 237,-21.8891 237,-47.8891"/>
<text text-anchor="middle" x="180" y="-32.4391" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_parameters.F90</text>
</a>
</g>
<!-- sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_parameters.f90 -->
<g id="edge12" class="edge"><title>sourcefile~json_kinds.f90&#45;&gt;sourcefile~json_parameters.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M85.5967,-34.8891C94.0431,-34.8891 103.106,-34.8891 112.153,-34.8891"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="112.328,-38.3892 122.328,-34.8891 112.328,-31.3892 112.328,-38.3892"/>
</g>
<!-- sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="edge20" class="edge"><title>sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M237.812,-31.9491C267.224,-30.9174 303.53,-30.3542 336,-31.8891"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M336,-31.8891C407.925,-35.2893 427.148,-17.0529 498,-29.8891"/>
</g>
<!-- sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_string_utilities.f90 -->
<g id="edge4" class="edge"><title>sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_string_utilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M208.713,-48.0062C218.084,-52.3535 228.516,-57.2641 238,-61.8891 259.295,-72.2741 282.962,-84.3343 301.703,-94.008"/>
<polygon fill="#ff0000" stroke="#ff0000" points="300.255,-97.1993 310.744,-98.6871 303.472,-90.9825 300.255,-97.1993"/>
</g>
<!-- sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_value_module.f90 -->
<g id="edge10" class="edge"><title>sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_value_module.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M336,-31.8891C375.805,-33.7708 419.678,-44.9194 451.716,-54.8173"/>
<polygon fill="#7fff00" stroke="#7fff00" points="450.671,-58.1577 461.261,-57.8373 452.783,-51.4838 450.671,-58.1577"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilejson_file_modulef90EfferentGraph = svgPanZoom('#sourcefilejson_file_modulef90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>


<p>Solid arrows point from a file to a file which depends upon it. A file 
is dependent upon another if the latter must be compiled before the former
can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
</p>

                      </div>
                    </div>
                  </div>
                </div>
                
    
      
      <h3>Files Dependent On This One</h3>
      
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: sourcefile~~json_file_module.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilejson_file_modulef90AfferentGraph" width="374pt" height="870pt"
 viewBox="0.00 0.00 374.00 870.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~json_file_module.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 866)">
<title>sourcefile~~json_file_module.f90~~AfferentGraph</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-866 371,-866 371,5 -4,5"/>
<!-- sourcefile~json_file_module.f90 -->
<g id="node1" class="node"><title>sourcefile~json_file_module.f90</title>
<polygon fill="none" stroke="black" points="115,-444 1,-444 1,-418 115,-418 115,-444"/>
<text text-anchor="middle" x="58" y="-428.55" font-family="Helvetica,sans-Serif" font-size="10.50">json_file_module.F90</text>
</g>
<!-- sourcefile~json_module.f90 -->
<g id="node2" class="node"><title>sourcefile~json_module.f90</title>
<a xlink:href="../sourcefile/json_module.f90.html" xlink:title="json_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="247,-444 153,-444 153,-418 247,-418 247,-444"/>
<text text-anchor="middle" x="200" y="-428.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_module.F90</text>
</a>
</g>
<!-- sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_module.f90 -->
<g id="edge42" class="edge"><title>sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M115.757,-431C124.477,-431 133.473,-431 142.194,-431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.272,-434.5 152.272,-431 142.272,-427.5 142.272,-434.5"/>
</g>
<!-- sourcefile~jf_test_9.f90 -->
<g id="node3" class="node"><title>sourcefile~jf_test_9.f90</title>
<a xlink:href="../sourcefile/jf_test_9.f90.html" xlink:title="jf_test_9.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-862 290,-862 290,-836 360,-836 360,-862"/>
<text text-anchor="middle" x="325" y="-846.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_9.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_9.f90 -->
<g id="edge2" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_9.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201.31,-444.232C207.62,-505.783 236.551,-763.756 284,-827 284.473,-827.63 284.969,-828.244 285.486,-828.842"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.41,-831.682 293.19,-835.755 288.085,-826.472 283.41,-831.682"/>
</g>
<!-- sourcefile~jf_test_13.f90 -->
<g id="node4" class="node"><title>sourcefile~jf_test_13.f90</title>
<a xlink:href="../sourcefile/jf_test_13.f90.html" xlink:title="jf_test_13.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-818 287,-818 287,-792 363,-792 363,-818"/>
<text text-anchor="middle" x="325" y="-802.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_13.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_13.f90 -->
<g id="edge4" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_13.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201.697,-444.273C209.24,-501.592 241.256,-727.5 284,-783 284.582,-783.756 285.198,-784.489 285.843,-785.2"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.823,-788.081 293.675,-791.979 288.405,-782.788 283.823,-788.081"/>
</g>
<!-- sourcefile~jf_test_20.f90 -->
<g id="node5" class="node"><title>sourcefile~jf_test_20.f90</title>
<a xlink:href="../sourcefile/jf_test_20.f90.html" xlink:title="jf_test_20.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-774 287,-774 287,-748 363,-748 363,-774"/>
<text text-anchor="middle" x="325" y="-758.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_20.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_20.f90 -->
<g id="edge6" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_20.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M202.142,-444.01C210.969,-496.359 245.858,-691.082 284,-739 284.594,-739.747 285.221,-740.471 285.876,-741.174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.894,-744.083 293.777,-747.899 288.43,-738.752 283.894,-744.083"/>
</g>
<!-- sourcefile~jf_test_14.f90 -->
<g id="node6" class="node"><title>sourcefile~jf_test_14.f90</title>
<a xlink:href="../sourcefile/jf_test_14.f90.html" xlink:title="jf_test_14.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-730 287,-730 287,-704 363,-704 363,-730"/>
<text text-anchor="middle" x="325" y="-714.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_14.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_14.f90 -->
<g id="edge8" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_14.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M200.773,-444.173C203.857,-485.766 218.537,-616.196 284,-695 284.61,-695.734 285.25,-696.447 285.918,-697.14"/>
<polygon fill="#ff0000" stroke="#ff0000" points="283.985,-700.084 293.91,-703.791 288.463,-694.704 283.985,-700.084"/>
</g>
<!-- sourcefile~jf_test_17.f90 -->
<g id="node7" class="node"><title>sourcefile~jf_test_17.f90</title>
<a xlink:href="../sourcefile/jf_test_17.f90.html" xlink:title="jf_test_17.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-686 287,-686 287,-660 363,-660 363,-686"/>
<text text-anchor="middle" x="325" y="-670.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_17.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_17.f90 -->
<g id="edge10" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_17.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201.747,-444.036C207.288,-480.809 227.56,-586.846 284,-651 284.747,-651.849 285.535,-652.671 286.357,-653.467"/>
<polygon fill="#ff0000" stroke="#ff0000" points="284.487,-656.45 294.499,-659.917 288.834,-650.963 284.487,-656.45"/>
</g>
<!-- sourcefile~jf_test_8.f90 -->
<g id="node8" class="node"><title>sourcefile~jf_test_8.f90</title>
<a xlink:href="../sourcefile/jf_test_8.f90.html" xlink:title="jf_test_8.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-642 290,-642 290,-616 360,-616 360,-642"/>
<text text-anchor="middle" x="325" y="-626.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_8.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_8.f90 -->
<g id="edge12" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_8.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M203.21,-444.113C211.538,-475.739 236.56,-557.267 284,-607 284.91,-607.953 285.87,-608.875 286.87,-609.764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="285.058,-612.779 295.164,-615.96 289.247,-607.171 285.058,-612.779"/>
</g>
<!-- sourcefile~jf_test_15.f90 -->
<g id="node9" class="node"><title>sourcefile~jf_test_15.f90</title>
<a xlink:href="../sourcefile/jf_test_15.f90.html" xlink:title="jf_test_15.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-598 287,-598 287,-572 363,-572 363,-598"/>
<text text-anchor="middle" x="325" y="-582.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_15.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_15.f90 -->
<g id="edge14" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_15.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M205.599,-444.168C217.054,-469.828 245.38,-527.146 284,-563 285.11,-564.031 286.277,-565.028 287.488,-565.992"/>
<polygon fill="#ff0000" stroke="#ff0000" points="285.735,-569.036 295.947,-571.858 289.724,-563.284 285.735,-569.036"/>
</g>
<!-- sourcefile~jf_test_5.f90 -->
<g id="node10" class="node"><title>sourcefile~jf_test_5.f90</title>
<a xlink:href="../sourcefile/jf_test_5.f90.html" xlink:title="jf_test_5.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-554 290,-554 290,-528 360,-528 360,-554"/>
<text text-anchor="middle" x="325" y="-538.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_5.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_5.f90 -->
<g id="edge16" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_5.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M210.311,-444.189C225.16,-462.581 254.084,-496.231 284,-519 285.591,-520.211 287.257,-521.393 288.97,-522.541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="287.431,-525.704 297.781,-527.969 291.103,-519.744 287.431,-525.704"/>
</g>
<!-- sourcefile~jf_test_16.f90 -->
<g id="node11" class="node"><title>sourcefile~jf_test_16.f90</title>
<a xlink:href="../sourcefile/jf_test_16.f90.html" xlink:title="jf_test_16.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-510 287,-510 287,-484 363,-484 363,-510"/>
<text text-anchor="middle" x="325" y="-494.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_16.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_16.f90 -->
<g id="edge18" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_16.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.696,-444.039C243.785,-454.119 270.411,-468.177 291.433,-479.277"/>
<polygon fill="#ff0000" stroke="#ff0000" points="289.878,-482.414 300.355,-483.988 293.146,-476.223 289.878,-482.414"/>
</g>
<!-- sourcefile~jf_test_2.f90 -->
<g id="node12" class="node"><title>sourcefile~jf_test_2.f90</title>
<a xlink:href="../sourcefile/jf_test_2.f90.html" xlink:title="jf_test_2.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-466 290,-466 290,-440 360,-440 360,-466"/>
<text text-anchor="middle" x="325" y="-450.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_2.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_2.f90 -->
<g id="edge20" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_2.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M247.614,-439.38C257.963,-441.201 268.89,-443.125 279.169,-444.934"/>
<polygon fill="#ff0000" stroke="#ff0000" points="278.73,-448.41 289.185,-446.697 279.943,-441.516 278.73,-448.41"/>
</g>
<!-- sourcefile~jf_test_7.f90 -->
<g id="node13" class="node"><title>sourcefile~jf_test_7.f90</title>
<a xlink:href="../sourcefile/jf_test_7.f90.html" xlink:title="jf_test_7.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-422 290,-422 290,-396 360,-396 360,-422"/>
<text text-anchor="middle" x="325" y="-406.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_7.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_7.f90 -->
<g id="edge22" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_7.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M247.614,-422.62C257.963,-420.799 268.89,-418.875 279.169,-417.066"/>
<polygon fill="#ff0000" stroke="#ff0000" points="279.943,-420.484 289.185,-415.303 278.73,-413.59 279.943,-420.484"/>
</g>
<!-- sourcefile~jf_test_1.f90 -->
<g id="node14" class="node"><title>sourcefile~jf_test_1.f90</title>
<a xlink:href="../sourcefile/jf_test_1.f90.html" xlink:title="jf_test_1.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-378 290,-378 290,-352 360,-352 360,-378"/>
<text text-anchor="middle" x="325" y="-362.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_1.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_1.f90 -->
<g id="edge24" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_1.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.696,-417.961C243.785,-407.881 270.411,-393.823 291.433,-382.723"/>
<polygon fill="#ff0000" stroke="#ff0000" points="293.146,-385.777 300.355,-378.012 289.878,-379.586 293.146,-385.777"/>
</g>
<!-- sourcefile~jf_test_4.f90 -->
<g id="node15" class="node"><title>sourcefile~jf_test_4.f90</title>
<a xlink:href="../sourcefile/jf_test_4.f90.html" xlink:title="jf_test_4.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-334 290,-334 290,-308 360,-308 360,-334"/>
<text text-anchor="middle" x="325" y="-318.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_4.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_4.f90 -->
<g id="edge26" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_4.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M210.311,-417.811C225.16,-399.419 254.084,-365.769 284,-343 285.591,-341.789 287.257,-340.607 288.97,-339.459"/>
<polygon fill="#ff0000" stroke="#ff0000" points="291.103,-342.256 297.781,-334.031 287.431,-336.296 291.103,-342.256"/>
</g>
<!-- sourcefile~jf_test_10.f90 -->
<g id="node16" class="node"><title>sourcefile~jf_test_10.f90</title>
<a xlink:href="../sourcefile/jf_test_10.f90.html" xlink:title="jf_test_10.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-290 287,-290 287,-264 363,-264 363,-290"/>
<text text-anchor="middle" x="325" y="-274.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_10.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_10.f90 -->
<g id="edge28" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_10.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M205.599,-417.832C217.054,-392.172 245.38,-334.854 284,-299 285.11,-297.969 286.277,-296.972 287.488,-296.008"/>
<polygon fill="#ff0000" stroke="#ff0000" points="289.724,-298.716 295.947,-290.142 285.735,-292.964 289.724,-298.716"/>
</g>
<!-- sourcefile~jf_test_19.f90 -->
<g id="node17" class="node"><title>sourcefile~jf_test_19.f90</title>
<a xlink:href="../sourcefile/jf_test_19.f90.html" xlink:title="jf_test_19.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-246 287,-246 287,-220 363,-220 363,-246"/>
<text text-anchor="middle" x="325" y="-230.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_19.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_19.f90 -->
<g id="edge30" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_19.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M203.21,-417.887C211.538,-386.261 236.56,-304.733 284,-255 284.91,-254.047 285.87,-253.125 286.87,-252.236"/>
<polygon fill="#ff0000" stroke="#ff0000" points="289.247,-254.829 295.164,-246.04 285.058,-249.221 289.247,-254.829"/>
</g>
<!-- sourcefile~jf_test_6.f90 -->
<g id="node18" class="node"><title>sourcefile~jf_test_6.f90</title>
<a xlink:href="../sourcefile/jf_test_6.f90.html" xlink:title="jf_test_6.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-202 290,-202 290,-176 360,-176 360,-202"/>
<text text-anchor="middle" x="325" y="-186.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_6.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_6.f90 -->
<g id="edge32" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_6.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201.747,-417.964C207.288,-381.191 227.56,-275.154 284,-211 284.747,-210.151 285.535,-209.329 286.357,-208.533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.834,-211.037 294.499,-202.083 284.487,-205.55 288.834,-211.037"/>
</g>
<!-- sourcefile~jf_test_11.f90 -->
<g id="node19" class="node"><title>sourcefile~jf_test_11.f90</title>
<a xlink:href="../sourcefile/jf_test_11.f90.html" xlink:title="jf_test_11.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-158 285,-158 285,-132 365,-132 365,-158"/>
<text text-anchor="middle" x="325" y="-142.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_11.F90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_11.f90 -->
<g id="edge34" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_11.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M200.773,-417.827C203.857,-376.234 218.537,-245.804 284,-167 284.61,-166.266 285.25,-165.553 285.918,-164.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.463,-167.296 293.91,-158.209 283.985,-161.916 288.463,-167.296"/>
</g>
<!-- sourcefile~jf_test_3.f90 -->
<g id="node20" class="node"><title>sourcefile~jf_test_3.f90</title>
<a xlink:href="../sourcefile/jf_test_3.f90.html" xlink:title="jf_test_3.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-114 290,-114 290,-88 360,-88 360,-114"/>
<text text-anchor="middle" x="325" y="-98.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_3.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_3.f90 -->
<g id="edge36" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_3.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M202.142,-417.99C210.969,-365.641 245.858,-170.918 284,-123 284.594,-122.253 285.221,-121.529 285.876,-120.826"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.43,-123.248 293.777,-114.101 283.894,-117.917 288.43,-123.248"/>
</g>
<!-- sourcefile~jf_test_12.f90 -->
<g id="node21" class="node"><title>sourcefile~jf_test_12.f90</title>
<a xlink:href="../sourcefile/jf_test_12.f90.html" xlink:title="jf_test_12.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-70 287,-70 287,-44 363,-44 363,-70"/>
<text text-anchor="middle" x="325" y="-54.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_12.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_12.f90 -->
<g id="edge38" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_12.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201.697,-417.727C209.24,-360.408 241.256,-134.5 284,-79 284.582,-78.244 285.198,-77.5109 285.843,-76.8003"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.405,-79.2121 293.675,-70.021 283.823,-73.9195 288.405,-79.2121"/>
</g>
<!-- sourcefile~jf_test_18.f90 -->
<g id="node22" class="node"><title>sourcefile~jf_test_18.f90</title>
<a xlink:href="../sourcefile/jf_test_18.f90.html" xlink:title="jf_test_18.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-26 287,-26 287,-1.24345e-14 363,-3.55271e-15 363,-26"/>
<text text-anchor="middle" x="325" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jf_test_18.f90</text>
</a>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_18.f90 -->
<g id="edge40" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~jf_test_18.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M201.31,-417.768C207.62,-356.217 236.551,-98.2439 284,-35 284.473,-34.37 284.969,-33.7561 285.486,-33.1579"/>
<polygon fill="#ff0000" stroke="#ff0000" points="288.085,-35.5283 293.19,-26.2446 283.41,-30.3184 288.085,-35.5283"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.26.3 (20100126.1600)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="34pt"
 viewBox="0.00 0.00 188.00 34.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 30)">
<title>Graph Key</title>
<polygon fill="white" stroke="white" points="-4,5 -4,-30 185,-30 185,5 -4,5"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-26 2.84217e-14,-26 0,-1.24345e-14 66,-3.55271e-15 66,-26"/>
<text text-anchor="middle" x="33" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-26 84,-26 84,-1.24345e-14 180,-3.55271e-15 180,-26"/>
<text text-anchor="middle" x="132" y="-10.55" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>


<p>Solid arrows point from a file to a file which depends upon it. A file 
is dependent upon another if the latter must be compiled before the former
can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
</p>

                      </div>
                    </div>
                  </div>
                </div>
                
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/json_file_module.html">json_file_module</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/json_file_module.f90.html#src">json_file_module.F90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-3"></a><span class="c">!  license: BSD</span>
<a name="ln-4"></a><span class="c">!</span>
<a name="ln-5"></a><span class="c">!  Higher-level [[json_file]] interface for the [[json_value]] type.</span>
<a name="ln-6"></a><span class="c">!</span>
<a name="ln-7"></a><span class="c">!## License</span>
<a name="ln-8"></a><span class="c">!  * JSON-Fortran is released under a BSD-style license.</span>
<a name="ln-9"></a><span class="c">!    See the [LICENSE](https://github.com/jacobwilliams/json-fortran/blob/master/LICENSE)</span>
<a name="ln-10"></a><span class="c">!    file for details.</span>
<a name="ln-11"></a>
<a name="ln-12"></a>    <span class="k">module </span><span class="n">json_file_module</span>
<a name="ln-13"></a>
<a name="ln-14"></a>    <span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span>
<a name="ln-15"></a>    <span class="k">use </span><span class="n">json_kinds</span>
<a name="ln-16"></a>    <span class="k">use </span><span class="n">json_parameters</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">unit2str</span>
<a name="ln-17"></a>    <span class="k">use </span><span class="n">json_string_utilities</span>
<a name="ln-18"></a>    <span class="k">use </span><span class="n">json_value_module</span>
<a name="ln-19"></a>
<a name="ln-20"></a>    <span class="k">implicit none</span>
<a name="ln-21"></a>
<a name="ln-22"></a><span class="k">    private</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="cp">#include &quot;json_macros.inc&quot;</span>
<a name="ln-25"></a>
<a name="ln-26"></a>    <span class="c">!*********************************************************</span>
<a name="ln-27"></a>    <span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-28"></a>    <span class="c">!  date: 12/9/2013</span>
<a name="ln-29"></a>    <span class="c">!</span>
<a name="ln-30"></a>    <span class="c">!  The `json_file` is the main public class that is</span>
<a name="ln-31"></a>    <span class="c">!  used to open a file and get data from it.</span>
<a name="ln-32"></a>    <span class="c">!</span>
<a name="ln-33"></a>    <span class="c">!  A `json_file` contains only two items: an instance of a [[json_core]],</span>
<a name="ln-34"></a>    <span class="c">!  which use used for all data manipulation, and a [[json_value]],</span>
<a name="ln-35"></a>    <span class="c">!  which is used to construct the linked-list data structure.</span>
<a name="ln-36"></a>    <span class="c">!  Note that most methods in the `json_file` class are simply wrappers</span>
<a name="ln-37"></a>    <span class="c">!  to the lower-level routines in the [[json_value_module]].</span>
<a name="ln-38"></a>    <span class="c">!</span>
<a name="ln-39"></a>    <span class="c">!# Example</span>
<a name="ln-40"></a>    <span class="c">!</span>
<a name="ln-41"></a>    <span class="c">!```fortran</span>
<a name="ln-42"></a>    <span class="c">!    program test</span>
<a name="ln-43"></a>    <span class="c">!    use json_module</span>
<a name="ln-44"></a>    <span class="c">!    implicit none</span>
<a name="ln-45"></a>    <span class="c">!    type(json_file) :: json</span>
<a name="ln-46"></a>    <span class="c">!    integer :: ival</span>
<a name="ln-47"></a>    <span class="c">!    real(real64) :: rval</span>
<a name="ln-48"></a>    <span class="c">!    character(len=:),allocatable :: cval</span>
<a name="ln-49"></a>    <span class="c">!    logical :: found</span>
<a name="ln-50"></a>    <span class="c">!    call json%initialize(compact_reals=.true.)</span>
<a name="ln-51"></a>    <span class="c">!    call json%load_file(filename=&#39;myfile.json&#39;)</span>
<a name="ln-52"></a>    <span class="c">!    call json%print_file() !print to the console</span>
<a name="ln-53"></a>    <span class="c">!    call json%get(&#39;var.i&#39;,ival,found)</span>
<a name="ln-54"></a>    <span class="c">!    call json%get(&#39;var.r(3)&#39;,rval,found)</span>
<a name="ln-55"></a>    <span class="c">!    call json%get(&#39;var.c&#39;,cval,found)</span>
<a name="ln-56"></a>    <span class="c">!    call json%destroy()</span>
<a name="ln-57"></a>    <span class="c">!    end program test</span>
<a name="ln-58"></a>    <span class="c">!```</span>
<a name="ln-59"></a>
<a name="ln-60"></a>    <span class="k">type</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">json_file</span>
<a name="ln-61"></a>
<a name="ln-62"></a>        <span class="k">private</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">        type</span><span class="p">(</span><span class="n">json_core</span><span class="p">)</span> <span class="kd">::</span> <span class="n">core</span> <span class="c">!! The instance of the [[json_core]] factory used for this file.</span>
<a name="ln-65"></a>        <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>  <span class="c">!! the JSON structure read from the file</span>
<a name="ln-66"></a>
<a name="ln-67"></a>    <span class="k">contains</span>
<a name="ln-68"></a>
<a name="ln-69"></a><span class="k">        generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">initialize</span> <span class="o">=&gt;</span> <span class="n">initialize_json_core_in_file</span><span class="p">,&amp;</span>
<a name="ln-70"></a>                                        <span class="n">set_json_core_in_file</span>
<a name="ln-71"></a>
<a name="ln-72"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">get_core</span> <span class="o">=&gt;</span> <span class="n">get_json_core_in_file</span>
<a name="ln-73"></a>
<a name="ln-74"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">load_file</span> <span class="o">=&gt;</span> <span class="n">json_file_load</span>
<a name="ln-75"></a>
<a name="ln-76"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">load_from_string</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_load_from_string</span><span class="p">)</span>
<a name="ln-77"></a>
<a name="ln-78"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">destroy</span> <span class="o">=&gt;</span> <span class="n">json_file_destroy</span>
<a name="ln-79"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">move</span>    <span class="o">=&gt;</span> <span class="n">json_file_move_pointer</span>
<a name="ln-80"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span>   <span class="kd">::</span> <span class="n">info</span>    <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_info</span><span class="p">)</span>
<a name="ln-81"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span>   <span class="kd">::</span> <span class="n">matrix_info</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_matrix_info</span><span class="p">)</span>
<a name="ln-82"></a>
<a name="ln-83"></a>        <span class="c">!error checking:</span>
<a name="ln-84"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">failed</span> <span class="o">=&gt;</span> <span class="n">json_file_failed</span>
<a name="ln-85"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">print_error_message</span> <span class="o">=&gt;</span> <span class="n">json_file_print_error_message</span>
<a name="ln-86"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">check_for_errors</span> <span class="o">=&gt;</span> <span class="n">json_file_check_for_errors</span>
<a name="ln-87"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">clear_exceptions</span> <span class="o">=&gt;</span> <span class="n">json_file_clear_exceptions</span>
<a name="ln-88"></a>
<a name="ln-89"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">print_to_string</span> <span class="o">=&gt;</span> <span class="n">json_file_print_to_string</span>
<a name="ln-90"></a>
<a name="ln-91"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">print_file</span> <span class="o">=&gt;</span> <span class="n">json_file_print_to_console</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-92"></a>                                        <span class="n">json_file_print_1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-93"></a>                                        <span class="n">json_file_print_2</span>
<a name="ln-94"></a>
<a name="ln-95"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">get</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_object</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-96"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-97"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_double</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-98"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-99"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-100"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer_vec</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-101"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_double_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-102"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical_vec</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-103"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-104"></a>                                 <span class="n">json_file_get_root</span>
<a name="ln-105"></a>
<a name="ln-106"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">update</span> <span class="o">=&gt;</span>  <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_integer</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-107"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_logical</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-108"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-109"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_string</span><span class="p">)</span>
<a name="ln-110"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-111"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">update</span> <span class="o">=&gt;</span> <span class="n">json_file_update_string_name_ascii</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-112"></a>                                    <span class="n">json_file_update_string_val_ascii</span>
<a name="ln-113"></a><span class="cp">#endif</span>
<a name="ln-114"></a>
<a name="ln-115"></a>        <span class="c">!traverse</span>
<a name="ln-116"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">traverse</span> <span class="o">=&gt;</span> <span class="n">json_file_traverse</span>
<a name="ln-117"></a>
<a name="ln-118"></a>        <span class="c">! ***************************************************</span>
<a name="ln-119"></a>        <span class="c">! private routines</span>
<a name="ln-120"></a>        <span class="c">! ***************************************************</span>
<a name="ln-121"></a>
<a name="ln-122"></a>        <span class="c">!load from string:</span>
<a name="ln-123"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_load_from_string</span><span class="p">)</span>
<a name="ln-124"></a>
<a name="ln-125"></a>        <span class="c">!initialize</span>
<a name="ln-126"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">initialize_json_core_in_file</span>
<a name="ln-127"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">set_json_core_in_file</span>
<a name="ln-128"></a>
<a name="ln-129"></a>        <span class="c">!get info:</span>
<a name="ln-130"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_info</span><span class="p">)</span>
<a name="ln-131"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_matrix_info</span><span class="p">)</span>
<a name="ln-132"></a>
<a name="ln-133"></a>        <span class="c">!get:</span>
<a name="ln-134"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_object</span><span class="p">)</span>
<a name="ln-135"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer</span><span class="p">)</span>
<a name="ln-136"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_double</span><span class="p">)</span>
<a name="ln-137"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical</span><span class="p">)</span>
<a name="ln-138"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string</span><span class="p">)</span>
<a name="ln-139"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer_vec</span><span class="p">)</span>
<a name="ln-140"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_double_vec</span><span class="p">)</span>
<a name="ln-141"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical_vec</span><span class="p">)</span>
<a name="ln-142"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string_vec</span><span class="p">)</span>
<a name="ln-143"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_get_root</span>
<a name="ln-144"></a>
<a name="ln-145"></a>        <span class="c">!update:</span>
<a name="ln-146"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_integer</span><span class="p">)</span>
<a name="ln-147"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_logical</span><span class="p">)</span>
<a name="ln-148"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real</span><span class="p">)</span>
<a name="ln-149"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_string</span><span class="p">)</span>
<a name="ln-150"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-151"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_update_string_name_ascii</span>
<a name="ln-152"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_update_string_val_ascii</span>
<a name="ln-153"></a><span class="cp">#endif</span>
<a name="ln-154"></a>
<a name="ln-155"></a>        <span class="c">!print_file:</span>
<a name="ln-156"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_print_to_console</span>
<a name="ln-157"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_print_1</span>
<a name="ln-158"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_print_2</span>
<a name="ln-159"></a>
<a name="ln-160"></a>    <span class="k">end type </span><span class="n">json_file</span>
<a name="ln-161"></a>    <span class="c">!*********************************************************</span>
<a name="ln-162"></a>
<a name="ln-163"></a>    <span class="c">!*********************************************************</span>
<a name="ln-164"></a>    <span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-165"></a>    <span class="c">!  date: 07/23/2015</span>
<a name="ln-166"></a>    <span class="c">!</span>
<a name="ln-167"></a>    <span class="c">!  Structure constructor to initialize a [[json_file(type)]] object</span>
<a name="ln-168"></a>    <span class="c">!  with an existing [[json_value]] object, and either the [[json_core]]</span>
<a name="ln-169"></a>    <span class="c">!  settings or a [[json_core]] instance.</span>
<a name="ln-170"></a>    <span class="c">!</span>
<a name="ln-171"></a>    <span class="c">!# Example</span>
<a name="ln-172"></a>    <span class="c">!</span>
<a name="ln-173"></a>    <span class="c">!```fortran</span>
<a name="ln-174"></a>    <span class="c">! ...</span>
<a name="ln-175"></a>    <span class="c">! type(json_file)  :: my_file</span>
<a name="ln-176"></a>    <span class="c">! type(json_value),pointer :: json_object</span>
<a name="ln-177"></a>    <span class="c">! type(json_core) :: json_core_object</span>
<a name="ln-178"></a>    <span class="c">! ...</span>
<a name="ln-179"></a>    <span class="c">! ! Construct a json_object:</span>
<a name="ln-180"></a>    <span class="c">! !could do this:</span>
<a name="ln-181"></a>    <span class="c">!   my_file = json_file(json_object)</span>
<a name="ln-182"></a>    <span class="c">! !or:</span>
<a name="ln-183"></a>    <span class="c">!   my_file = json_file(json_object,verbose=.true.)</span>
<a name="ln-184"></a>    <span class="c">! !or:</span>
<a name="ln-185"></a>    <span class="c">!   my_file = json_file(json_object,json_core_object)</span>
<a name="ln-186"></a>    <span class="c">!```</span>
<a name="ln-187"></a>    <span class="k">interface </span><span class="n">json_file</span>
<a name="ln-188"></a>       <span class="k">module procedure </span><span class="n">initialize_json_file</span><span class="p">,</span> <span class="n">initialize_json_file_v2</span>
<a name="ln-189"></a>    <span class="k">end interface</span>
<a name="ln-190"></a>    <span class="c">!*************************************************************************************</span>
<a name="ln-191"></a>
<a name="ln-192"></a>    <span class="k">contains</span>
<a name="ln-193"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-194"></a>
<a name="ln-195"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-196"></a><span class="c">!&gt;</span>
<a name="ln-197"></a><span class="c">!  Check error status in the file.</span>
<a name="ln-198"></a>
<a name="ln-199"></a>    <span class="k">pure function </span><span class="n">json_file_failed</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">failed</span><span class="p">)</span>
<a name="ln-200"></a>
<a name="ln-201"></a>    <span class="k">implicit none</span>
<a name="ln-202"></a>
<a name="ln-203"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-204"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">failed</span>  <span class="c">!! will be true if there has been an error.</span>
<a name="ln-205"></a>
<a name="ln-206"></a>    <span class="n">failed</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">()</span>
<a name="ln-207"></a>
<a name="ln-208"></a>    <span class="k">end function </span><span class="n">json_file_failed</span>
<a name="ln-209"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-210"></a>
<a name="ln-211"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-212"></a><span class="c">!&gt;</span>
<a name="ln-213"></a><span class="c">!  Retrieve error status and message from the class.</span>
<a name="ln-214"></a>
<a name="ln-215"></a>    <span class="k">subroutine </span><span class="n">json_file_check_for_errors</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">status_ok</span><span class="p">,</span><span class="n">error_msg</span><span class="p">)</span>
<a name="ln-216"></a>
<a name="ln-217"></a>    <span class="k">implicit none</span>
<a name="ln-218"></a>
<a name="ln-219"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-220"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">status_ok</span> <span class="c">!! true if there were no errors</span>
<a name="ln-221"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">error_msg</span> <span class="c">!! the error message (if there were errors)</span>
<a name="ln-222"></a>
<a name="ln-223"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">check_for_errors</span><span class="p">(</span><span class="n">status_ok</span><span class="p">,</span><span class="n">error_msg</span><span class="p">)</span>
<a name="ln-224"></a>
<a name="ln-225"></a>    <span class="k">end subroutine </span><span class="n">json_file_check_for_errors</span>
<a name="ln-226"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-227"></a>
<a name="ln-228"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-229"></a><span class="c">!&gt;</span>
<a name="ln-230"></a><span class="c">!  Clear exceptions in the class.</span>
<a name="ln-231"></a>
<a name="ln-232"></a>    <span class="k">pure subroutine </span><span class="n">json_file_clear_exceptions</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
<a name="ln-233"></a>
<a name="ln-234"></a>    <span class="k">implicit none</span>
<a name="ln-235"></a>
<a name="ln-236"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-237"></a>
<a name="ln-238"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">clear_exceptions</span><span class="p">()</span>
<a name="ln-239"></a>
<a name="ln-240"></a>    <span class="k">end subroutine </span><span class="n">json_file_clear_exceptions</span>
<a name="ln-241"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-244"></a><span class="c">!&gt;</span>
<a name="ln-245"></a><span class="c">!  This is a wrapper for [[json_print_error_message]].</span>
<a name="ln-246"></a>
<a name="ln-247"></a>    <span class="k">subroutine </span><span class="n">json_file_print_error_message</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">io_unit</span><span class="p">)</span>
<a name="ln-248"></a>
<a name="ln-249"></a>    <span class="k">implicit none</span>
<a name="ln-250"></a>
<a name="ln-251"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-252"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">io_unit</span>
<a name="ln-253"></a>
<a name="ln-254"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">print_error_message</span><span class="p">(</span><span class="n">io_unit</span><span class="p">)</span>
<a name="ln-255"></a>
<a name="ln-256"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_error_message</span>
<a name="ln-257"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-258"></a>
<a name="ln-259"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-260"></a><span class="c">!&gt;</span>
<a name="ln-261"></a><span class="c">!  Initialize the [[json_core]] for this [[json_file]].</span>
<a name="ln-262"></a><span class="c">!  This is just a wrapper for [[json_initialize]].</span>
<a name="ln-263"></a><span class="c">!</span>
<a name="ln-264"></a><span class="c">!@note: This does not destroy the data in the file.</span>
<a name="ln-265"></a><span class="c">!</span>
<a name="ln-266"></a><span class="c">!@note [[initialize_json_core]], [[json_initialize]],</span>
<a name="ln-267"></a><span class="c">!      [[initialize_json_core_in_file]], and [[initialize_json_file]]</span>
<a name="ln-268"></a><span class="c">!      all have a similar interface.</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="k">subroutine </span><span class="n">initialize_json_core_in_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span><span class="n">compact_reals</span><span class="p">,&amp;</span>
<a name="ln-271"></a>                                            <span class="n">print_signs</span><span class="p">,</span><span class="n">real_format</span><span class="p">,</span><span class="n">spaces_per_tab</span><span class="p">,&amp;</span>
<a name="ln-272"></a>                                            <span class="n">strict_type_checking</span><span class="p">,&amp;</span>
<a name="ln-273"></a>                                            <span class="n">trailing_spaces_significant</span><span class="p">,&amp;</span>
<a name="ln-274"></a>                                            <span class="n">case_sensitive_keys</span><span class="p">,&amp;</span>
<a name="ln-275"></a>                                            <span class="n">no_whitespace</span><span class="p">,&amp;</span>
<a name="ln-276"></a>                                            <span class="n">unescape_strings</span><span class="p">)</span>
<a name="ln-277"></a>
<a name="ln-278"></a>    <span class="k">implicit none</span>
<a name="ln-279"></a>
<a name="ln-280"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-281"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">verbose</span>       <span class="c">!! mainly useful for debugging (default is false)</span>
<a name="ln-282"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">compact_reals</span> <span class="c">!! to compact the real number strings for output (default is true)</span>
<a name="ln-283"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">print_signs</span>   <span class="c">!! always print numeric sign (default is false)</span>
<a name="ln-284"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">real_format</span> <span class="c">!! Real number format: &#39;E&#39; [default], &#39;*&#39;, &#39;G&#39;, &#39;EN&#39;, or &#39;ES&#39;</span>
<a name="ln-285"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">spaces_per_tab</span> <span class="c">!! number of spaces per tab for indenting (default is 2)</span>
<a name="ln-286"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">strict_type_checking</span> <span class="c">!! if true, no integer, double, or logical type</span>
<a name="ln-287"></a>                                                            <span class="c">!! conversions are done for the `get` routines</span>
<a name="ln-288"></a>                                                            <span class="c">!! (default is false)</span>
<a name="ln-289"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">trailing_spaces_significant</span>  <span class="c">!! for name and path comparisons, is trailing</span>
<a name="ln-290"></a>                                                                    <span class="c">!! space to be considered significant.</span>
<a name="ln-291"></a>                                                                    <span class="c">!! (default is false)</span>
<a name="ln-292"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">case_sensitive_keys</span>  <span class="c">!! for name and path comparisons, are they</span>
<a name="ln-293"></a>                                                            <span class="c">!! case sensitive. (default is true)</span>
<a name="ln-294"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">no_whitespace</span>  <span class="c">!! if true, printing the JSON structure is</span>
<a name="ln-295"></a>                                                      <span class="c">!! done without adding any non-significant</span>
<a name="ln-296"></a>                                                      <span class="c">!! spaces or linebreaks (default is false)</span>
<a name="ln-297"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">unescape_strings</span> <span class="c">!! If false, then the raw escaped</span>
<a name="ln-298"></a>                                                        <span class="c">!! string is returned from [[json_get_string]]</span>
<a name="ln-299"></a>                                                        <span class="c">!! and similar routines. If true [default],</span>
<a name="ln-300"></a>                                                        <span class="c">!! then the string is returned unescaped.</span>
<a name="ln-301"></a>
<a name="ln-302"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span><span class="n">compact_reals</span><span class="p">,&amp;</span>
<a name="ln-303"></a>                            <span class="n">print_signs</span><span class="p">,</span><span class="n">real_format</span><span class="p">,</span><span class="n">spaces_per_tab</span><span class="p">,&amp;</span>
<a name="ln-304"></a>                            <span class="n">strict_type_checking</span><span class="p">,&amp;</span>
<a name="ln-305"></a>                            <span class="n">trailing_spaces_significant</span><span class="p">,&amp;</span>
<a name="ln-306"></a>                            <span class="n">case_sensitive_keys</span><span class="p">,&amp;</span>
<a name="ln-307"></a>                            <span class="n">no_whitespace</span><span class="p">,&amp;</span>
<a name="ln-308"></a>                            <span class="n">unescape_strings</span><span class="p">)</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="k">end subroutine </span><span class="n">initialize_json_core_in_file</span>
<a name="ln-311"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-312"></a>
<a name="ln-313"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-314"></a><span class="c">!&gt;</span>
<a name="ln-315"></a><span class="c">!  Set the [[json_core]] for this [[json_file]].</span>
<a name="ln-316"></a><span class="c">!</span>
<a name="ln-317"></a><span class="c">!@note: This does not destroy the data in the file.</span>
<a name="ln-318"></a><span class="c">!</span>
<a name="ln-319"></a><span class="c">!@note: This one is used if you want to initialize the file with</span>
<a name="ln-320"></a><span class="c">!       an already-existing [[json_core]] (presumably, this was already</span>
<a name="ln-321"></a><span class="c">!       initialized by a call to [[initialize_json_core]] or similar).</span>
<a name="ln-322"></a>
<a name="ln-323"></a>    <span class="k">subroutine </span><span class="n">set_json_core_in_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">core</span><span class="p">)</span>
<a name="ln-324"></a>
<a name="ln-325"></a>    <span class="k">implicit none</span>
<a name="ln-326"></a>
<a name="ln-327"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-328"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">core</span>
<a name="ln-329"></a>
<a name="ln-330"></a>    <span class="n">me</span><span class="p">%</span><span class="n">core</span> <span class="o">=</span> <span class="n">core</span>
<a name="ln-331"></a>
<a name="ln-332"></a>    <span class="k">end subroutine </span><span class="n">set_json_core_in_file</span>
<a name="ln-333"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-334"></a>
<a name="ln-335"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-336"></a><span class="c">!&gt;</span>
<a name="ln-337"></a><span class="c">!  Get a copy of the [[json_core]] in this [[json_file]].</span>
<a name="ln-338"></a>
<a name="ln-339"></a>    <span class="k">subroutine </span><span class="n">get_json_core_in_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">core</span><span class="p">)</span>
<a name="ln-340"></a>
<a name="ln-341"></a>    <span class="k">implicit none</span>
<a name="ln-342"></a>
<a name="ln-343"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-344"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">core</span>
<a name="ln-345"></a>
<a name="ln-346"></a>    <span class="n">core</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span>
<a name="ln-347"></a>
<a name="ln-348"></a>    <span class="k">end subroutine </span><span class="n">get_json_core_in_file</span>
<a name="ln-349"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-350"></a>
<a name="ln-351"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-352"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-353"></a><span class="c">!  date: 07/23/2015</span>
<a name="ln-354"></a><span class="c">!</span>
<a name="ln-355"></a><span class="c">!  Cast a [[json_value]] object as a [[json_file(type)]] object.</span>
<a name="ln-356"></a><span class="c">!  It also calls the `initialize()` method.</span>
<a name="ln-357"></a><span class="c">!</span>
<a name="ln-358"></a><span class="c">!@note [[initialize_json_core]], [[json_initialize]],</span>
<a name="ln-359"></a><span class="c">!      [[initialize_json_core_in_file]], and [[initialize_json_file]]</span>
<a name="ln-360"></a><span class="c">!      all have a similar interface.</span>
<a name="ln-361"></a>
<a name="ln-362"></a>    <span class="k">function </span><span class="n">initialize_json_file</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span><span class="n">compact_reals</span><span class="p">,&amp;</span>
<a name="ln-363"></a>                                  <span class="n">print_signs</span><span class="p">,</span><span class="n">real_format</span><span class="p">,</span><span class="n">spaces_per_tab</span><span class="p">,&amp;</span>
<a name="ln-364"></a>                                  <span class="n">strict_type_checking</span><span class="p">,&amp;</span>
<a name="ln-365"></a>                                  <span class="n">trailing_spaces_significant</span><span class="p">,&amp;</span>
<a name="ln-366"></a>                                  <span class="n">case_sensitive_keys</span><span class="p">,&amp;</span>
<a name="ln-367"></a>                                  <span class="n">no_whitespace</span><span class="p">,&amp;</span>
<a name="ln-368"></a>                                  <span class="n">unescape_strings</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-369"></a>
<a name="ln-370"></a>    <span class="k">implicit none</span>
<a name="ln-371"></a>
<a name="ln-372"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-373"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">optional</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>  <span class="c">!! `json_value` object to cast</span>
<a name="ln-374"></a>                                                       <span class="c">!! as a `json_file` object</span>
<a name="ln-375"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">verbose</span>       <span class="c">!! mainly useful for debugging (default is false)</span>
<a name="ln-376"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">compact_reals</span> <span class="c">!! to compact the real number strings for output (default is true)</span>
<a name="ln-377"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">print_signs</span>   <span class="c">!! always print numeric sign (default is false)</span>
<a name="ln-378"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">real_format</span> <span class="c">!! Real number format: &#39;E&#39; [default], &#39;*&#39;, &#39;G&#39;, &#39;EN&#39;, or &#39;ES&#39;</span>
<a name="ln-379"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">spaces_per_tab</span> <span class="c">!! number of spaces per tab for indenting (default is 2)</span>
<a name="ln-380"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">strict_type_checking</span> <span class="c">!! if true, no integer, double, or logical type</span>
<a name="ln-381"></a>                                                            <span class="c">!! conversions are done for the `get` routines</span>
<a name="ln-382"></a>                                                            <span class="c">!! (default is false)</span>
<a name="ln-383"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">trailing_spaces_significant</span>  <span class="c">!! for name and path comparisons, is trailing</span>
<a name="ln-384"></a>                                                                    <span class="c">!! space to be considered significant.</span>
<a name="ln-385"></a>                                                                    <span class="c">!! (default is false)</span>
<a name="ln-386"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">case_sensitive_keys</span>  <span class="c">!! for name and path comparisons, are they</span>
<a name="ln-387"></a>                                                            <span class="c">!! case sensitive. (default is true)</span>
<a name="ln-388"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">no_whitespace</span>  <span class="c">!! if true, printing the JSON structure is</span>
<a name="ln-389"></a>                                                      <span class="c">!! done without adding any non-significant</span>
<a name="ln-390"></a>                                                      <span class="c">!! spaces or linebreaks (default is false)</span>
<a name="ln-391"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">unescape_strings</span> <span class="c">!! If false, then the raw escaped</span>
<a name="ln-392"></a>                                                        <span class="c">!! string is returned from [[json_get_string]]</span>
<a name="ln-393"></a>                                                        <span class="c">!! and similar routines. If true [default],</span>
<a name="ln-394"></a>                                                        <span class="c">!! then the string is returned unescaped.</span>
<a name="ln-395"></a>
<a name="ln-396"></a>    <span class="k">call </span><span class="n">file_object</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span><span class="n">compact_reals</span><span class="p">,&amp;</span>
<a name="ln-397"></a>                                <span class="n">print_signs</span><span class="p">,</span><span class="n">real_format</span><span class="p">,</span><span class="n">spaces_per_tab</span><span class="p">,&amp;</span>
<a name="ln-398"></a>                                <span class="n">strict_type_checking</span><span class="p">,&amp;</span>
<a name="ln-399"></a>                                <span class="n">trailing_spaces_significant</span><span class="p">,&amp;</span>
<a name="ln-400"></a>                                <span class="n">case_sensitive_keys</span><span class="p">,&amp;</span>
<a name="ln-401"></a>                                <span class="n">no_whitespace</span><span class="p">,&amp;</span>
<a name="ln-402"></a>                                <span class="n">unescape_strings</span><span class="p">)</span>
<a name="ln-403"></a>
<a name="ln-404"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="n">file_object</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">p</span>
<a name="ln-405"></a>
<a name="ln-406"></a>    <span class="k">end function </span><span class="n">initialize_json_file</span>
<a name="ln-407"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-408"></a>
<a name="ln-409"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-410"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-411"></a><span class="c">!  date: 4/26/2016</span>
<a name="ln-412"></a><span class="c">!</span>
<a name="ln-413"></a><span class="c">!  Cast a [[json_value]] pointer and a [[json_core]] object</span>
<a name="ln-414"></a><span class="c">!  as a [[json_file(type)]] object.</span>
<a name="ln-415"></a>
<a name="ln-416"></a>    <span class="k">function </span><span class="n">initialize_json_file_v2</span><span class="p">(</span><span class="n">json_value_object</span><span class="p">,</span> <span class="n">json_core_object</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-417"></a>                                        <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-418"></a>
<a name="ln-419"></a>    <span class="k">implicit none</span>
<a name="ln-420"></a>
<a name="ln-421"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-422"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">json_value_object</span>
<a name="ln-423"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">json_core_object</span>
<a name="ln-424"></a>
<a name="ln-425"></a>    <span class="n">file_object</span><span class="p">%</span><span class="n">p</span>    <span class="o">=&gt;</span> <span class="n">json_value_object</span>
<a name="ln-426"></a>    <span class="n">file_object</span><span class="p">%</span><span class="n">core</span> <span class="o">=</span> <span class="n">json_core_object</span>
<a name="ln-427"></a>
<a name="ln-428"></a>    <span class="k">end function </span><span class="n">initialize_json_file_v2</span>
<a name="ln-429"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-430"></a>
<a name="ln-431"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-432"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-433"></a><span class="c">!</span>
<a name="ln-434"></a><span class="c">!  Destroy the [[json_value]] data in a [[json_file(type)]].</span>
<a name="ln-435"></a><span class="c">!  This must be done when the variable is no longer needed,</span>
<a name="ln-436"></a><span class="c">!  or will be reused to open a different file.</span>
<a name="ln-437"></a><span class="c">!  Otherwise a memory leak will occur.</span>
<a name="ln-438"></a><span class="c">!</span>
<a name="ln-439"></a><span class="c">!  Optionally, also destroy the [[json_core]] instance (this</span>
<a name="ln-440"></a><span class="c">!  is not necessary to prevent memory leaks, since a [[json_core]]</span>
<a name="ln-441"></a><span class="c">!  does not use pointers).</span>
<a name="ln-442"></a><span class="c">!</span>
<a name="ln-443"></a><span class="c">!### History</span>
<a name="ln-444"></a><span class="c">!  * 12/9/2013 : Created</span>
<a name="ln-445"></a><span class="c">!  * 4/26/2016 : Added optional `destroy_core` argument</span>
<a name="ln-446"></a>
<a name="ln-447"></a>    <span class="k">subroutine </span><span class="n">json_file_destroy</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">destroy_core</span><span class="p">)</span>
<a name="ln-448"></a>
<a name="ln-449"></a>    <span class="k">implicit none</span>
<a name="ln-450"></a>
<a name="ln-451"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-452"></a>    <span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">destroy_core</span>  <span class="c">!! to also destroy the [[json_core]].</span>
<a name="ln-453"></a>                                                 <span class="c">!! default is to leave it as is.</span>
<a name="ln-454"></a>
<a name="ln-455"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">destroy</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-456"></a>
<a name="ln-457"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">destroy_core</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-458"></a><span class="k">        if</span> <span class="p">(</span><span class="n">destroy_core</span><span class="p">)</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>
<a name="ln-459"></a>    <span class="k">end if</span>
<a name="ln-460"></a>
<a name="ln-461"></a><span class="k">    end subroutine </span><span class="n">json_file_destroy</span>
<a name="ln-462"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-463"></a>
<a name="ln-464"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-465"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-466"></a><span class="c">!  date: 12/5/2014</span>
<a name="ln-467"></a><span class="c">!</span>
<a name="ln-468"></a><span class="c">!  Move the [[json_value]] pointer from one [[json_file(type)]] to another.</span>
<a name="ln-469"></a><span class="c">!  The &quot;from&quot; pointer is then nullified, but not destroyed.</span>
<a name="ln-470"></a><span class="c">!</span>
<a name="ln-471"></a><span class="c">!@note If &quot;from%p&quot; is not associated, then an error is thrown.</span>
<a name="ln-472"></a>
<a name="ln-473"></a>    <span class="k">subroutine </span><span class="n">json_file_move_pointer</span><span class="p">(</span><span class="n">to</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-474"></a>
<a name="ln-475"></a>    <span class="k">implicit none</span>
<a name="ln-476"></a>
<a name="ln-477"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to</span>
<a name="ln-478"></a>    <span class="k">class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">from</span>
<a name="ln-479"></a>
<a name="ln-480"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">from</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-481"></a>
<a name="ln-482"></a><span class="k">        if</span> <span class="p">(</span><span class="n">from</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-483"></a>            <span class="c">!Don&#39;t get the data if the FROM file has an</span>
<a name="ln-484"></a>            <span class="c">!active exception, since it may not be valid.</span>
<a name="ln-485"></a>            <span class="k">call </span><span class="n">to</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="s1">&#39;Error in json_file_move_pointer: &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-486"></a>                                         <span class="s1">&#39;error exception in FROM file.&#39;</span><span class="p">)</span>
<a name="ln-487"></a>        <span class="k">else</span>
<a name="ln-488"></a><span class="k">            call </span><span class="n">to</span><span class="p">%</span><span class="n">initialize</span><span class="p">()</span>  <span class="c">!initialize and clear any exceptions that may be present</span>
<a name="ln-489"></a>            <span class="n">to</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">from</span><span class="p">%</span><span class="n">p</span>
<a name="ln-490"></a>            <span class="k">nullify</span><span class="p">(</span><span class="n">from</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-491"></a>        <span class="k">end if</span>
<a name="ln-492"></a>
<a name="ln-493"></a><span class="k">    else</span>
<a name="ln-494"></a><span class="k">        call </span><span class="n">to</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="s1">&#39;Error in json_file_move_pointer: &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-495"></a>                                     <span class="s1">&#39;pointer is not associated.&#39;</span><span class="p">)</span>
<a name="ln-496"></a>    <span class="k">end if</span>
<a name="ln-497"></a>
<a name="ln-498"></a><span class="k">    end subroutine </span><span class="n">json_file_move_pointer</span>
<a name="ln-499"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-500"></a>
<a name="ln-501"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-502"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-503"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-504"></a><span class="c">!</span>
<a name="ln-505"></a><span class="c">!  Load the JSON data from a file.</span>
<a name="ln-506"></a><span class="c">!</span>
<a name="ln-507"></a><span class="c">!# Example</span>
<a name="ln-508"></a><span class="c">!</span>
<a name="ln-509"></a><span class="c">!```fortran</span>
<a name="ln-510"></a><span class="c">!     program main</span>
<a name="ln-511"></a><span class="c">!      use json_module</span>
<a name="ln-512"></a><span class="c">!      implicit none</span>
<a name="ln-513"></a><span class="c">!      type(json_file) :: f</span>
<a name="ln-514"></a><span class="c">!      call f%load_file(&#39;my_file.json&#39;)</span>
<a name="ln-515"></a><span class="c">!      !...</span>
<a name="ln-516"></a><span class="c">!      call f%destroy()</span>
<a name="ln-517"></a><span class="c">!     end program main</span>
<a name="ln-518"></a><span class="c">!```</span>
<a name="ln-519"></a>
<a name="ln-520"></a>    <span class="k">subroutine </span><span class="n">json_file_load</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
<a name="ln-521"></a>
<a name="ln-522"></a>    <span class="k">implicit none</span>
<a name="ln-523"></a>
<a name="ln-524"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-525"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>  <span class="c">!! the filename to open</span>
<a name="ln-526"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!! the unit number to use (if not present, a newunit is used)</span>
<a name="ln-527"></a>
<a name="ln-528"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-529"></a>
<a name="ln-530"></a>    <span class="k">end subroutine </span><span class="n">json_file_load</span>
<a name="ln-531"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-532"></a>
<a name="ln-533"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-534"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-535"></a><span class="c">!  date: 1/13/2015</span>
<a name="ln-536"></a><span class="c">!</span>
<a name="ln-537"></a><span class="c">!  Load the JSON data from a string.</span>
<a name="ln-538"></a><span class="c">!</span>
<a name="ln-539"></a><span class="c">!# Example</span>
<a name="ln-540"></a><span class="c">!</span>
<a name="ln-541"></a><span class="c">!  Load JSON from a string:</span>
<a name="ln-542"></a><span class="c">!```fortran</span>
<a name="ln-543"></a><span class="c">!     type(json_file) :: f</span>
<a name="ln-544"></a><span class="c">!     call f%load_from_string(&#39;{ &quot;name&quot;: &quot;Leonidas&quot; }&#39;)</span>
<a name="ln-545"></a><span class="c">!```</span>
<a name="ln-546"></a>
<a name="ln-547"></a>    <span class="k">subroutine </span><span class="n">json_file_load_from_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
<a name="ln-548"></a>
<a name="ln-549"></a>    <span class="k">implicit none</span>
<a name="ln-550"></a>
<a name="ln-551"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-552"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to load JSON data from</span>
<a name="ln-553"></a>
<a name="ln-554"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">parse</span><span class="p">(</span><span class="n">str</span><span class="o">=</span><span class="n">str</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-555"></a>
<a name="ln-556"></a>    <span class="k">end subroutine </span><span class="n">json_file_load_from_string</span>
<a name="ln-557"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-558"></a>
<a name="ln-559"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-560"></a><span class="c">!&gt;</span>
<a name="ln-561"></a><span class="c">!  Alternate version of [[json_file_load_from_string]], where &quot;str&quot; is kind=CDK.</span>
<a name="ln-562"></a>
<a name="ln-563"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_load_from_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
<a name="ln-564"></a>
<a name="ln-565"></a>    <span class="k">implicit none</span>
<a name="ln-566"></a>
<a name="ln-567"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-568"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-569"></a>
<a name="ln-570"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">load_from_string</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>
<a name="ln-571"></a>
<a name="ln-572"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_load_from_string</span>
<a name="ln-573"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-574"></a>
<a name="ln-575"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-576"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-577"></a><span class="c">!  date: 1/11/2015</span>
<a name="ln-578"></a><span class="c">!</span>
<a name="ln-579"></a><span class="c">!  Print the JSON file to the console.</span>
<a name="ln-580"></a>
<a name="ln-581"></a>    <span class="k">subroutine </span><span class="n">json_file_print_to_console</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
<a name="ln-582"></a>
<a name="ln-583"></a>    <span class="k">implicit none</span>
<a name="ln-584"></a>
<a name="ln-585"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">me</span>
<a name="ln-586"></a>
<a name="ln-587"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="k">print</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">iunit</span><span class="o">=</span><span class="n">output_unit</span><span class="p">)</span>
<a name="ln-588"></a>
<a name="ln-589"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_to_console</span>
<a name="ln-590"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-591"></a>
<a name="ln-592"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-593"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-594"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-595"></a><span class="c">!</span>
<a name="ln-596"></a><span class="c">!  Prints the JSON file to the specified file unit number.</span>
<a name="ln-597"></a>
<a name="ln-598"></a>    <span class="k">subroutine </span><span class="n">json_file_print_1</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">iunit</span><span class="p">)</span>
<a name="ln-599"></a>
<a name="ln-600"></a>    <span class="k">implicit none</span>
<a name="ln-601"></a>
<a name="ln-602"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">me</span>
<a name="ln-603"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">iunit</span>  <span class="c">!! file unit number (must not be -1)</span>
<a name="ln-604"></a>
<a name="ln-605"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iunit</span><span class="o">/=</span><span class="n">unit2str</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-606"></a><span class="k">        call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="k">print</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">iunit</span><span class="o">=</span><span class="n">iunit</span><span class="p">)</span>
<a name="ln-607"></a>    <span class="k">else</span>
<a name="ln-608"></a><span class="k">        call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="s1">&#39;Error in json_file_print_1: iunit must not be -1.&#39;</span><span class="p">)</span>
<a name="ln-609"></a>    <span class="k">end if</span>
<a name="ln-610"></a>
<a name="ln-611"></a><span class="k">    end subroutine </span><span class="n">json_file_print_1</span>
<a name="ln-612"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-613"></a>
<a name="ln-614"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-615"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-616"></a><span class="c">!  date: 1/11/2015</span>
<a name="ln-617"></a><span class="c">!</span>
<a name="ln-618"></a><span class="c">!  Print the JSON structure to the specified filename.</span>
<a name="ln-619"></a><span class="c">!  The file is opened, printed, and then closed.</span>
<a name="ln-620"></a><span class="c">!</span>
<a name="ln-621"></a><span class="c">!# Example</span>
<a name="ln-622"></a><span class="c">!  Example loading a JSON file, changing a value, and then printing</span>
<a name="ln-623"></a><span class="c">!  result to a new file:</span>
<a name="ln-624"></a><span class="c">!```fortran</span>
<a name="ln-625"></a><span class="c">!     type(json_file) :: f</span>
<a name="ln-626"></a><span class="c">!     logical :: found</span>
<a name="ln-627"></a><span class="c">!     call f%load_file(&#39;my_file.json&#39;)    !open the original file</span>
<a name="ln-628"></a><span class="c">!     call f%update(&#39;version&#39;,4,found)    !change the value of a variable</span>
<a name="ln-629"></a><span class="c">!     call f%print_file(&#39;my_file_2.json&#39;) !save file as new name</span>
<a name="ln-630"></a><span class="c">!```</span>
<a name="ln-631"></a>
<a name="ln-632"></a>    <span class="k">subroutine </span><span class="n">json_file_print_2</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
<a name="ln-633"></a>
<a name="ln-634"></a>    <span class="k">implicit none</span>
<a name="ln-635"></a>
<a name="ln-636"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-637"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>  <span class="c">!! filename to print to</span>
<a name="ln-638"></a>
<a name="ln-639"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="k">print</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
<a name="ln-640"></a>
<a name="ln-641"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_2</span>
<a name="ln-642"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-643"></a>
<a name="ln-644"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-645"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-646"></a><span class="c">!  date: 1/11/2015</span>
<a name="ln-647"></a><span class="c">!</span>
<a name="ln-648"></a><span class="c">!  Print the JSON file to a string.</span>
<a name="ln-649"></a><span class="c">!</span>
<a name="ln-650"></a><span class="c">!# Example</span>
<a name="ln-651"></a><span class="c">!</span>
<a name="ln-652"></a><span class="c">!  Open a JSON file, and then print the contents to a string:</span>
<a name="ln-653"></a><span class="c">!```fortran</span>
<a name="ln-654"></a><span class="c">!     type(json_file) :: f</span>
<a name="ln-655"></a><span class="c">!     character(kind=CK,len=:),allocatable :: str</span>
<a name="ln-656"></a><span class="c">!     call f%load_file(&#39;my_file.json&#39;)</span>
<a name="ln-657"></a><span class="c">!     call f%print_file(str)</span>
<a name="ln-658"></a><span class="c">!```</span>
<a name="ln-659"></a>
<a name="ln-660"></a>    <span class="k">subroutine </span><span class="n">json_file_print_to_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-661"></a>
<a name="ln-662"></a>    <span class="k">implicit none</span>
<a name="ln-663"></a>
<a name="ln-664"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-665"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to print JSON data to</span>
<a name="ln-666"></a>
<a name="ln-667"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">print_to_string</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-668"></a>
<a name="ln-669"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_to_string</span>
<a name="ln-670"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-671"></a>
<a name="ln-672"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-673"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-674"></a><span class="c">!  date: 2/3/2014</span>
<a name="ln-675"></a><span class="c">!</span>
<a name="ln-676"></a><span class="c">!  Returns information about a variable in a [[json_file(type)]].</span>
<a name="ln-677"></a><span class="c">!</span>
<a name="ln-678"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-679"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-680"></a><span class="c">!      variable is not found.</span>
<a name="ln-681"></a>
<a name="ln-682"></a>    <span class="k">subroutine </span><span class="n">json_file_variable_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-683"></a>
<a name="ln-684"></a>    <span class="k">implicit none</span>
<a name="ln-685"></a>
<a name="ln-686"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-687"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>       <span class="c">!! path to the variable</span>
<a name="ln-688"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>      <span class="c">!! the variable exists in the structure</span>
<a name="ln-689"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">var_type</span>   <span class="c">!! variable type</span>
<a name="ln-690"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">n_children</span> <span class="c">!! number of children</span>
<a name="ln-691"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-692"></a>
<a name="ln-693"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-694"></a>
<a name="ln-695"></a>    <span class="k">end subroutine </span><span class="n">json_file_variable_info</span>
<a name="ln-696"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-697"></a>
<a name="ln-698"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-699"></a><span class="c">!&gt;</span>
<a name="ln-700"></a><span class="c">!  Alternate version of [[json_file_variable_info]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-701"></a><span class="c">!</span>
<a name="ln-702"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-703"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-704"></a><span class="c">!      variable is not found.</span>
<a name="ln-705"></a>
<a name="ln-706"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_variable_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="k">implicit none</span>
<a name="ln-709"></a>
<a name="ln-710"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-711"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-712"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-713"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">var_type</span>
<a name="ln-714"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">n_children</span>
<a name="ln-715"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-716"></a>
<a name="ln-717"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-718"></a>
<a name="ln-719"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_variable_info</span>
<a name="ln-720"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-721"></a>
<a name="ln-722"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-723"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-724"></a><span class="c">!  date: 6/26/2016</span>
<a name="ln-725"></a><span class="c">!</span>
<a name="ln-726"></a><span class="c">!  Returns matrix information about a variable in a [[json_file(type)]].</span>
<a name="ln-727"></a><span class="c">!</span>
<a name="ln-728"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-729"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-730"></a><span class="c">!      variable is not found.</span>
<a name="ln-731"></a>
<a name="ln-732"></a>    <span class="k">subroutine </span><span class="n">json_file_variable_matrix_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-733"></a>                                        <span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-734"></a>
<a name="ln-735"></a>    <span class="k">implicit none</span>
<a name="ln-736"></a>
<a name="ln-737"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-738"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>      <span class="c">!! path to the variable</span>
<a name="ln-739"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">is_matrix</span> <span class="c">!! true if it is a valid matrix</span>
<a name="ln-740"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>     <span class="c">!! true if it was found</span>
<a name="ln-741"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">var_type</span>  <span class="c">!! variable type of data in</span>
<a name="ln-742"></a>                                                     <span class="c">!! the matrix (if all elements have</span>
<a name="ln-743"></a>                                                     <span class="c">!! the same type)</span>
<a name="ln-744"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">n_sets</span>    <span class="c">!! number of data sets (i.e., matrix</span>
<a name="ln-745"></a>                                                     <span class="c">!! rows if using row-major order)</span>
<a name="ln-746"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">set_size</span>  <span class="c">!! size of each data set (i.e., matrix</span>
<a name="ln-747"></a>                                                     <span class="c">!! cols if using row-major order)</span>
<a name="ln-748"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-749"></a>
<a name="ln-750"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">matrix_info</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-751"></a>
<a name="ln-752"></a>    <span class="k">end subroutine </span><span class="n">json_file_variable_matrix_info</span>
<a name="ln-753"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-754"></a>
<a name="ln-755"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-756"></a><span class="c">!&gt;</span>
<a name="ln-757"></a><span class="c">!  Alternate version of [[json_file_variable_matrix_info]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-758"></a><span class="c">!</span>
<a name="ln-759"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-760"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-761"></a><span class="c">!      variable is not found.</span>
<a name="ln-762"></a>
<a name="ln-763"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_variable_matrix_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-764"></a>                                                   <span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-765"></a>
<a name="ln-766"></a>    <span class="k">implicit none</span>
<a name="ln-767"></a>
<a name="ln-768"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-769"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>      <span class="c">!! path to the variable</span>
<a name="ln-770"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">is_matrix</span> <span class="c">!! true if it is a valid matrix</span>
<a name="ln-771"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>     <span class="c">!! true if it was found</span>
<a name="ln-772"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">var_type</span>  <span class="c">!! variable type of data in</span>
<a name="ln-773"></a>                                                      <span class="c">!! the matrix (if all elements have</span>
<a name="ln-774"></a>                                                      <span class="c">!! the same type)</span>
<a name="ln-775"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">n_sets</span>    <span class="c">!! number of data sets (i.e., matrix</span>
<a name="ln-776"></a>                                                      <span class="c">!! rows if using row-major order)</span>
<a name="ln-777"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">set_size</span>  <span class="c">!! size of each data set (i.e., matrix</span>
<a name="ln-778"></a>                                                      <span class="c">!! cols if using row-major order)</span>
<a name="ln-779"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-780"></a>
<a name="ln-781"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">matrix_info</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-782"></a>
<a name="ln-783"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_variable_matrix_info</span>
<a name="ln-784"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-785"></a>
<a name="ln-786"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-787"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-788"></a><span class="c">!  date: 7/23/2015</span>
<a name="ln-789"></a><span class="c">!</span>
<a name="ln-790"></a><span class="c">!  Get a [[json_value]] pointer to the JSON file root.</span>
<a name="ln-791"></a><span class="c">!</span>
<a name="ln-792"></a><span class="c">!@note This is equivalent to calling ```[[json_file]]%get(&#39;$&#39;,p)```</span>
<a name="ln-793"></a>
<a name="ln-794"></a>    <span class="k">subroutine </span><span class="n">json_file_get_root</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-795"></a>
<a name="ln-796"></a>    <span class="k">implicit none</span>
<a name="ln-797"></a>
<a name="ln-798"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-799"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>      <span class="c">!! pointer to the variable</span>
<a name="ln-800"></a>
<a name="ln-801"></a>    <span class="n">p</span> <span class="o">=&gt;</span> <span class="n">me</span><span class="p">%</span><span class="n">p</span>
<a name="ln-802"></a>
<a name="ln-803"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_root</span>
<a name="ln-804"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-805"></a>
<a name="ln-806"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-807"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-808"></a><span class="c">!  date: 2/3/2014</span>
<a name="ln-809"></a><span class="c">!</span>
<a name="ln-810"></a><span class="c">!  Get a [[json_value]] pointer to an object from a JSON file.</span>
<a name="ln-811"></a>
<a name="ln-812"></a>    <span class="k">subroutine </span><span class="n">json_file_get_object</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-813"></a>
<a name="ln-814"></a>    <span class="k">implicit none</span>
<a name="ln-815"></a>
<a name="ln-816"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-817"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-818"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>      <span class="c">!! pointer to the variable</span>
<a name="ln-819"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-820"></a>
<a name="ln-821"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="o">=</span><span class="n">found</span><span class="p">)</span>
<a name="ln-822"></a>
<a name="ln-823"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_object</span>
<a name="ln-824"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-825"></a>
<a name="ln-826"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-827"></a><span class="c">!&gt;</span>
<a name="ln-828"></a><span class="c">!  Alternate version of [[json_file_get_object]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-829"></a>
<a name="ln-830"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_object</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-831"></a>
<a name="ln-832"></a>    <span class="k">implicit none</span>
<a name="ln-833"></a>
<a name="ln-834"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-835"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-836"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>
<a name="ln-837"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-838"></a>
<a name="ln-839"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-840"></a>
<a name="ln-841"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_object</span>
<a name="ln-842"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-843"></a>
<a name="ln-844"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-845"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-846"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-847"></a><span class="c">!</span>
<a name="ln-848"></a><span class="c">!  Get an integer value from a JSON file.</span>
<a name="ln-849"></a>
<a name="ln-850"></a>    <span class="k">subroutine </span><span class="n">json_file_get_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-851"></a>
<a name="ln-852"></a>    <span class="k">implicit none</span>
<a name="ln-853"></a>
<a name="ln-854"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-855"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-856"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>    <span class="c">!! value</span>
<a name="ln-857"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-858"></a>
<a name="ln-859"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="o">=</span><span class="n">found</span><span class="p">)</span>
<a name="ln-860"></a>
<a name="ln-861"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_integer</span>
<a name="ln-862"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-863"></a>
<a name="ln-864"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-865"></a><span class="c">!&gt;</span>
<a name="ln-866"></a><span class="c">!  Alternate version of [[json_file_get_integer]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-867"></a>
<a name="ln-868"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-869"></a>
<a name="ln-870"></a>    <span class="k">implicit none</span>
<a name="ln-871"></a>
<a name="ln-872"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-873"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-874"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-875"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-876"></a>
<a name="ln-877"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-878"></a>
<a name="ln-879"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_integer</span>
<a name="ln-880"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-881"></a>
<a name="ln-882"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-883"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-884"></a><span class="c">!  date: 1/20/2014</span>
<a name="ln-885"></a><span class="c">!</span>
<a name="ln-886"></a><span class="c">!  Get an integer vector from a JSON file.</span>
<a name="ln-887"></a>
<a name="ln-888"></a>    <span class="k">subroutine </span><span class="n">json_file_get_integer_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-889"></a>
<a name="ln-890"></a>    <span class="k">implicit none</span>
<a name="ln-891"></a>
<a name="ln-892"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-893"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-894"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>    <span class="c">!! the value vector</span>
<a name="ln-895"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-896"></a>
<a name="ln-897"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-898"></a>
<a name="ln-899"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_integer_vec</span>
<a name="ln-900"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-901"></a>
<a name="ln-902"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-903"></a><span class="c">!&gt;</span>
<a name="ln-904"></a><span class="c">!  Alternate version of [[json_file_get_integer_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-905"></a>
<a name="ln-906"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_integer_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-907"></a>
<a name="ln-908"></a>    <span class="k">implicit none</span>
<a name="ln-909"></a>
<a name="ln-910"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-911"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>
<a name="ln-912"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-913"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>
<a name="ln-914"></a>
<a name="ln-915"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-916"></a>
<a name="ln-917"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_integer_vec</span>
<a name="ln-918"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-919"></a>
<a name="ln-920"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-921"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-922"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-923"></a><span class="c">!</span>
<a name="ln-924"></a><span class="c">!  Get a real(RK) variable value from a JSON file.</span>
<a name="ln-925"></a>
<a name="ln-926"></a>    <span class="k">subroutine </span><span class="n">json_file_get_double</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-927"></a>
<a name="ln-928"></a>    <span class="k">implicit none</span>
<a name="ln-929"></a>
<a name="ln-930"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-931"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-932"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">val</span>
<a name="ln-933"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>
<a name="ln-934"></a>
<a name="ln-935"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="o">=</span><span class="n">found</span><span class="p">)</span>
<a name="ln-936"></a>
<a name="ln-937"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_double</span>
<a name="ln-938"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-939"></a>
<a name="ln-940"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-941"></a><span class="c">!&gt;</span>
<a name="ln-942"></a><span class="c">!  Alternate version of [[json_file_get_double]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-943"></a>
<a name="ln-944"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_double</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-945"></a>
<a name="ln-946"></a>    <span class="k">implicit none</span>
<a name="ln-947"></a>
<a name="ln-948"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-949"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-950"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">val</span>
<a name="ln-951"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-952"></a>
<a name="ln-953"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-954"></a>
<a name="ln-955"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_double</span>
<a name="ln-956"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-957"></a>
<a name="ln-958"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-959"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-960"></a><span class="c">!  date: 1/19/2014</span>
<a name="ln-961"></a><span class="c">!</span>
<a name="ln-962"></a><span class="c">!  Get a real(RK) vector from a JSON file.</span>
<a name="ln-963"></a>
<a name="ln-964"></a>    <span class="k">subroutine </span><span class="n">json_file_get_double_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-965"></a>
<a name="ln-966"></a>    <span class="k">implicit none</span>
<a name="ln-967"></a>
<a name="ln-968"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-969"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">path</span>
<a name="ln-970"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-971"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-972"></a>
<a name="ln-973"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-974"></a>
<a name="ln-975"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_double_vec</span>
<a name="ln-976"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-977"></a>
<a name="ln-978"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-979"></a><span class="c">!&gt;</span>
<a name="ln-980"></a><span class="c">!  Alternate version of [[json_file_get_double_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-981"></a>
<a name="ln-982"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_double_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-983"></a>
<a name="ln-984"></a>    <span class="k">implicit none</span>
<a name="ln-985"></a>
<a name="ln-986"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-987"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">path</span>
<a name="ln-988"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-989"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-990"></a>
<a name="ln-991"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-992"></a>
<a name="ln-993"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_double_vec</span>
<a name="ln-994"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-995"></a>
<a name="ln-996"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-997"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-998"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-999"></a><span class="c">!</span>
<a name="ln-1000"></a><span class="c">!  Get a logical(LK) value from a JSON file.</span>
<a name="ln-1001"></a>
<a name="ln-1002"></a>    <span class="k">subroutine </span><span class="n">json_file_get_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1003"></a>
<a name="ln-1004"></a>    <span class="k">implicit none</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1007"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1008"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1009"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1010"></a>
<a name="ln-1011"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="o">=</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1012"></a>
<a name="ln-1013"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_logical</span>
<a name="ln-1014"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1015"></a>
<a name="ln-1016"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1017"></a><span class="c">!&gt;</span>
<a name="ln-1018"></a><span class="c">!  Alternate version of [[json_file_get_logical]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1019"></a>
<a name="ln-1020"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a>    <span class="k">implicit none</span>
<a name="ln-1023"></a>
<a name="ln-1024"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1025"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1026"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1027"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1028"></a>
<a name="ln-1029"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1030"></a>
<a name="ln-1031"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_logical</span>
<a name="ln-1032"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1033"></a>
<a name="ln-1034"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1035"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1036"></a><span class="c">!  date: 1/20/2014</span>
<a name="ln-1037"></a><span class="c">!</span>
<a name="ln-1038"></a><span class="c">!  Get a logical(LK) vector from a JSON file.</span>
<a name="ln-1039"></a>
<a name="ln-1040"></a>    <span class="k">subroutine </span><span class="n">json_file_get_logical_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1041"></a>
<a name="ln-1042"></a>    <span class="k">implicit none</span>
<a name="ln-1043"></a>
<a name="ln-1044"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1045"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1046"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-1047"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1048"></a>
<a name="ln-1049"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_logical_vec</span>
<a name="ln-1052"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1055"></a><span class="c">!&gt;</span>
<a name="ln-1056"></a><span class="c">!  Alternate version of [[json_file_get_logical_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_logical_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>    <span class="k">implicit none</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1063"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1064"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-1065"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1066"></a>
<a name="ln-1067"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1068"></a>
<a name="ln-1069"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_logical_vec</span>
<a name="ln-1070"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1071"></a>
<a name="ln-1072"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1073"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1074"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-1075"></a><span class="c">!</span>
<a name="ln-1076"></a><span class="c">!  Get a character string from a json file.</span>
<a name="ln-1077"></a><span class="c">!  The output val is an allocatable character string.</span>
<a name="ln-1078"></a>
<a name="ln-1079"></a>    <span class="k">subroutine </span><span class="n">json_file_get_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1080"></a>
<a name="ln-1081"></a>    <span class="k">implicit none</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1084"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1085"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1086"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1087"></a>
<a name="ln-1088"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="k">value</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="o">=</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1089"></a>
<a name="ln-1090"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_string</span>
<a name="ln-1091"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1092"></a>
<a name="ln-1093"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1094"></a><span class="c">!&gt;</span>
<a name="ln-1095"></a><span class="c">!  Alternate version of [[json_file_get_string]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1096"></a>
<a name="ln-1097"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1098"></a>
<a name="ln-1099"></a>    <span class="k">implicit none</span>
<a name="ln-1100"></a>
<a name="ln-1101"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1102"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1103"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1104"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1105"></a>
<a name="ln-1106"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1107"></a>
<a name="ln-1108"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_string</span>
<a name="ln-1109"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1110"></a>
<a name="ln-1111"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1112"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1113"></a><span class="c">!  date: 1/19/2014</span>
<a name="ln-1114"></a><span class="c">!</span>
<a name="ln-1115"></a><span class="c">!  Get a string vector from a JSON file.</span>
<a name="ln-1116"></a>
<a name="ln-1117"></a>    <span class="k">subroutine </span><span class="n">json_file_get_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1118"></a>
<a name="ln-1119"></a>    <span class="k">implicit none</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1122"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1123"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-1124"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1125"></a>
<a name="ln-1126"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1127"></a>
<a name="ln-1128"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_string_vec</span>
<a name="ln-1129"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1130"></a>
<a name="ln-1131"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1132"></a><span class="c">!&gt;</span>
<a name="ln-1133"></a><span class="c">!  Alternate version of [[json_file_get_string_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1134"></a>
<a name="ln-1135"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1136"></a>
<a name="ln-1137"></a>    <span class="k">implicit none</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1140"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1141"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>
<a name="ln-1142"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_string_vec</span>
<a name="ln-1147"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1148"></a>
<a name="ln-1149"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1150"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1151"></a><span class="c">!  date:1/10/2015</span>
<a name="ln-1152"></a><span class="c">!</span>
<a name="ln-1153"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-1154"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-1155"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-1156"></a><span class="c">!</span>
<a name="ln-1157"></a><span class="c">!# See also</span>
<a name="ln-1158"></a><span class="c">!  * [[json_update_integer]]</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a>    <span class="k">subroutine </span><span class="n">json_file_update_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1161"></a>
<a name="ln-1162"></a>    <span class="k">implicit none</span>
<a name="ln-1163"></a>
<a name="ln-1164"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1165"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1166"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1167"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1170"></a>
<a name="ln-1171"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_integer</span>
<a name="ln-1172"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1173"></a>
<a name="ln-1174"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1175"></a><span class="c">!&gt;</span>
<a name="ln-1176"></a><span class="c">!  Alternate version of [[json_file_update_integer]], where &quot;name&quot; is kind=CDK.</span>
<a name="ln-1177"></a>
<a name="ln-1178"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1179"></a>
<a name="ln-1180"></a>    <span class="k">implicit none</span>
<a name="ln-1181"></a>
<a name="ln-1182"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1183"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1184"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1185"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1186"></a>
<a name="ln-1187"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1188"></a>
<a name="ln-1189"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_integer</span>
<a name="ln-1190"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1193"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1194"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-1195"></a><span class="c">!</span>
<a name="ln-1196"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-1197"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-1198"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-1199"></a><span class="c">!</span>
<a name="ln-1200"></a><span class="c">!# See also</span>
<a name="ln-1201"></a><span class="c">!  * [[json_update_logical]]</span>
<a name="ln-1202"></a>
<a name="ln-1203"></a>    <span class="k">subroutine </span><span class="n">json_file_update_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a>    <span class="k">implicit none</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1208"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1209"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1210"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1211"></a>
<a name="ln-1212"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_logical</span>
<a name="ln-1215"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1216"></a>
<a name="ln-1217"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1218"></a><span class="c">!&gt;</span>
<a name="ln-1219"></a><span class="c">!  Alternate version of [[json_file_update_logical]], where &quot;name&quot; is kind=CDK.</span>
<a name="ln-1220"></a>
<a name="ln-1221"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>    <span class="k">implicit none</span>
<a name="ln-1224"></a>
<a name="ln-1225"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1226"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1227"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1228"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1229"></a>
<a name="ln-1230"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1231"></a>
<a name="ln-1232"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_logical</span>
<a name="ln-1233"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1236"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1237"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-1238"></a><span class="c">!</span>
<a name="ln-1239"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-1240"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-1241"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-1242"></a><span class="c">!</span>
<a name="ln-1243"></a><span class="c">!# See also</span>
<a name="ln-1244"></a><span class="c">!  * [[json_update_double]]</span>
<a name="ln-1245"></a>
<a name="ln-1246"></a>    <span class="k">subroutine </span><span class="n">json_file_update_real</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>    <span class="k">implicit none</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1251"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1252"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1253"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1254"></a>
<a name="ln-1255"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1256"></a>
<a name="ln-1257"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_real</span>
<a name="ln-1258"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1259"></a>
<a name="ln-1260"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1261"></a><span class="c">!&gt;</span>
<a name="ln-1262"></a><span class="c">!  Alternate version of [[json_file_update_real]], where &quot;name&quot; is kind=CDK.</span>
<a name="ln-1263"></a>
<a name="ln-1264"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_real</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1265"></a>
<a name="ln-1266"></a>    <span class="k">implicit none</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1269"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1270"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1271"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_real</span>
<a name="ln-1276"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1277"></a>
<a name="ln-1278"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1279"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1280"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-1281"></a><span class="c">!</span>
<a name="ln-1282"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-1283"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-1284"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-1285"></a><span class="c">!</span>
<a name="ln-1286"></a><span class="c">!# See also</span>
<a name="ln-1287"></a><span class="c">!  * [[json_update_string]]</span>
<a name="ln-1288"></a>
<a name="ln-1289"></a>    <span class="k">subroutine </span><span class="n">json_file_update_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1290"></a>
<a name="ln-1291"></a>    <span class="k">implicit none</span>
<a name="ln-1292"></a>
<a name="ln-1293"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1294"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1295"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1296"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1299"></a>
<a name="ln-1300"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_string</span>
<a name="ln-1301"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1302"></a>
<a name="ln-1303"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1304"></a><span class="c">!&gt;</span>
<a name="ln-1305"></a><span class="c">!  Alternate version of [[json_file_update_string]], where &quot;name&quot; and &quot;val&quot; are kind=CDK.</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1308"></a>
<a name="ln-1309"></a>    <span class="k">implicit none</span>
<a name="ln-1310"></a>
<a name="ln-1311"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1312"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1313"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1314"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1315"></a>
<a name="ln-1316"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_string</span>
<a name="ln-1319"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1322"></a><span class="c">!&gt;</span>
<a name="ln-1323"></a><span class="c">!  Alternate version of [[json_file_update_string]], where &quot;name&quot; is kind=CDK.</span>
<a name="ln-1324"></a>
<a name="ln-1325"></a>    <span class="k">subroutine </span><span class="n">json_file_update_string_name_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1326"></a>
<a name="ln-1327"></a>    <span class="k">implicit none</span>
<a name="ln-1328"></a>
<a name="ln-1329"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1330"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1331"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1332"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1333"></a>
<a name="ln-1334"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1335"></a>
<a name="ln-1336"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_string_name_ascii</span>
<a name="ln-1337"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1338"></a>
<a name="ln-1339"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1340"></a><span class="c">!&gt;</span>
<a name="ln-1341"></a><span class="c">!  Alternate version of [[json_file_update_string]], where &quot;val&quot; is kind=CDK.</span>
<a name="ln-1342"></a>
<a name="ln-1343"></a>    <span class="k">subroutine </span><span class="n">json_file_update_string_val_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1344"></a>
<a name="ln-1345"></a>    <span class="k">implicit none</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1348"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-1349"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-1350"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1351"></a>
<a name="ln-1352"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1353"></a>
<a name="ln-1354"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_string_val_ascii</span>
<a name="ln-1355"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1356"></a>
<a name="ln-1357"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1358"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1359"></a><span class="c">!  date: 6/11/2016</span>
<a name="ln-1360"></a><span class="c">!</span>
<a name="ln-1361"></a><span class="c">!  Traverse the JSON structure in the file.</span>
<a name="ln-1362"></a><span class="c">!  This routine calls the user-specified [[json_traverse_callback_func]]</span>
<a name="ln-1363"></a><span class="c">!  for each element of the structure.</span>
<a name="ln-1364"></a>
<a name="ln-1365"></a>    <span class="k">subroutine </span><span class="n">json_file_traverse</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">traverse_callback</span><span class="p">)</span>
<a name="ln-1366"></a>
<a name="ln-1367"></a>    <span class="k">implicit none</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1370"></a>    <span class="k">procedure</span><span class="p">(</span><span class="n">json_traverse_callback_func</span><span class="p">)</span> <span class="kd">::</span> <span class="n">traverse_callback</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">traverse</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">traverse_callback</span><span class="p">)</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>    <span class="k">end subroutine </span><span class="n">json_file_traverse</span>
<a name="ln-1375"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1376"></a>
<a name="ln-1377"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1378"></a>    <span class="k">end module </span><span class="n">json_file_module</span>
<a name="ln-1379"></a><span class="c">!*****************************************************************************************</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/jf_test_1.f90.html">jf_test_1.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_10.f90.html">jf_test_10.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_11.f90.html">jf_test_11.F90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_12.f90.html">jf_test_12.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_13.f90.html">jf_test_13.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_14.f90.html">jf_test_14.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_15.f90.html">jf_test_15.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_16.f90.html">jf_test_16.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_17.f90.html">jf_test_17.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_18.f90.html">jf_test_18.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_19.f90.html">jf_test_19.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_2.f90.html">jf_test_2.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_20.f90.html">jf_test_20.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_3.f90.html">jf_test_3.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_4.f90.html">jf_test_4.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_5.f90.html">jf_test_5.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_6.f90.html">jf_test_6.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_7.f90.html">jf_test_7.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_8.f90.html">jf_test_8.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jf_test_9.f90.html">jf_test_9.f90</a>
      
      <a class="list-group-item" href="../sourcefile/json_file_module.f90.html">json_file_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_kinds.f90.html">json_kinds.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_module.f90.html">json_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_parameters.f90.html">json_parameters.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_string_utilities.f90.html">json_string_utilities.F90</a>
      
      <a class="list-group-item" href="../sourcefile/json_value_module.f90.html">json_value_module.F90</a>
      
      <a class="list-group-item" href="../sourcefile/test_iso_10646_support.f90.html">test_iso_10646_support.f90</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2016 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2016-08-14 16:03  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> JSON-Fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>