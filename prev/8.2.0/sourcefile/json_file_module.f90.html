<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="JSON-Fortran â€“ A Fortran 2008 JSON API">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>json_file_module.F90 &ndash; JSON-Fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">JSON-Fortran <small>8.2.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>json_file_module.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="15.3% of total for source files.">1113 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/json_file_module.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">json_file_module.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/json_file_module.html">json_file_module</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/json_file_module.f90.html#src">json_file_module.F90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: sourcefile~~json_file_module.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilejson_file_modulef90EfferentGraph" width="641pt" height="90pt"
 viewBox="0.00 0.00 641.00 89.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~json_file_module.f90~~EfferentGraph" class="graph" transform="scale(0.887812 0.887812) rotate(0) translate(4 97.117)">
<title>sourcefile~~json_file_module.f90~~EfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-97.117 718,-97.117 718,4 -4,4"/>
<!-- sourcefile~json_file_module.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_node1" class="node"><title>sourcefile~json_file_module.f90</title>
<polygon fill="none" stroke="black" points="713.5,-63 598.5,-63 598.5,-39 713.5,-39 713.5,-63"/>
<text text-anchor="middle" x="656" y="-48.6" font-family="Helvetica,sans-Serif" font-size="10.50">json_file_module.F90</text>
</g>
<!-- sourcefile~json_value_module.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_node2" class="node"><title>sourcefile~json_value_module.f90</title>
<g id="a_sourcefile~~json_file_module.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/json_value_module.f90.html" xlink:title="json_value_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="561.5,-63 434.5,-63 434.5,-39 561.5,-39 561.5,-63"/>
<text text-anchor="middle" x="498" y="-48.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_value_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_value_module.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge1" class="edge"><title>sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_value_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M598.239,-51C589.568,-51 580.517,-51 571.562,-51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="571.518,-47.5001 561.518,-51 571.518,-54.5001 571.518,-47.5001"/>
</g>
<!-- sourcefile~json_parameters.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_node3" class="node"><title>sourcefile~json_parameters.f90</title>
<g id="a_sourcefile~~json_file_module.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/json_parameters.f90.html" xlink:title="json_parameters.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="237.5,-63 122.5,-63 122.5,-39 237.5,-39 237.5,-63"/>
<text text-anchor="middle" x="180" y="-48.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_parameters.F90</text>
</a>
</g>
</g>
<!-- sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_parameters.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge2" class="edge"><title>sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.877,-63.0027C543.552,-76.8863 432.651,-97.1065 337,-91"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M335,-91C295.141,-89.687 251.259,-77.1327 220.57,-66.4341"/>
<polygon fill="#ff0000" stroke="#ff0000" points="221.686,-63.1161 211.091,-63.0424 219.327,-69.7069 221.686,-63.1161"/>
</g>
<!-- sourcefile~json_kinds.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_node4" class="node"><title>sourcefile~json_kinds.f90</title>
<g id="a_sourcefile~~json_file_module.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/json_kinds.f90.html" xlink:title="json_kinds.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="85.5,-63 0.5,-63 0.5,-39 85.5,-39 85.5,-63"/>
<text text-anchor="middle" x="43" y="-48.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_kinds.F90</text>
</a>
</g>
</g>
<!-- sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_kinds.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge3" class="edge"><title>sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_kinds.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M335,-91C266.593,-88.7466 249.218,-96.5678 181,-91"/>
</g>
<!-- sourcefile~json_string_utilities.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_node5" class="node"><title>sourcefile~json_string_utilities.f90</title>
<g id="a_sourcefile~~json_file_module.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/json_string_utilities.f90.html" xlink:title="json_string_utilities.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="398,-24 274,-24 274,-0 398,-0 398,-24"/>
<text text-anchor="middle" x="336" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_string_utilities.F90</text>
</a>
</g>
</g>
<!-- sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_string_utilities.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge4" class="edge"><title>sourcefile~json_file_module.f90&#45;&gt;sourcefile~json_string_utilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M607.458,-38.8971C592.947,-35.5735 576.891,-32.2652 562,-30 510.962,-22.2365 452.869,-17.6966 408.498,-15.1184"/>
<polygon fill="#ff0000" stroke="#ff0000" points="408.569,-11.6169 398.389,-14.551 408.177,-18.6059 408.569,-11.6169"/>
</g>
<!-- sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_parameters.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge5" class="edge"><title>sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_parameters.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M434.254,-50.3029C404.717,-50.3541 369.021,-50.9604 337,-53"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M335,-53C306.488,-54.8161 274.949,-54.7678 247.876,-54.095"/>
<polygon fill="#ff0000" stroke="#ff0000" points="247.83,-50.5924 237.735,-53.8092 247.632,-57.5896 247.83,-50.5924"/>
</g>
<!-- sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_kinds.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge6" class="edge"><title>sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_kinds.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M335,-53C264.645,-57.4814 251.264,-96.7348 181,-91"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M179,-91C145.19,-88.2405 108.366,-76.7188 81.7305,-66.7454"/>
<polygon fill="#ff0000" stroke="#ff0000" points="82.6385,-63.3447 72.0486,-63.0203 80.1248,-69.8778 82.6385,-63.3447"/>
</g>
<!-- sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_string_utilities.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge7" class="edge"><title>sourcefile~json_value_module.f90&#45;&gt;sourcefile~json_string_utilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M447.689,-38.9805C431.417,-35.0141 413.148,-30.5611 396.214,-26.4335"/>
<polygon fill="#ff0000" stroke="#ff0000" points="396.968,-23.0148 386.423,-24.047 395.31,-29.8156 396.968,-23.0148"/>
</g>
<!-- sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_kinds.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge8" class="edge"><title>sourcefile~json_parameters.f90&#45;&gt;sourcefile~json_kinds.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M122.139,-51C113.43,-51 104.479,-51 95.8844,-51"/>
<polygon fill="#7fff00" stroke="#7fff00" points="95.619,-47.5001 85.619,-51 95.6189,-54.5001 95.619,-47.5001"/>
</g>
<!-- sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_parameters.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge9" class="edge"><title>sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_parameters.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M287.538,-24.0195C272.023,-27.9488 254.621,-32.3557 238.451,-36.4507"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="237.405,-33.1051 228.57,-38.953 239.123,-39.8909 237.405,-33.1051"/>
</g>
<!-- sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_kinds.f90 -->
<g id="sourcefile~~json_file_module.f90~~EfferentGraph_edge10" class="edge"><title>sourcefile~json_string_utilities.f90&#45;&gt;sourcefile~json_kinds.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M273.571,-14.2825C230.817,-16.5793 172.626,-21.1194 122,-30 112.568,-31.6545 102.619,-33.9204 93.099,-36.3538"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="92.1427,-32.9863 83.3733,-38.9317 93.9363,-39.7526 92.1427,-32.9863"/>
</g>
</g>
</svg>
</div><script>var pansourcefilejson_file_modulef90EfferentGraph = svgPanZoom('#sourcefilejson_file_modulef90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="189pt" height="32pt"
 viewBox="0.00 0.00 189.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 185,-28 185,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66.25,-24 -0.25,-24 -0.25,-0 66.25,-0 66.25,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="181.25,-24 84.75,-24 84.75,-0 181.25,-0 181.25,-24"/>
<text text-anchor="middle" x="133" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: sourcefile~~json_file_module.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilejson_file_modulef90AfferentGraph" width="256pt" height="32pt"
 viewBox="0.00 0.00 256.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~json_file_module.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~json_file_module.f90~~AfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 252,-28 252,4 -4,4"/>
<!-- sourcefile~json_file_module.f90 -->
<g id="sourcefile~~json_file_module.f90~~AfferentGraph_node1" class="node"><title>sourcefile~json_file_module.f90</title>
<polygon fill="none" stroke="black" points="115.5,-24 0.5,-24 0.5,-0 115.5,-0 115.5,-24"/>
<text text-anchor="middle" x="58" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">json_file_module.F90</text>
</g>
<!-- sourcefile~json_module.f90 -->
<g id="sourcefile~~json_file_module.f90~~AfferentGraph_node2" class="node"><title>sourcefile~json_module.f90</title>
<g id="a_sourcefile~~json_file_module.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/json_module.f90.html" xlink:title="json_module.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="247.5,-24 152.5,-24 152.5,-0 247.5,-0 247.5,-24"/>
<text text-anchor="middle" x="200" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">json_module.F90</text>
</a>
</g>
</g>
<!-- sourcefile~json_module.f90&#45;&gt;sourcefile~json_file_module.f90 -->
<g id="sourcefile~~json_file_module.f90~~AfferentGraph_edge1" class="edge"><title>sourcefile~json_module.f90&#45;&gt;sourcefile~json_file_module.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M152.382,-12C143.829,-12 134.749,-12 125.742,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="125.634,-8.5001 115.634,-12 125.634,-15.5001 125.634,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="189pt" height="32pt"
 viewBox="0.00 0.00 189.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 185,-28 185,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66.25,-24 -0.25,-24 -0.25,-0 66.25,-0 66.25,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="181.25,-24 84.75,-24 84.75,-0 181.25,-0 181.25,-24"/>
<text text-anchor="middle" x="133" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/json_file_module.html">json_file_module</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/json_file_module.f90.html#src">json_file_module.F90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-3"></a><span class="c">!  license: BSD</span>
<a name="ln-4"></a><span class="c">!</span>
<a name="ln-5"></a><span class="c">!  Higher-level [[json_file]] interface for the [[json_value]] type.</span>
<a name="ln-6"></a><span class="c">!</span>
<a name="ln-7"></a><span class="c">!### License</span>
<a name="ln-8"></a><span class="c">!  * JSON-Fortran is released under a BSD-style license.</span>
<a name="ln-9"></a><span class="c">!    See the [LICENSE](https://github.com/jacobwilliams/json-fortran/blob/master/LICENSE)</span>
<a name="ln-10"></a><span class="c">!    file for details.</span>
<a name="ln-11"></a>
<a name="ln-12"></a>    <span class="k">module </span><span class="n">json_file_module</span>
<a name="ln-13"></a>
<a name="ln-14"></a>    <span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span>
<a name="ln-15"></a>    <span class="k">use </span><span class="n">json_kinds</span>
<a name="ln-16"></a>    <span class="k">use </span><span class="n">json_parameters</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">unit2str</span>
<a name="ln-17"></a>    <span class="k">use </span><span class="n">json_string_utilities</span>
<a name="ln-18"></a>    <span class="k">use </span><span class="n">json_value_module</span>
<a name="ln-19"></a>
<a name="ln-20"></a>    <span class="k">implicit none</span>
<a name="ln-21"></a>
<a name="ln-22"></a><span class="k">    private</span>
<a name="ln-23"></a>
<a name="ln-24"></a><span class="cp">#include &quot;json_macros.inc&quot;</span>
<a name="ln-25"></a>
<a name="ln-26"></a>    <span class="c">!*********************************************************</span>
<a name="ln-27"></a>    <span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-28"></a>    <span class="c">!  date: 12/9/2013</span>
<a name="ln-29"></a>    <span class="c">!</span>
<a name="ln-30"></a>    <span class="c">!  The `json_file` is the main public class that is</span>
<a name="ln-31"></a>    <span class="c">!  used to open a file and get data from it.</span>
<a name="ln-32"></a>    <span class="c">!</span>
<a name="ln-33"></a>    <span class="c">!  A `json_file` contains only two items: an instance of a [[json_core(type)]],</span>
<a name="ln-34"></a>    <span class="c">!  which is used for all data manipulation, and a [[json_value]] pointer,</span>
<a name="ln-35"></a>    <span class="c">!  which is used to construct the linked-list data structure.</span>
<a name="ln-36"></a>    <span class="c">!  Note that most methods in the `json_file` class are simply wrappers</span>
<a name="ln-37"></a>    <span class="c">!  to the lower-level routines in the [[json_value_module]].</span>
<a name="ln-38"></a>    <span class="c">!</span>
<a name="ln-39"></a>    <span class="c">!### Example</span>
<a name="ln-40"></a>    <span class="c">!</span>
<a name="ln-41"></a>    <span class="c">!```fortran</span>
<a name="ln-42"></a>    <span class="c">!    program test</span>
<a name="ln-43"></a>    <span class="c">!    use json_module</span>
<a name="ln-44"></a>    <span class="c">!    implicit none</span>
<a name="ln-45"></a>    <span class="c">!    type(json_file) :: json</span>
<a name="ln-46"></a>    <span class="c">!    integer :: ival</span>
<a name="ln-47"></a>    <span class="c">!    real(real64) :: rval</span>
<a name="ln-48"></a>    <span class="c">!    character(len=:),allocatable :: cval</span>
<a name="ln-49"></a>    <span class="c">!    logical :: found</span>
<a name="ln-50"></a>    <span class="c">!    call json%initialize(compact_reals=.true.)</span>
<a name="ln-51"></a>    <span class="c">!    call json%load(filename=&#39;myfile.json&#39;)</span>
<a name="ln-52"></a>    <span class="c">!    call json%print() !print to the console</span>
<a name="ln-53"></a>    <span class="c">!    call json%get(&#39;var.i&#39;,ival,found)</span>
<a name="ln-54"></a>    <span class="c">!    call json%get(&#39;var.r(3)&#39;,rval,found)</span>
<a name="ln-55"></a>    <span class="c">!    call json%get(&#39;var.c&#39;,cval,found)</span>
<a name="ln-56"></a>    <span class="c">!    call json%destroy()</span>
<a name="ln-57"></a>    <span class="c">!    end program test</span>
<a name="ln-58"></a>    <span class="c">!```</span>
<a name="ln-59"></a>    <span class="c">!</span>
<a name="ln-60"></a>    <span class="c">!@note The `destroy()` method may be called to free the memory if necessary.</span>
<a name="ln-61"></a>    <span class="c">!      [[json_file(type)]] includes a finalizer that also calls</span>
<a name="ln-62"></a>    <span class="c">!      `destroy()` when the variable goes out of scope.</span>
<a name="ln-63"></a>
<a name="ln-64"></a>    <span class="k">type</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">json_file</span>
<a name="ln-65"></a>
<a name="ln-66"></a>        <span class="k">private</span>
<a name="ln-67"></a>
<a name="ln-68"></a><span class="k">        type</span><span class="p">(</span><span class="n">json_core</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">core</span>         <span class="c">!! The instance of the [[json_core(type)]]</span>
<a name="ln-69"></a>                                                 <span class="c">!! factory used for this file.</span>
<a name="ln-70"></a>        <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span> <span class="kd">::</span> <span class="n">p</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>  <span class="c">!! the JSON structure read from the file</span>
<a name="ln-71"></a>
<a name="ln-72"></a>    <span class="k">contains</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="k">        generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">initialize</span> <span class="o">=&gt;</span> <span class="n">initialize_json_core_in_file</span><span class="p">,&amp;</span>
<a name="ln-75"></a>                                        <span class="n">set_json_core_in_file</span>
<a name="ln-76"></a>
<a name="ln-77"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">get_core</span> <span class="o">=&gt;</span> <span class="n">get_json_core_in_file</span>
<a name="ln-78"></a>
<a name="ln-79"></a>        <span class="c">!&gt;</span>
<a name="ln-80"></a>        <span class="c">!  Load JSON from a file.</span>
<a name="ln-81"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">load</span> <span class="o">=&gt;</span> <span class="n">json_file_load</span>
<a name="ln-82"></a>
<a name="ln-83"></a>        <span class="c">!&gt;</span>
<a name="ln-84"></a>        <span class="c">!  The same as `load`, but only here for backward compatibility</span>
<a name="ln-85"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">load_file</span> <span class="o">=&gt;</span> <span class="n">json_file_load</span>
<a name="ln-86"></a>
<a name="ln-87"></a>        <span class="c">!&gt;</span>
<a name="ln-88"></a>        <span class="c">!  Load JSON from a string.</span>
<a name="ln-89"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">deserialize</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_load_from_string</span><span class="p">)</span>
<a name="ln-90"></a>
<a name="ln-91"></a>        <span class="c">!&gt;</span>
<a name="ln-92"></a>        <span class="c">!  The same as `deserialize`, but only here for backward compatibility</span>
<a name="ln-93"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">load_from_string</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_load_from_string</span><span class="p">)</span>
<a name="ln-94"></a>
<a name="ln-95"></a>        <span class="c">!&gt;</span>
<a name="ln-96"></a>        <span class="c">!  Print the [[json_value]] structure to an allocatable string</span>
<a name="ln-97"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">serialize</span> <span class="o">=&gt;</span> <span class="n">json_file_print_to_string</span>
<a name="ln-98"></a>
<a name="ln-99"></a>        <span class="c">!&gt;</span>
<a name="ln-100"></a>        <span class="c">!  The same as `serialize`, but only here for backward compatibility</span>
<a name="ln-101"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">print_to_string</span> <span class="o">=&gt;</span> <span class="n">json_file_print_to_string</span>
<a name="ln-102"></a>
<a name="ln-103"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">destroy</span> <span class="o">=&gt;</span> <span class="n">json_file_destroy</span>
<a name="ln-104"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="k">nullify</span> <span class="o">=&gt;</span> <span class="n">json_file_nullify</span>
<a name="ln-105"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">move</span>    <span class="o">=&gt;</span> <span class="n">json_file_move_pointer</span>
<a name="ln-106"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span>   <span class="kd">::</span> <span class="n">info</span>    <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_info</span><span class="p">)</span>
<a name="ln-107"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span>   <span class="kd">::</span> <span class="n">matrix_info</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_matrix_info</span><span class="p">)</span>
<a name="ln-108"></a>
<a name="ln-109"></a>        <span class="c">!error checking:</span>
<a name="ln-110"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">failed</span> <span class="o">=&gt;</span> <span class="n">json_file_failed</span>
<a name="ln-111"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">print_error_message</span> <span class="o">=&gt;</span> <span class="n">json_file_print_error_message</span>
<a name="ln-112"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">check_for_errors</span> <span class="o">=&gt;</span> <span class="n">json_file_check_for_errors</span>
<a name="ln-113"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">clear_exceptions</span> <span class="o">=&gt;</span> <span class="n">json_file_clear_exceptions</span>
<a name="ln-114"></a>
<a name="ln-115"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="k">print</span> <span class="o">=&gt;</span> <span class="n">json_file_print_to_console</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-116"></a>                                   <span class="n">json_file_print_to_unit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-117"></a>                                   <span class="n">json_file_print_to_filename</span>
<a name="ln-118"></a>
<a name="ln-119"></a>        <span class="c">!&gt;</span>
<a name="ln-120"></a>        <span class="c">!  The same as `print`, but only here for backward compatibility</span>
<a name="ln-121"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">print_file</span> <span class="o">=&gt;</span> <span class="n">json_file_print_to_console</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-122"></a>                                        <span class="n">json_file_print_to_unit</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-123"></a>                                        <span class="n">json_file_print_to_filename</span>
<a name="ln-124"></a>
<a name="ln-125"></a>        <span class="c">!&gt;</span>
<a name="ln-126"></a>        <span class="c">!  Rename a variable, specifying it by path</span>
<a name="ln-127"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="nb">rename</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_rename</span><span class="p">)</span>
<a name="ln-128"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-129"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="nb">rename</span> <span class="o">=&gt;</span> <span class="n">json_file_rename_path_ascii</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-130"></a>                                    <span class="n">json_file_rename_name_ascii</span>
<a name="ln-131"></a><span class="cp">#endif</span>
<a name="ln-132"></a>
<a name="ln-133"></a>        <span class="c">!&gt;</span>
<a name="ln-134"></a>        <span class="c">!  Verify that a path is valid</span>
<a name="ln-135"></a>        <span class="c">!  (i.e., a variable with this path exists in the file).</span>
<a name="ln-136"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">valid_path</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_valid_path</span><span class="p">)</span>
<a name="ln-137"></a>
<a name="ln-138"></a>        <span class="c">!&gt;</span>
<a name="ln-139"></a>        <span class="c">!  Get a variable from a [[json_file(type)]], by specifying the path.</span>
<a name="ln-140"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">get</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_object</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-141"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-142"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-143"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real32</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-144"></a><span class="cp">#endif</span>
<a name="ln-145"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real</span><span class="p">),</span>        <span class="p">&amp;</span>
<a name="ln-146"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-147"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real64</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-148"></a><span class="cp">#endif</span>
<a name="ln-149"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-150"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-151"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer_vec</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-152"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-153"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real32_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-154"></a><span class="cp">#endif</span>
<a name="ln-155"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real_vec</span><span class="p">),</span>    <span class="p">&amp;</span>
<a name="ln-156"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-157"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real64_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-158"></a><span class="cp">#endif</span>
<a name="ln-159"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical_vec</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-160"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-161"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_alloc_string_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-162"></a>                                 <span class="n">json_file_get_root</span>
<a name="ln-163"></a>
<a name="ln-164"></a>        <span class="c">!&gt;</span>
<a name="ln-165"></a>        <span class="c">!  Add a variable to a [[json_file(type)]], by specifying the path.</span>
<a name="ln-166"></a>        <span class="c">!</span>
<a name="ln-167"></a>        <span class="c">!### Example</span>
<a name="ln-168"></a>        <span class="c">!</span>
<a name="ln-169"></a>        <span class="c">!```fortran</span>
<a name="ln-170"></a>        <span class="c">!  program test</span>
<a name="ln-171"></a>        <span class="c">!  use json_module, rk=&gt;json_rk, ik=&gt;json_ik</span>
<a name="ln-172"></a>        <span class="c">!  implicit none</span>
<a name="ln-173"></a>        <span class="c">!  type(json_file) :: f</span>
<a name="ln-174"></a>        <span class="c">!  call f%initialize()  ! specify whatever init options you want.</span>
<a name="ln-175"></a>        <span class="c">!  call f%add(&#39;inputs.t&#39;, 0.0_rk)</span>
<a name="ln-176"></a>        <span class="c">!  call f%add(&#39;inputs.x&#39;, [1.0_rk,2.0_rk,3.0_rk])</span>
<a name="ln-177"></a>        <span class="c">!  call f%add(&#39;inputs.flag&#39;, .true.)</span>
<a name="ln-178"></a>        <span class="c">!  call f%print()  ! print to the console</span>
<a name="ln-179"></a>        <span class="c">!  end program test</span>
<a name="ln-180"></a>        <span class="c">!```</span>
<a name="ln-181"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">add</span> <span class="o">=&gt;</span> <span class="n">json_file_add</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-182"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_object</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-183"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_integer</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-184"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-185"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real32</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-186"></a><span class="cp">#endif</span>
<a name="ln-187"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real</span><span class="p">),</span>        <span class="p">&amp;</span>
<a name="ln-188"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-189"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real64</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-190"></a><span class="cp">#endif</span>
<a name="ln-191"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_logical</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-192"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_string</span><span class="p">),</span>      <span class="p">&amp;</span>
<a name="ln-193"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_integer_vec</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-194"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-195"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real32_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-196"></a><span class="cp">#endif</span>
<a name="ln-197"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real_vec</span><span class="p">),</span>    <span class="p">&amp;</span>
<a name="ln-198"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-199"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real64_vec</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-200"></a><span class="cp">#endif</span>
<a name="ln-201"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_logical_vec</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-202"></a>                                 <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_string_vec</span><span class="p">)</span>
<a name="ln-203"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-204"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">add</span> <span class="o">=&gt;</span> <span class="n">json_file_add_string_path_ascii</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-205"></a>                                 <span class="n">json_file_add_string_value_ascii</span><span class="p">,&amp;</span>
<a name="ln-206"></a>                                 <span class="n">json_file_add_string_vec_path_ascii</span><span class="p">,&amp;</span>
<a name="ln-207"></a>                                 <span class="n">json_file_add_string_vec_vec_ascii</span>
<a name="ln-208"></a><span class="cp">#endif</span>
<a name="ln-209"></a>
<a name="ln-210"></a>        <span class="c">!&gt;</span>
<a name="ln-211"></a>        <span class="c">!  Update a scalar variable in a [[json_file(type)]],</span>
<a name="ln-212"></a>        <span class="c">!  by specifying the path.</span>
<a name="ln-213"></a>        <span class="c">!</span>
<a name="ln-214"></a>        <span class="c">!@note These have been mostly supplanted by the `add`</span>
<a name="ln-215"></a>        <span class="c">!      methods, which do a similar thing (and can be used for</span>
<a name="ln-216"></a>        <span class="c">!      scalars and vectors, etc.)</span>
<a name="ln-217"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">update</span> <span class="o">=&gt;</span>  <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_integer</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-218"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_logical</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-219"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-220"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real32</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-221"></a><span class="cp">#endif</span>
<a name="ln-222"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real</span><span class="p">),</span>     <span class="p">&amp;</span>
<a name="ln-223"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-224"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real64</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-225"></a><span class="cp">#endif</span>
<a name="ln-226"></a>                                     <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_string</span><span class="p">)</span>
<a name="ln-227"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-228"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">update</span> <span class="o">=&gt;</span> <span class="n">json_file_update_string_name_ascii</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-229"></a>                                    <span class="n">json_file_update_string_val_ascii</span>
<a name="ln-230"></a><span class="cp">#endif</span>
<a name="ln-231"></a>
<a name="ln-232"></a>        <span class="c">!&gt;</span>
<a name="ln-233"></a>        <span class="c">!  Remove a variable from a [[json_file(type)]]</span>
<a name="ln-234"></a>        <span class="c">!  by specifying the path.</span>
<a name="ln-235"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">remove</span> <span class="o">=&gt;</span>  <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_remove</span><span class="p">)</span>
<a name="ln-236"></a>
<a name="ln-237"></a>        <span class="c">!traverse</span>
<a name="ln-238"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">traverse</span> <span class="o">=&gt;</span> <span class="n">json_file_traverse</span>
<a name="ln-239"></a>
<a name="ln-240"></a>        <span class="c">! ***************************************************</span>
<a name="ln-241"></a>        <span class="c">! operators</span>
<a name="ln-242"></a>        <span class="c">! ***************************************************</span>
<a name="ln-243"></a>
<a name="ln-244"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">operator</span><span class="p">(.</span><span class="n">in</span><span class="p">.)</span> <span class="o">=&gt;</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_valid_path_op</span><span class="p">)</span>
<a name="ln-245"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">pass</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_valid_path_op</span><span class="p">)</span>
<a name="ln-246"></a>
<a name="ln-247"></a>        <span class="k">generic</span><span class="p">,</span><span class="k">public</span> <span class="kd">::</span> <span class="n">assignment</span><span class="p">(</span><span class="o">=</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">assign_json_file</span><span class="p">,&amp;</span>
<a name="ln-248"></a>                                           <span class="n">assign_json_file_to_string</span><span class="p">,&amp;</span>
<a name="ln-249"></a>                                           <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">assign_string_to_json_file</span><span class="p">)</span>
<a name="ln-250"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">assign_json_file</span>
<a name="ln-251"></a>        <span class="k">procedure</span><span class="p">,</span><span class="k">pass</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="kd">::</span> <span class="n">assign_json_file_to_string</span>
<a name="ln-252"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">assign_string_to_json_file</span><span class="p">)</span>
<a name="ln-253"></a>
<a name="ln-254"></a>        <span class="c">! ***************************************************</span>
<a name="ln-255"></a>        <span class="c">! private routines</span>
<a name="ln-256"></a>        <span class="c">! ***************************************************</span>
<a name="ln-257"></a>
<a name="ln-258"></a>        <span class="c">!load from string:</span>
<a name="ln-259"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_load_from_string</span><span class="p">)</span>
<a name="ln-260"></a>
<a name="ln-261"></a>        <span class="c">!initialize</span>
<a name="ln-262"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">initialize_json_core_in_file</span>
<a name="ln-263"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">set_json_core_in_file</span>
<a name="ln-264"></a>
<a name="ln-265"></a>        <span class="c">!get info:</span>
<a name="ln-266"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_info</span><span class="p">)</span>
<a name="ln-267"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_variable_matrix_info</span><span class="p">)</span>
<a name="ln-268"></a>
<a name="ln-269"></a>        <span class="c">!rename:</span>
<a name="ln-270"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_rename</span><span class="p">)</span>
<a name="ln-271"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-272"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_rename_path_ascii</span>
<a name="ln-273"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_rename_name_ascii</span>
<a name="ln-274"></a><span class="cp">#endif</span>
<a name="ln-275"></a>
<a name="ln-276"></a>        <span class="c">!validate path:</span>
<a name="ln-277"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_valid_path</span><span class="p">)</span>
<a name="ln-278"></a>
<a name="ln-279"></a>        <span class="c">!get:</span>
<a name="ln-280"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_object</span><span class="p">)</span>
<a name="ln-281"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer</span><span class="p">)</span>
<a name="ln-282"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-283"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real32</span><span class="p">)</span>
<a name="ln-284"></a><span class="cp">#endif</span>
<a name="ln-285"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real</span><span class="p">)</span>
<a name="ln-286"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-287"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real64</span><span class="p">)</span>
<a name="ln-288"></a><span class="cp">#endif</span>
<a name="ln-289"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical</span><span class="p">)</span>
<a name="ln-290"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string</span><span class="p">)</span>
<a name="ln-291"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_integer_vec</span><span class="p">)</span>
<a name="ln-292"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-293"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real32_vec</span><span class="p">)</span>
<a name="ln-294"></a><span class="cp">#endif</span>
<a name="ln-295"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real_vec</span><span class="p">)</span>
<a name="ln-296"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-297"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_real64_vec</span><span class="p">)</span>
<a name="ln-298"></a><span class="cp">#endif</span>
<a name="ln-299"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_logical_vec</span><span class="p">)</span>
<a name="ln-300"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_string_vec</span><span class="p">)</span>
<a name="ln-301"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_get_alloc_string_vec</span><span class="p">)</span>
<a name="ln-302"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_get_root</span>
<a name="ln-303"></a>
<a name="ln-304"></a>        <span class="c">!add:</span>
<a name="ln-305"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_add</span>
<a name="ln-306"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_object</span><span class="p">)</span>
<a name="ln-307"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_integer</span><span class="p">)</span>
<a name="ln-308"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-309"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real32</span><span class="p">)</span>
<a name="ln-310"></a><span class="cp">#endif</span>
<a name="ln-311"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real</span><span class="p">)</span>
<a name="ln-312"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-313"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real64</span><span class="p">)</span>
<a name="ln-314"></a><span class="cp">#endif</span>
<a name="ln-315"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_logical</span><span class="p">)</span>
<a name="ln-316"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_string</span><span class="p">)</span>
<a name="ln-317"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_integer_vec</span><span class="p">)</span>
<a name="ln-318"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-319"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real32_vec</span><span class="p">)</span>
<a name="ln-320"></a><span class="cp">#endif</span>
<a name="ln-321"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real_vec</span><span class="p">)</span>
<a name="ln-322"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-323"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_real64_vec</span><span class="p">)</span>
<a name="ln-324"></a><span class="cp">#endif</span>
<a name="ln-325"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_logical_vec</span><span class="p">)</span>
<a name="ln-326"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_add_string_vec</span><span class="p">)</span>
<a name="ln-327"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-328"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_add_string_path_ascii</span>
<a name="ln-329"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_add_string_value_ascii</span>
<a name="ln-330"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_add_string_vec_path_ascii</span>
<a name="ln-331"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_add_string_vec_vec_ascii</span>
<a name="ln-332"></a><span class="cp">#endif</span>
<a name="ln-333"></a>
<a name="ln-334"></a>        <span class="c">!update:</span>
<a name="ln-335"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_integer</span><span class="p">)</span>
<a name="ln-336"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_logical</span><span class="p">)</span>
<a name="ln-337"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-338"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real32</span><span class="p">)</span>
<a name="ln-339"></a><span class="cp">#endif</span>
<a name="ln-340"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real</span><span class="p">)</span>
<a name="ln-341"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-342"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_real64</span><span class="p">)</span>
<a name="ln-343"></a><span class="cp">#endif</span>
<a name="ln-344"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_update_string</span><span class="p">)</span>
<a name="ln-345"></a><span class="cp">#ifdef USE_UCS4</span>
<a name="ln-346"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_update_string_name_ascii</span>
<a name="ln-347"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_update_string_val_ascii</span>
<a name="ln-348"></a><span class="cp">#endif</span>
<a name="ln-349"></a>
<a name="ln-350"></a>        <span class="c">!remove:</span>
<a name="ln-351"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">json_file_remove</span><span class="p">)</span>
<a name="ln-352"></a>
<a name="ln-353"></a>        <span class="c">!print:</span>
<a name="ln-354"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_print_to_console</span>
<a name="ln-355"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_print_to_unit</span>
<a name="ln-356"></a>        <span class="k">procedure</span> <span class="kd">::</span> <span class="n">json_file_print_to_filename</span>
<a name="ln-357"></a>
<a name="ln-358"></a>        <span class="k">final</span> <span class="kd">::</span> <span class="n">finalize_json_file</span>
<a name="ln-359"></a>
<a name="ln-360"></a>    <span class="k">end type </span><span class="n">json_file</span>
<a name="ln-361"></a>    <span class="c">!*********************************************************</span>
<a name="ln-362"></a>
<a name="ln-363"></a>    <span class="c">!*********************************************************</span>
<a name="ln-364"></a>    <span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-365"></a>    <span class="c">!  date: 07/23/2015</span>
<a name="ln-366"></a>    <span class="c">!</span>
<a name="ln-367"></a>    <span class="c">!  Structure constructor to initialize a [[json_file(type)]]</span>
<a name="ln-368"></a>    <span class="c">!  object with an existing [[json_value]] object or a JSON</span>
<a name="ln-369"></a>    <span class="c">!  string, and either the [[json_core(type)]] settings or a</span>
<a name="ln-370"></a>    <span class="c">!  [[json_core(type)]] instance.</span>
<a name="ln-371"></a>    <span class="c">!</span>
<a name="ln-372"></a>    <span class="c">!### Example</span>
<a name="ln-373"></a>    <span class="c">!</span>
<a name="ln-374"></a>    <span class="c">!```fortran</span>
<a name="ln-375"></a>    <span class="c">! ...</span>
<a name="ln-376"></a>    <span class="c">! type(json_file) :: my_file</span>
<a name="ln-377"></a>    <span class="c">! type(json_value),pointer :: json_object</span>
<a name="ln-378"></a>    <span class="c">! type(json_core) :: json_core_object</span>
<a name="ln-379"></a>    <span class="c">! ...</span>
<a name="ln-380"></a>    <span class="c">! ! Construct a json_object:</span>
<a name="ln-381"></a>    <span class="c">! !could do this:</span>
<a name="ln-382"></a>    <span class="c">!   my_file = json_file(json_object)</span>
<a name="ln-383"></a>    <span class="c">! !or:</span>
<a name="ln-384"></a>    <span class="c">!   my_file = json_file(json_object,verbose=.true.)</span>
<a name="ln-385"></a>    <span class="c">! !or:</span>
<a name="ln-386"></a>    <span class="c">!   my_file = json_file(&#39;{&quot;x&quot;: [1]}&#39;,verbose=.true.)</span>
<a name="ln-387"></a>    <span class="c">! !or:</span>
<a name="ln-388"></a>    <span class="c">!   my_file = json_file(json_object,json_core_object)</span>
<a name="ln-389"></a>    <span class="c">! !or:</span>
<a name="ln-390"></a>    <span class="c">!   my_file = json_file(&#39;{&quot;x&quot;: [1]}&#39;,json_core_object)</span>
<a name="ln-391"></a>    <span class="c">!```</span>
<a name="ln-392"></a>    <span class="k">interface </span><span class="n">json_file</span>
<a name="ln-393"></a>       <span class="k">module procedure </span><span class="n">initialize_json_file</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-394"></a>                        <span class="n">initialize_json_file_v2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-395"></a>                        <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">initialize_json_file_from_string</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-396"></a>                        <span class="n">MAYBEWRAP</span><span class="p">(</span><span class="n">initialize_json_file_from_string_v2</span><span class="p">)</span>
<a name="ln-397"></a>    <span class="k">end interface</span>
<a name="ln-398"></a>    <span class="c">!*************************************************************************************</span>
<a name="ln-399"></a>
<a name="ln-400"></a>    <span class="k">contains</span>
<a name="ln-401"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-402"></a>
<a name="ln-403"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-404"></a><span class="c">!&gt;</span>
<a name="ln-405"></a><span class="c">!  Finalizer for [[json_file]] class.</span>
<a name="ln-406"></a><span class="c">!</span>
<a name="ln-407"></a><span class="c">!  Just a wrapper for [[json_file_destroy]].</span>
<a name="ln-408"></a>
<a name="ln-409"></a>    <span class="k">subroutine </span><span class="n">finalize_json_file</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
<a name="ln-410"></a>
<a name="ln-411"></a>    <span class="k">implicit none</span>
<a name="ln-412"></a>
<a name="ln-413"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-414"></a>
<a name="ln-415"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">destroy</span><span class="p">(</span><span class="n">destroy_core</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-416"></a>
<a name="ln-417"></a>    <span class="k">end subroutine </span><span class="n">finalize_json_file</span>
<a name="ln-418"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-419"></a>
<a name="ln-420"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-421"></a><span class="c">!&gt;</span>
<a name="ln-422"></a><span class="c">!  Check error status in the file.</span>
<a name="ln-423"></a>
<a name="ln-424"></a>    <span class="k">pure function </span><span class="n">json_file_failed</span><span class="p">(</span><span class="n">me</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">failed</span><span class="p">)</span>
<a name="ln-425"></a>
<a name="ln-426"></a>    <span class="k">implicit none</span>
<a name="ln-427"></a>
<a name="ln-428"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-429"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">failed</span>  <span class="c">!! will be true if there has been an error.</span>
<a name="ln-430"></a>
<a name="ln-431"></a>    <span class="n">failed</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">()</span>
<a name="ln-432"></a>
<a name="ln-433"></a>    <span class="k">end function </span><span class="n">json_file_failed</span>
<a name="ln-434"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-435"></a>
<a name="ln-436"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-437"></a><span class="c">!&gt;</span>
<a name="ln-438"></a><span class="c">!  Retrieve error status and message from the class.</span>
<a name="ln-439"></a>
<a name="ln-440"></a>    <span class="k">subroutine </span><span class="n">json_file_check_for_errors</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">status_ok</span><span class="p">,</span><span class="n">error_msg</span><span class="p">)</span>
<a name="ln-441"></a>
<a name="ln-442"></a>    <span class="k">implicit none</span>
<a name="ln-443"></a>
<a name="ln-444"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-445"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">status_ok</span> <span class="c">!! true if there were no errors</span>
<a name="ln-446"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">error_msg</span> <span class="c">!! the error message</span>
<a name="ln-447"></a>                                                                           <span class="c">!! (if there were errors)</span>
<a name="ln-448"></a>
<a name="ln-449"></a><span class="cp">#if defined __GFORTRAN__</span>
<a name="ln-450"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tmp</span>  <span class="c">!! workaround for gfortran bugs</span>
<a name="ln-451"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">check_for_errors</span><span class="p">(</span><span class="n">status_ok</span><span class="p">,</span><span class="n">tmp</span><span class="p">)</span>
<a name="ln-452"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">error_msg</span><span class="p">))</span> <span class="n">error_msg</span> <span class="o">=</span> <span class="n">tmp</span>
<a name="ln-453"></a><span class="cp">#else</span>
<a name="ln-454"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">check_for_errors</span><span class="p">(</span><span class="n">status_ok</span><span class="p">,</span><span class="n">error_msg</span><span class="p">)</span>
<a name="ln-455"></a><span class="cp">#endif</span>
<a name="ln-456"></a>
<a name="ln-457"></a>    <span class="k">end subroutine </span><span class="n">json_file_check_for_errors</span>
<a name="ln-458"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-459"></a>
<a name="ln-460"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-461"></a><span class="c">!&gt;</span>
<a name="ln-462"></a><span class="c">!  Clear exceptions in the class.</span>
<a name="ln-463"></a>
<a name="ln-464"></a>    <span class="k">pure subroutine </span><span class="n">json_file_clear_exceptions</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
<a name="ln-465"></a>
<a name="ln-466"></a>    <span class="k">implicit none</span>
<a name="ln-467"></a>
<a name="ln-468"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-469"></a>
<a name="ln-470"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">clear_exceptions</span><span class="p">()</span>
<a name="ln-471"></a>
<a name="ln-472"></a>    <span class="k">end subroutine </span><span class="n">json_file_clear_exceptions</span>
<a name="ln-473"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-474"></a>
<a name="ln-475"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-476"></a><span class="c">!&gt;</span>
<a name="ln-477"></a><span class="c">!  This is a wrapper for [[json_print_error_message]].</span>
<a name="ln-478"></a>
<a name="ln-479"></a>    <span class="k">subroutine </span><span class="n">json_file_print_error_message</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">io_unit</span><span class="p">)</span>
<a name="ln-480"></a>
<a name="ln-481"></a>    <span class="k">implicit none</span>
<a name="ln-482"></a>
<a name="ln-483"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-484"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">io_unit</span>
<a name="ln-485"></a>
<a name="ln-486"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">print_error_message</span><span class="p">(</span><span class="n">io_unit</span><span class="p">)</span>
<a name="ln-487"></a>
<a name="ln-488"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_error_message</span>
<a name="ln-489"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-490"></a>
<a name="ln-491"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-492"></a><span class="c">!&gt;</span>
<a name="ln-493"></a><span class="c">!  Initialize the [[json_core(type)]] for this [[json_file]].</span>
<a name="ln-494"></a><span class="c">!  This is just a wrapper for [[json_initialize]].</span>
<a name="ln-495"></a><span class="c">!</span>
<a name="ln-496"></a><span class="c">!@note This does not destroy the data in the file.</span>
<a name="ln-497"></a><span class="c">!</span>
<a name="ln-498"></a><span class="c">!@note [[initialize_json_core]], [[json_initialize]],</span>
<a name="ln-499"></a><span class="c">!      [[initialize_json_core_in_file]], [[initialize_json_file]],</span>
<a name="ln-500"></a><span class="c">!      [[initialize_json_file_v2]], [[initialize_json_file_from_string]],</span>
<a name="ln-501"></a><span class="c">!      and [[initialize_json_file_from_string_v2]]</span>
<a name="ln-502"></a><span class="c">!      all have a similar interface.</span>
<a name="ln-503"></a>
<a name="ln-504"></a>    <span class="k">subroutine </span><span class="n">initialize_json_core_in_file</span><span class="p">(</span><span class="n">me</span><span class="p">,&amp;</span>
<a name="ln-505"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-506"></a>                                           <span class="p">)</span>
<a name="ln-507"></a>
<a name="ln-508"></a>    <span class="k">implicit none</span>
<a name="ln-509"></a>
<a name="ln-510"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-511"></a><span class="cp">#include &quot;json_initialize_arguments.inc&quot;</span>
<a name="ln-512"></a>
<a name="ln-513"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">initialize</span><span class="p">(&amp;</span>
<a name="ln-514"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-515"></a>                           <span class="p">)</span>
<a name="ln-516"></a>    <span class="k">end subroutine </span><span class="n">initialize_json_core_in_file</span>
<a name="ln-517"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-518"></a>
<a name="ln-519"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-520"></a><span class="c">!&gt;</span>
<a name="ln-521"></a><span class="c">!  Set the [[json_core(type)]] for this [[json_file]].</span>
<a name="ln-522"></a><span class="c">!</span>
<a name="ln-523"></a><span class="c">!@note This does not destroy the data in the file.</span>
<a name="ln-524"></a><span class="c">!</span>
<a name="ln-525"></a><span class="c">!@note This one is used if you want to initialize the file with</span>
<a name="ln-526"></a><span class="c">!       an already-existing [[json_core(type)]] (presumably, this was already</span>
<a name="ln-527"></a><span class="c">!       initialized by a call to [[initialize_json_core]] or similar).</span>
<a name="ln-528"></a>
<a name="ln-529"></a>    <span class="k">subroutine </span><span class="n">set_json_core_in_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">core</span><span class="p">)</span>
<a name="ln-530"></a>
<a name="ln-531"></a>    <span class="k">implicit none</span>
<a name="ln-532"></a>
<a name="ln-533"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-534"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">core</span>
<a name="ln-535"></a>
<a name="ln-536"></a>    <span class="n">me</span><span class="p">%</span><span class="n">core</span> <span class="o">=</span> <span class="n">core</span>
<a name="ln-537"></a>
<a name="ln-538"></a>    <span class="k">end subroutine </span><span class="n">set_json_core_in_file</span>
<a name="ln-539"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-540"></a>
<a name="ln-541"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-542"></a><span class="c">!&gt;</span>
<a name="ln-543"></a><span class="c">!  Get a copy of the [[json_core(type)]] in this [[json_file]].</span>
<a name="ln-544"></a>
<a name="ln-545"></a>    <span class="k">subroutine </span><span class="n">get_json_core_in_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">core</span><span class="p">)</span>
<a name="ln-546"></a>
<a name="ln-547"></a>    <span class="k">implicit none</span>
<a name="ln-548"></a>
<a name="ln-549"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-550"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">core</span>
<a name="ln-551"></a>
<a name="ln-552"></a>    <span class="n">core</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span>
<a name="ln-553"></a>
<a name="ln-554"></a>    <span class="k">end subroutine </span><span class="n">get_json_core_in_file</span>
<a name="ln-555"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-556"></a>
<a name="ln-557"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-558"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-559"></a><span class="c">!  date: 07/23/2015</span>
<a name="ln-560"></a><span class="c">!</span>
<a name="ln-561"></a><span class="c">!  Cast a [[json_value]] object as a [[json_file(type)]] object.</span>
<a name="ln-562"></a><span class="c">!  It also calls the `initialize()` method.</span>
<a name="ln-563"></a><span class="c">!</span>
<a name="ln-564"></a><span class="c">!@note [[initialize_json_core]], [[json_initialize]],</span>
<a name="ln-565"></a><span class="c">!      [[initialize_json_core_in_file]], [[initialize_json_file]],</span>
<a name="ln-566"></a><span class="c">!      [[initialize_json_file_v2]], [[initialize_json_file_from_string]],</span>
<a name="ln-567"></a><span class="c">!      and [[initialize_json_file_from_string_v2]]</span>
<a name="ln-568"></a><span class="c">!      all have a similar interface.</span>
<a name="ln-569"></a>
<a name="ln-570"></a>    <span class="k">function </span><span class="n">initialize_json_file</span><span class="p">(</span><span class="n">p</span><span class="p">,&amp;</span>
<a name="ln-571"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-572"></a>                                 <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-573"></a>
<a name="ln-574"></a>    <span class="k">implicit none</span>
<a name="ln-575"></a>
<a name="ln-576"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-577"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">p</span>  <span class="c">!! `json_value` object to cast</span>
<a name="ln-578"></a>                                            <span class="c">!! as a `json_file` object. This</span>
<a name="ln-579"></a>                                            <span class="c">!! will be nullified.</span>
<a name="ln-580"></a><span class="cp">#include &quot;json_initialize_arguments.inc&quot;</span>
<a name="ln-581"></a>
<a name="ln-582"></a>    <span class="k">call </span><span class="n">file_object</span><span class="p">%</span><span class="n">initialize</span><span class="p">(&amp;</span>
<a name="ln-583"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-584"></a>                               <span class="p">)</span>
<a name="ln-585"></a>
<a name="ln-586"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-587"></a><span class="k">        </span><span class="n">file_object</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">p</span>
<a name="ln-588"></a>        <span class="c">! we have to nullify it to avoid</span>
<a name="ln-589"></a>        <span class="c">! a dangling pointer when the file</span>
<a name="ln-590"></a>        <span class="c">! goes out of scope</span>
<a name="ln-591"></a>        <span class="k">nullify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<a name="ln-592"></a>    <span class="k">end if</span>
<a name="ln-593"></a>
<a name="ln-594"></a><span class="k">    end function </span><span class="n">initialize_json_file</span>
<a name="ln-595"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-596"></a>
<a name="ln-597"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-598"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-599"></a><span class="c">!  date: 4/26/2016</span>
<a name="ln-600"></a><span class="c">!</span>
<a name="ln-601"></a><span class="c">!  Cast a [[json_value]] pointer and a [[json_core(type)]] object</span>
<a name="ln-602"></a><span class="c">!  as a [[json_file(type)]] object.</span>
<a name="ln-603"></a>
<a name="ln-604"></a>    <span class="k">function </span><span class="n">initialize_json_file_v2</span><span class="p">(</span><span class="n">json_value_object</span><span class="p">,</span><span class="n">json_core_object</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-605"></a>                                        <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-606"></a>
<a name="ln-607"></a>    <span class="k">implicit none</span>
<a name="ln-608"></a>
<a name="ln-609"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-610"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">json_value_object</span>
<a name="ln-611"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">json_core_object</span>
<a name="ln-612"></a>
<a name="ln-613"></a>    <span class="n">file_object</span><span class="p">%</span><span class="n">p</span>    <span class="o">=&gt;</span> <span class="n">json_value_object</span>
<a name="ln-614"></a>    <span class="n">file_object</span><span class="p">%</span><span class="n">core</span> <span class="o">=</span> <span class="n">json_core_object</span>
<a name="ln-615"></a>
<a name="ln-616"></a>    <span class="k">end function </span><span class="n">initialize_json_file_v2</span>
<a name="ln-617"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-618"></a>
<a name="ln-619"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-620"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-621"></a><span class="c">!  date: 01/19/2019</span>
<a name="ln-622"></a><span class="c">!</span>
<a name="ln-623"></a><span class="c">!  Cast a JSON string as a [[json_file(type)]] object.</span>
<a name="ln-624"></a><span class="c">!  It also calls the `initialize()` method.</span>
<a name="ln-625"></a><span class="c">!</span>
<a name="ln-626"></a><span class="c">!### Example</span>
<a name="ln-627"></a><span class="c">!</span>
<a name="ln-628"></a><span class="c">!```fortran</span>
<a name="ln-629"></a><span class="c">!  type(json_file) :: f</span>
<a name="ln-630"></a><span class="c">!  f = json_file(&#39;{&quot;key &quot;: 1}&#39;, trailing_spaces_significant=.true.)</span>
<a name="ln-631"></a><span class="c">!```</span>
<a name="ln-632"></a><span class="c">!</span>
<a name="ln-633"></a><span class="c">!@note [[initialize_json_core]], [[json_initialize]],</span>
<a name="ln-634"></a><span class="c">!      [[initialize_json_core_in_file]], [[initialize_json_file]],</span>
<a name="ln-635"></a><span class="c">!      [[initialize_json_file_v2]], [[initialize_json_file_from_string]],</span>
<a name="ln-636"></a><span class="c">!      and [[initialize_json_file_from_string_v2]]</span>
<a name="ln-637"></a><span class="c">!      all have a similar interface.</span>
<a name="ln-638"></a>
<a name="ln-639"></a>    <span class="k">function </span><span class="n">initialize_json_file_from_string</span><span class="p">(</span><span class="n">str</span><span class="p">,&amp;</span>
<a name="ln-640"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-641"></a>                                             <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-642"></a>
<a name="ln-643"></a>    <span class="k">implicit none</span>
<a name="ln-644"></a>
<a name="ln-645"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-646"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to load JSON data from</span>
<a name="ln-647"></a><span class="cp">#include &quot;json_initialize_arguments.inc&quot;</span>
<a name="ln-648"></a>
<a name="ln-649"></a>    <span class="k">call </span><span class="n">file_object</span><span class="p">%</span><span class="n">initialize</span><span class="p">(&amp;</span>
<a name="ln-650"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-651"></a>                               <span class="p">)</span>
<a name="ln-652"></a>    <span class="k">call </span><span class="n">file_object</span><span class="p">%</span><span class="n">deserialize</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-653"></a>
<a name="ln-654"></a>    <span class="k">end function </span><span class="n">initialize_json_file_from_string</span>
<a name="ln-655"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-656"></a>
<a name="ln-657"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-658"></a><span class="c">!&gt;</span>
<a name="ln-659"></a><span class="c">!  Alternate version of [[initialize_json_file_from_string]], where &quot;str&quot; is kind=CDK.</span>
<a name="ln-660"></a>
<a name="ln-661"></a>    <span class="k">function </span><span class="n">wrap_initialize_json_file_from_string</span><span class="p">(</span><span class="n">str</span><span class="p">,&amp;</span>
<a name="ln-662"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-663"></a>                                                  <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-664"></a>
<a name="ln-665"></a>    <span class="k">implicit none</span>
<a name="ln-666"></a>
<a name="ln-667"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-668"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to load JSON data from</span>
<a name="ln-669"></a><span class="cp">#include &quot;json_initialize_arguments.inc&quot;</span>
<a name="ln-670"></a>
<a name="ln-671"></a>    <span class="n">file_object</span> <span class="o">=</span> <span class="n">initialize_json_file_from_string</span><span class="p">(&amp;</span>
<a name="ln-672"></a>                                  <span class="n">to_unicode</span><span class="p">(</span><span class="n">str</span><span class="p">),&amp;</span>
<a name="ln-673"></a><span class="cp">#include &quot;json_initialize_dummy_arguments.inc&quot;</span>
<a name="ln-674"></a>                                                <span class="p">)</span>
<a name="ln-675"></a>
<a name="ln-676"></a>    <span class="k">end function </span><span class="n">wrap_initialize_json_file_from_string</span>
<a name="ln-677"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-678"></a>
<a name="ln-679"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-680"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-681"></a><span class="c">!  date: 1/19/2019</span>
<a name="ln-682"></a><span class="c">!</span>
<a name="ln-683"></a><span class="c">!  Cast a JSON string and a [[json_core(type)]] object</span>
<a name="ln-684"></a><span class="c">!  as a [[json_file(type)]] object.</span>
<a name="ln-685"></a>
<a name="ln-686"></a>    <span class="k">function </span><span class="n">initialize_json_file_from_string_v2</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">json_core_object</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-687"></a>                                        <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-688"></a>
<a name="ln-689"></a>    <span class="k">implicit none</span>
<a name="ln-690"></a>
<a name="ln-691"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-692"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to load JSON data from</span>
<a name="ln-693"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">json_core_object</span>
<a name="ln-694"></a>
<a name="ln-695"></a>    <span class="n">file_object</span><span class="p">%</span><span class="n">core</span> <span class="o">=</span> <span class="n">json_core_object</span>
<a name="ln-696"></a>    <span class="k">call </span><span class="n">file_object</span><span class="p">%</span><span class="n">deserialize</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-697"></a>
<a name="ln-698"></a>    <span class="k">end function </span><span class="n">initialize_json_file_from_string_v2</span>
<a name="ln-699"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-700"></a>
<a name="ln-701"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-702"></a><span class="c">!&gt;</span>
<a name="ln-703"></a><span class="c">!  Alternate version of [[initialize_json_file_from_string_v2]], where &quot;str&quot; is kind=CDK.</span>
<a name="ln-704"></a>
<a name="ln-705"></a>    <span class="k">function </span><span class="n">wrap_initialize_json_file_from_string_v2</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">json_core_object</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-706"></a>                                        <span class="k">result</span><span class="p">(</span><span class="n">file_object</span><span class="p">)</span>
<a name="ln-707"></a>
<a name="ln-708"></a>    <span class="k">implicit none</span>
<a name="ln-709"></a>
<a name="ln-710"></a><span class="k">    type</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">file_object</span>
<a name="ln-711"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to load JSON data from</span>
<a name="ln-712"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">json_core_object</span>
<a name="ln-713"></a>
<a name="ln-714"></a>    <span class="n">file_object</span> <span class="o">=</span> <span class="n">initialize_json_file_from_string_v2</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">str</span><span class="p">),</span><span class="n">json_core_object</span><span class="p">)</span>
<a name="ln-715"></a>
<a name="ln-716"></a>    <span class="k">end function </span><span class="n">wrap_initialize_json_file_from_string_v2</span>
<a name="ln-717"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-718"></a>
<a name="ln-719"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-720"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-721"></a><span class="c">!</span>
<a name="ln-722"></a><span class="c">!  Nullify the [[json_value]] pointer in a [[json_file(type)]],</span>
<a name="ln-723"></a><span class="c">!  but do not destroy it.</span>
<a name="ln-724"></a><span class="c">!</span>
<a name="ln-725"></a><span class="c">!  This should normally only be done if the pointer is the target of</span>
<a name="ln-726"></a><span class="c">!  another pointer outside the class that is still intended to be in</span>
<a name="ln-727"></a><span class="c">!  scope after the [[json_file(type)]] has gone out of scope.</span>
<a name="ln-728"></a><span class="c">!  Otherwise, this would result in a memory leak.</span>
<a name="ln-729"></a><span class="c">!</span>
<a name="ln-730"></a><span class="c">!### See also</span>
<a name="ln-731"></a><span class="c">!  * [[json_file_destroy]]</span>
<a name="ln-732"></a><span class="c">!</span>
<a name="ln-733"></a><span class="c">!### History</span>
<a name="ln-734"></a><span class="c">!  * 6/30/2019 : Created</span>
<a name="ln-735"></a>
<a name="ln-736"></a>    <span class="k">subroutine </span><span class="n">json_file_nullify</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
<a name="ln-737"></a>
<a name="ln-738"></a>    <span class="k">implicit none</span>
<a name="ln-739"></a>
<a name="ln-740"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-741"></a>
<a name="ln-742"></a>    <span class="k">nullify</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-743"></a>
<a name="ln-744"></a>    <span class="k">end subroutine </span><span class="n">json_file_nullify</span>
<a name="ln-745"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-746"></a>
<a name="ln-747"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-748"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-749"></a><span class="c">!</span>
<a name="ln-750"></a><span class="c">!  Destroy the [[json_value]] data in a [[json_file(type)]].</span>
<a name="ln-751"></a><span class="c">!  This may be done when the variable is no longer needed,</span>
<a name="ln-752"></a><span class="c">!  or will be reused to open a different file.</span>
<a name="ln-753"></a><span class="c">!  Otherwise a memory leak will occur.</span>
<a name="ln-754"></a><span class="c">!</span>
<a name="ln-755"></a><span class="c">!  Optionally, also destroy the [[json_core(type)]] instance (this</span>
<a name="ln-756"></a><span class="c">!  is not necessary to prevent memory leaks, since a [[json_core(type)]]</span>
<a name="ln-757"></a><span class="c">!  does not use pointers).</span>
<a name="ln-758"></a><span class="c">!</span>
<a name="ln-759"></a><span class="c">!### See also</span>
<a name="ln-760"></a><span class="c">!  * [[json_file_nullify]]</span>
<a name="ln-761"></a><span class="c">!</span>
<a name="ln-762"></a><span class="c">!### History</span>
<a name="ln-763"></a><span class="c">!  * 12/9/2013 : Created</span>
<a name="ln-764"></a><span class="c">!  * 4/26/2016 : Added optional `destroy_core` argument</span>
<a name="ln-765"></a><span class="c">!</span>
<a name="ln-766"></a><span class="c">!@note This routine will be called automatically when the variable</span>
<a name="ln-767"></a><span class="c">!      goes out of scope.</span>
<a name="ln-768"></a>
<a name="ln-769"></a>    <span class="k">subroutine </span><span class="n">json_file_destroy</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">destroy_core</span><span class="p">)</span>
<a name="ln-770"></a>
<a name="ln-771"></a>    <span class="k">implicit none</span>
<a name="ln-772"></a>
<a name="ln-773"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-774"></a>    <span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">destroy_core</span>  <span class="c">!! to also destroy the [[json_core(type)]].</span>
<a name="ln-775"></a>                                                 <span class="c">!! default is to leave it as is.</span>
<a name="ln-776"></a>
<a name="ln-777"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">destroy</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-778"></a>
<a name="ln-779"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">destroy_core</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-780"></a><span class="k">        if</span> <span class="p">(</span><span class="n">destroy_core</span><span class="p">)</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>
<a name="ln-781"></a>    <span class="k">end if</span>
<a name="ln-782"></a>
<a name="ln-783"></a><span class="k">    end subroutine </span><span class="n">json_file_destroy</span>
<a name="ln-784"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-785"></a>
<a name="ln-786"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-787"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-788"></a><span class="c">!  date: 12/5/2014</span>
<a name="ln-789"></a><span class="c">!</span>
<a name="ln-790"></a><span class="c">!  Move the [[json_value]] pointer from one [[json_file(type)]] to another.</span>
<a name="ln-791"></a><span class="c">!  The &quot;from&quot; pointer is then nullified, but not destroyed.</span>
<a name="ln-792"></a><span class="c">!</span>
<a name="ln-793"></a><span class="c">!@note If &quot;from%p&quot; is not associated, then an error is thrown.</span>
<a name="ln-794"></a>
<a name="ln-795"></a>    <span class="k">subroutine </span><span class="n">json_file_move_pointer</span><span class="p">(</span><span class="n">to</span><span class="p">,</span><span class="n">from</span><span class="p">)</span>
<a name="ln-796"></a>
<a name="ln-797"></a>    <span class="k">implicit none</span>
<a name="ln-798"></a>
<a name="ln-799"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">to</span>
<a name="ln-800"></a>    <span class="k">class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">from</span>
<a name="ln-801"></a>
<a name="ln-802"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">from</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-803"></a>
<a name="ln-804"></a><span class="k">        if</span> <span class="p">(</span><span class="n">from</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">then</span>
<a name="ln-805"></a>            <span class="c">!Don&#39;t get the data if the FROM file has an</span>
<a name="ln-806"></a>            <span class="c">!active exception, since it may not be valid.</span>
<a name="ln-807"></a>            <span class="k">call </span><span class="n">to</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="s1">&#39;Error in json_file_move_pointer: &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-808"></a>                                         <span class="s1">&#39;error exception in FROM file.&#39;</span><span class="p">)</span>
<a name="ln-809"></a>        <span class="k">else</span>
<a name="ln-810"></a><span class="k">            call </span><span class="n">to</span><span class="p">%</span><span class="n">initialize</span><span class="p">()</span>  <span class="c">!initialize and clear any exceptions that may be present</span>
<a name="ln-811"></a>            <span class="n">to</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">from</span><span class="p">%</span><span class="n">p</span>
<a name="ln-812"></a>            <span class="k">nullify</span><span class="p">(</span><span class="n">from</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-813"></a>        <span class="k">end if</span>
<a name="ln-814"></a>
<a name="ln-815"></a><span class="k">    else</span>
<a name="ln-816"></a><span class="k">        call </span><span class="n">to</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="s1">&#39;Error in json_file_move_pointer: &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-817"></a>                                     <span class="s1">&#39;pointer is not associated.&#39;</span><span class="p">)</span>
<a name="ln-818"></a>    <span class="k">end if</span>
<a name="ln-819"></a>
<a name="ln-820"></a><span class="k">    end subroutine </span><span class="n">json_file_move_pointer</span>
<a name="ln-821"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-822"></a>
<a name="ln-823"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-824"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-825"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-826"></a><span class="c">!</span>
<a name="ln-827"></a><span class="c">!  Load the JSON data from a file.</span>
<a name="ln-828"></a><span class="c">!</span>
<a name="ln-829"></a><span class="c">!### Example</span>
<a name="ln-830"></a><span class="c">!</span>
<a name="ln-831"></a><span class="c">!```fortran</span>
<a name="ln-832"></a><span class="c">!     program main</span>
<a name="ln-833"></a><span class="c">!      use json_module</span>
<a name="ln-834"></a><span class="c">!      implicit none</span>
<a name="ln-835"></a><span class="c">!      type(json_file) :: f</span>
<a name="ln-836"></a><span class="c">!      call f%load(&#39;my_file.json&#39;)</span>
<a name="ln-837"></a><span class="c">!      !...</span>
<a name="ln-838"></a><span class="c">!      call f%destroy()</span>
<a name="ln-839"></a><span class="c">!     end program main</span>
<a name="ln-840"></a><span class="c">!```</span>
<a name="ln-841"></a>
<a name="ln-842"></a>    <span class="k">subroutine </span><span class="n">json_file_load</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
<a name="ln-843"></a>
<a name="ln-844"></a>    <span class="k">implicit none</span>
<a name="ln-845"></a>
<a name="ln-846"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-847"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>  <span class="c">!! the filename to open</span>
<a name="ln-848"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">unit</span>      <span class="c">!! the unit number to use</span>
<a name="ln-849"></a>                                                      <span class="c">!! (if not present, a newunit</span>
<a name="ln-850"></a>                                                      <span class="c">!! is used)</span>
<a name="ln-851"></a>
<a name="ln-852"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">load</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-853"></a>
<a name="ln-854"></a>    <span class="k">end subroutine </span><span class="n">json_file_load</span>
<a name="ln-855"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-856"></a>
<a name="ln-857"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-858"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-859"></a><span class="c">!  date: 1/13/2015</span>
<a name="ln-860"></a><span class="c">!</span>
<a name="ln-861"></a><span class="c">!  Load the JSON data from a string.</span>
<a name="ln-862"></a><span class="c">!</span>
<a name="ln-863"></a><span class="c">!### Example</span>
<a name="ln-864"></a><span class="c">!</span>
<a name="ln-865"></a><span class="c">!  Load JSON from a string:</span>
<a name="ln-866"></a><span class="c">!```fortran</span>
<a name="ln-867"></a><span class="c">!     type(json_file) :: f</span>
<a name="ln-868"></a><span class="c">!     call f%deserialize(&#39;{ &quot;name&quot;: &quot;Leonidas&quot; }&#39;)</span>
<a name="ln-869"></a><span class="c">!```</span>
<a name="ln-870"></a>
<a name="ln-871"></a>    <span class="k">subroutine </span><span class="n">json_file_load_from_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
<a name="ln-872"></a>
<a name="ln-873"></a>    <span class="k">implicit none</span>
<a name="ln-874"></a>
<a name="ln-875"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-876"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to load JSON data from</span>
<a name="ln-877"></a>
<a name="ln-878"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">deserialize</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
<a name="ln-879"></a>
<a name="ln-880"></a>    <span class="k">end subroutine </span><span class="n">json_file_load_from_string</span>
<a name="ln-881"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-882"></a>
<a name="ln-883"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-884"></a><span class="c">!&gt;</span>
<a name="ln-885"></a><span class="c">!  Alternate version of [[json_file_load_from_string]], where &quot;str&quot; is kind=CDK.</span>
<a name="ln-886"></a>
<a name="ln-887"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_load_from_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
<a name="ln-888"></a>
<a name="ln-889"></a>    <span class="k">implicit none</span>
<a name="ln-890"></a>
<a name="ln-891"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-892"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-893"></a>
<a name="ln-894"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">deserialize</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>
<a name="ln-895"></a>
<a name="ln-896"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_load_from_string</span>
<a name="ln-897"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-898"></a>
<a name="ln-899"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-900"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-901"></a><span class="c">!  date: 1/11/2015</span>
<a name="ln-902"></a><span class="c">!</span>
<a name="ln-903"></a><span class="c">!  Print the JSON file to the console.</span>
<a name="ln-904"></a>
<a name="ln-905"></a>    <span class="k">subroutine </span><span class="n">json_file_print_to_console</span><span class="p">(</span><span class="n">me</span><span class="p">)</span>
<a name="ln-906"></a>
<a name="ln-907"></a>    <span class="k">implicit none</span>
<a name="ln-908"></a>
<a name="ln-909"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">me</span>
<a name="ln-910"></a>
<a name="ln-911"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="k">print</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">iunit</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">output_unit</span><span class="p">,</span><span class="n">IK</span><span class="p">))</span>
<a name="ln-912"></a>
<a name="ln-913"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_to_console</span>
<a name="ln-914"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-915"></a>
<a name="ln-916"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-917"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-918"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-919"></a><span class="c">!</span>
<a name="ln-920"></a><span class="c">!  Prints the JSON file to the specified file unit number.</span>
<a name="ln-921"></a>
<a name="ln-922"></a>    <span class="k">subroutine </span><span class="n">json_file_print_to_unit</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">iunit</span><span class="p">)</span>
<a name="ln-923"></a>
<a name="ln-924"></a>    <span class="k">implicit none</span>
<a name="ln-925"></a>
<a name="ln-926"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">me</span>
<a name="ln-927"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">iunit</span>  <span class="c">!! file unit number (must not be -1)</span>
<a name="ln-928"></a>
<a name="ln-929"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">iunit</span><span class="o">/=</span><span class="n">unit2str</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-930"></a><span class="k">        call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="k">print</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">iunit</span><span class="o">=</span><span class="n">iunit</span><span class="p">)</span>
<a name="ln-931"></a>    <span class="k">else</span>
<a name="ln-932"></a><span class="k">        call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="s1">&#39;Error in json_file_print_to_unit: iunit must not be -1.&#39;</span><span class="p">)</span>
<a name="ln-933"></a>    <span class="k">end if</span>
<a name="ln-934"></a>
<a name="ln-935"></a><span class="k">    end subroutine </span><span class="n">json_file_print_to_unit</span>
<a name="ln-936"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-937"></a>
<a name="ln-938"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-939"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-940"></a><span class="c">!  date: 1/11/2015</span>
<a name="ln-941"></a><span class="c">!</span>
<a name="ln-942"></a><span class="c">!  Print the JSON structure to the specified filename.</span>
<a name="ln-943"></a><span class="c">!  The file is opened, printed, and then closed.</span>
<a name="ln-944"></a><span class="c">!</span>
<a name="ln-945"></a><span class="c">!### Example</span>
<a name="ln-946"></a><span class="c">!  Example loading a JSON file, changing a value, and then printing</span>
<a name="ln-947"></a><span class="c">!  result to a new file:</span>
<a name="ln-948"></a><span class="c">!```fortran</span>
<a name="ln-949"></a><span class="c">!     type(json_file) :: f</span>
<a name="ln-950"></a><span class="c">!     logical :: found</span>
<a name="ln-951"></a><span class="c">!     call f%load(&#39;my_file.json&#39;)       !open the original file</span>
<a name="ln-952"></a><span class="c">!     call f%update(&#39;version&#39;,4,found)  !change the value of a variable</span>
<a name="ln-953"></a><span class="c">!     call f%print(&#39;my_file_2.json&#39;)    !save file as new name</span>
<a name="ln-954"></a><span class="c">!```</span>
<a name="ln-955"></a>
<a name="ln-956"></a>    <span class="k">subroutine </span><span class="n">json_file_print_to_filename</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
<a name="ln-957"></a>
<a name="ln-958"></a>    <span class="k">implicit none</span>
<a name="ln-959"></a>
<a name="ln-960"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-961"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">filename</span>  <span class="c">!! filename to print to</span>
<a name="ln-962"></a>
<a name="ln-963"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="k">print</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
<a name="ln-964"></a>
<a name="ln-965"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_to_filename</span>
<a name="ln-966"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-967"></a>
<a name="ln-968"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-969"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-970"></a><span class="c">!  date: 1/11/2015</span>
<a name="ln-971"></a><span class="c">!</span>
<a name="ln-972"></a><span class="c">!  Print the JSON file to a string.</span>
<a name="ln-973"></a><span class="c">!</span>
<a name="ln-974"></a><span class="c">!### Example</span>
<a name="ln-975"></a><span class="c">!</span>
<a name="ln-976"></a><span class="c">!  Open a JSON file, and then print the contents to a string:</span>
<a name="ln-977"></a><span class="c">!```fortran</span>
<a name="ln-978"></a><span class="c">!     type(json_file) :: f</span>
<a name="ln-979"></a><span class="c">!     character(kind=CK,len=:),allocatable :: str</span>
<a name="ln-980"></a><span class="c">!     call f%load(&#39;my_file.json&#39;)</span>
<a name="ln-981"></a><span class="c">!     call f%serialize(str)</span>
<a name="ln-982"></a><span class="c">!```</span>
<a name="ln-983"></a>
<a name="ln-984"></a>    <span class="k">subroutine </span><span class="n">json_file_print_to_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-985"></a>
<a name="ln-986"></a>    <span class="k">implicit none</span>
<a name="ln-987"></a>
<a name="ln-988"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-989"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>  <span class="c">!! string to print JSON data to</span>
<a name="ln-990"></a>
<a name="ln-991"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">serialize</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-992"></a>
<a name="ln-993"></a>    <span class="k">end subroutine </span><span class="n">json_file_print_to_string</span>
<a name="ln-994"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-995"></a>
<a name="ln-996"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-997"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-998"></a><span class="c">!  date: 2/3/2014</span>
<a name="ln-999"></a><span class="c">!</span>
<a name="ln-1000"></a><span class="c">!  Returns information about a variable in a [[json_file(type)]].</span>
<a name="ln-1001"></a><span class="c">!</span>
<a name="ln-1002"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-1003"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-1004"></a><span class="c">!      variable is not found.</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>    <span class="k">subroutine </span><span class="n">json_file_variable_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1007"></a>
<a name="ln-1008"></a>    <span class="k">implicit none</span>
<a name="ln-1009"></a>
<a name="ln-1010"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1011"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>       <span class="c">!! path to the variable</span>
<a name="ln-1012"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>      <span class="c">!! the variable exists in the structure</span>
<a name="ln-1013"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">var_type</span>   <span class="c">!! variable type</span>
<a name="ln-1014"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">n_children</span> <span class="c">!! number of children</span>
<a name="ln-1015"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-1016"></a>
<a name="ln-1017"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1018"></a>
<a name="ln-1019"></a>    <span class="k">end subroutine </span><span class="n">json_file_variable_info</span>
<a name="ln-1020"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1021"></a>
<a name="ln-1022"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1023"></a><span class="c">!&gt;</span>
<a name="ln-1024"></a><span class="c">!  Alternate version of [[json_file_variable_info]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1025"></a><span class="c">!</span>
<a name="ln-1026"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-1027"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-1028"></a><span class="c">!      variable is not found.</span>
<a name="ln-1029"></a>
<a name="ln-1030"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_variable_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1031"></a>
<a name="ln-1032"></a>    <span class="k">implicit none</span>
<a name="ln-1033"></a>
<a name="ln-1034"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1035"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-1036"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1037"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">var_type</span>
<a name="ln-1038"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">n_children</span>
<a name="ln-1039"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">info</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_children</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1042"></a>
<a name="ln-1043"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_variable_info</span>
<a name="ln-1044"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1045"></a>
<a name="ln-1046"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1047"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1048"></a><span class="c">!  date: 6/26/2016</span>
<a name="ln-1049"></a><span class="c">!</span>
<a name="ln-1050"></a><span class="c">!  Returns matrix information about a variable in a [[json_file(type)]].</span>
<a name="ln-1051"></a><span class="c">!</span>
<a name="ln-1052"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-1053"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-1054"></a><span class="c">!      variable is not found.</span>
<a name="ln-1055"></a>
<a name="ln-1056"></a>    <span class="k">subroutine </span><span class="n">json_file_variable_matrix_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-1057"></a>                                        <span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1058"></a>
<a name="ln-1059"></a>    <span class="k">implicit none</span>
<a name="ln-1060"></a>
<a name="ln-1061"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1062"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>      <span class="c">!! path to the variable</span>
<a name="ln-1063"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">is_matrix</span> <span class="c">!! true if it is a valid matrix</span>
<a name="ln-1064"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>     <span class="c">!! true if it was found</span>
<a name="ln-1065"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">var_type</span>  <span class="c">!! variable type of data in</span>
<a name="ln-1066"></a>                                                     <span class="c">!! the matrix (if all elements have</span>
<a name="ln-1067"></a>                                                     <span class="c">!! the same type)</span>
<a name="ln-1068"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">n_sets</span>    <span class="c">!! number of data sets (i.e., matrix</span>
<a name="ln-1069"></a>                                                     <span class="c">!! rows if using row-major order)</span>
<a name="ln-1070"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">set_size</span>  <span class="c">!! size of each data set (i.e., matrix</span>
<a name="ln-1071"></a>                                                     <span class="c">!! cols if using row-major order)</span>
<a name="ln-1072"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-1073"></a>
<a name="ln-1074"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">matrix_info</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1075"></a>
<a name="ln-1076"></a>    <span class="k">end subroutine </span><span class="n">json_file_variable_matrix_info</span>
<a name="ln-1077"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1078"></a>
<a name="ln-1079"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1080"></a><span class="c">!&gt;</span>
<a name="ln-1081"></a><span class="c">!  Alternate version of [[json_file_variable_matrix_info]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1082"></a><span class="c">!</span>
<a name="ln-1083"></a><span class="c">!@note If `found` is present, no exceptions will be thrown if an</span>
<a name="ln-1084"></a><span class="c">!      error occurs. Otherwise, an exception will be thrown if the</span>
<a name="ln-1085"></a><span class="c">!      variable is not found.</span>
<a name="ln-1086"></a>
<a name="ln-1087"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_variable_matrix_info</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-1088"></a>                                                   <span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1089"></a>
<a name="ln-1090"></a>    <span class="k">implicit none</span>
<a name="ln-1091"></a>
<a name="ln-1092"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1093"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>      <span class="c">!! path to the variable</span>
<a name="ln-1094"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">is_matrix</span> <span class="c">!! true if it is a valid matrix</span>
<a name="ln-1095"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>     <span class="c">!! true if it was found</span>
<a name="ln-1096"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">var_type</span>  <span class="c">!! variable type of data in</span>
<a name="ln-1097"></a>                                                      <span class="c">!! the matrix (if all elements have</span>
<a name="ln-1098"></a>                                                      <span class="c">!! the same type)</span>
<a name="ln-1099"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">n_sets</span>    <span class="c">!! number of data sets (i.e., matrix</span>
<a name="ln-1100"></a>                                                      <span class="c">!! rows if using row-major order)</span>
<a name="ln-1101"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">set_size</span>  <span class="c">!! size of each data set (i.e., matrix</span>
<a name="ln-1102"></a>                                                      <span class="c">!! cols if using row-major order)</span>
<a name="ln-1103"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">name</span> <span class="c">!! variable name</span>
<a name="ln-1104"></a>
<a name="ln-1105"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">matrix_info</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">is_matrix</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">var_type</span><span class="p">,</span><span class="n">n_sets</span><span class="p">,</span><span class="n">set_size</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
<a name="ln-1106"></a>
<a name="ln-1107"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_variable_matrix_info</span>
<a name="ln-1108"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1109"></a>
<a name="ln-1110"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1111"></a><span class="c">!&gt; author: Izaak Beekman</span>
<a name="ln-1112"></a><span class="c">!  date: 7/23/2015</span>
<a name="ln-1113"></a><span class="c">!</span>
<a name="ln-1114"></a><span class="c">!  Get a [[json_value]] pointer to the JSON file root.</span>
<a name="ln-1115"></a><span class="c">!</span>
<a name="ln-1116"></a><span class="c">!@note This is equivalent to calling ```[[json_file]]%get(&#39;$&#39;,p)```</span>
<a name="ln-1117"></a>
<a name="ln-1118"></a>    <span class="k">subroutine </span><span class="n">json_file_get_root</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1119"></a>
<a name="ln-1120"></a>    <span class="k">implicit none</span>
<a name="ln-1121"></a>
<a name="ln-1122"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1123"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>      <span class="c">!! pointer to the variable</span>
<a name="ln-1124"></a>
<a name="ln-1125"></a>    <span class="n">p</span> <span class="o">=&gt;</span> <span class="n">me</span><span class="p">%</span><span class="n">p</span>
<a name="ln-1126"></a>
<a name="ln-1127"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_root</span>
<a name="ln-1128"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1129"></a>
<a name="ln-1130"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1131"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1132"></a><span class="c">!</span>
<a name="ln-1133"></a><span class="c">!  Assignment operator for [[json_core(type)]] = [[json_core(type)]].</span>
<a name="ln-1134"></a><span class="c">!  This will duplicate the [[json_core(type)]] and also</span>
<a name="ln-1135"></a><span class="c">!  perform a deep copy of the [[json_value(type)]] data structure.</span>
<a name="ln-1136"></a>
<a name="ln-1137"></a>    <span class="k">subroutine </span><span class="n">assign_json_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<a name="ln-1138"></a>
<a name="ln-1139"></a>    <span class="k">implicit none</span>
<a name="ln-1140"></a>
<a name="ln-1141"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1142"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">f</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a>    <span class="n">me</span><span class="p">%</span><span class="n">core</span> <span class="o">=</span> <span class="n">f</span><span class="p">%</span><span class="n">core</span> <span class="c">! no pointers here so OK to copy</span>
<a name="ln-1145"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">clone</span><span class="p">(</span><span class="n">f</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-1146"></a>
<a name="ln-1147"></a>    <span class="k">end subroutine </span><span class="n">assign_json_file</span>
<a name="ln-1148"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1149"></a>
<a name="ln-1150"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1151"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1152"></a><span class="c">!</span>
<a name="ln-1153"></a><span class="c">!  Assignment operator for character = [[json_core(type)]].</span>
<a name="ln-1154"></a><span class="c">!  This is just a wrapper for the [[json_value_to_string]] routine.</span>
<a name="ln-1155"></a><span class="c">!</span>
<a name="ln-1156"></a><span class="c">!### Note</span>
<a name="ln-1157"></a><span class="c">!  * If an exception is raised or the file contains no data,</span>
<a name="ln-1158"></a><span class="c">!    this will return an empty string.</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a>    <span class="k">subroutine </span><span class="n">assign_json_file_to_string</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">me</span><span class="p">)</span>
<a name="ln-1161"></a>
<a name="ln-1162"></a>    <span class="k">implicit none</span>
<a name="ln-1163"></a>
<a name="ln-1164"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-1165"></a>    <span class="k">class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1166"></a>
<a name="ln-1167"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">)</span> <span class="kd">::</span> <span class="n">core_copy</span> <span class="c">!! a copy of `core` from `me`</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">()</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1170"></a><span class="k">        </span><span class="n">str</span> <span class="o">=</span> <span class="n">CK_</span><span class="s1">&#39;&#39;</span>
<a name="ln-1171"></a>    <span class="k">else</span>
<a name="ln-1172"></a>
<a name="ln-1173"></a>        <span class="c">! This is sort of a hack. Since `me` has to have `intent(in)`</span>
<a name="ln-1174"></a>        <span class="c">! for the assignment to work, we need to make a copy of `me%core`</span>
<a name="ln-1175"></a>        <span class="c">! so we can call the low level routine (since it needs it to</span>
<a name="ln-1176"></a>        <span class="c">! be `intent(inout)`) because it&#39;s possible for this</span>
<a name="ln-1177"></a>        <span class="c">! function to raise an exception.</span>
<a name="ln-1178"></a>
<a name="ln-1179"></a>        <span class="n">core_copy</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span> <span class="c">! copy the parser settings</span>
<a name="ln-1180"></a>
<a name="ln-1181"></a>        <span class="k">call </span><span class="n">core_copy</span><span class="p">%</span><span class="n">serialize</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-1182"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="n">str</span> <span class="o">=</span> <span class="n">CK_</span><span class="s1">&#39;&#39;</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>    <span class="k">end if</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a><span class="k">    end subroutine </span><span class="n">assign_json_file_to_string</span>
<a name="ln-1187"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1188"></a>
<a name="ln-1189"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1190"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1191"></a><span class="c">!</span>
<a name="ln-1192"></a><span class="c">!  Assignment operator for [[json_core(type)]] = character.</span>
<a name="ln-1193"></a><span class="c">!  This is just a wrapper for the [[json_file_load_from_string]] routine.</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>    <span class="k">subroutine </span><span class="n">assign_string_to_json_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a>    <span class="k">implicit none</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1200"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-1201"></a>
<a name="ln-1202"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span>
<a name="ln-1203"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">clear_exceptions</span><span class="p">()</span>
<a name="ln-1204"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">deserialize</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
<a name="ln-1205"></a>
<a name="ln-1206"></a>    <span class="k">end subroutine </span><span class="n">assign_string_to_json_file</span>
<a name="ln-1207"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1210"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1211"></a><span class="c">!</span>
<a name="ln-1212"></a><span class="c">!  Alternate version of [[assign_string_to_json_file]], where &quot;str&quot; is kind=CDK.</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a>    <span class="k">subroutine </span><span class="n">wrap_assign_string_to_json_file</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">str</span><span class="p">)</span>
<a name="ln-1215"></a>
<a name="ln-1216"></a>    <span class="k">implicit none</span>
<a name="ln-1217"></a>
<a name="ln-1218"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1219"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">str</span>
<a name="ln-1220"></a>
<a name="ln-1221"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">assign_string_to_json_file</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">str</span><span class="p">))</span>
<a name="ln-1222"></a>
<a name="ln-1223"></a>    <span class="k">end subroutine </span><span class="n">wrap_assign_string_to_json_file</span>
<a name="ln-1224"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1225"></a>
<a name="ln-1226"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1227"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1228"></a><span class="c">!</span>
<a name="ln-1229"></a><span class="c">!  A wrapper for [[json_file_valid_path]] for the `.in.` operator</span>
<a name="ln-1230"></a>
<a name="ln-1231"></a>    <span class="k">function </span><span class="n">json_file_valid_path_op</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">me</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a>    <span class="k">implicit none</span>
<a name="ln-1234"></a>
<a name="ln-1235"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1236"></a>    <span class="k">class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">me</span>     <span class="c">!! the JSON file</span>
<a name="ln-1237"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_core</span><span class="p">)</span> <span class="kd">::</span> <span class="n">core_copy</span> <span class="c">!! a copy of `core` from `me`</span>
<a name="ln-1240"></a>
<a name="ln-1241"></a>    <span class="c">! This is sort of a hack. Since `me` has to have `intent(in)`</span>
<a name="ln-1242"></a>    <span class="c">! for the operator to work, we need to make a copy of `me%core`</span>
<a name="ln-1243"></a>    <span class="c">! so we can call the low level routine (since it needs it to</span>
<a name="ln-1244"></a>    <span class="c">! be `intent(inout)`) because it&#39;s technically possible for this</span>
<a name="ln-1245"></a>    <span class="c">! function to raise an exception. This normally should never</span>
<a name="ln-1246"></a>    <span class="c">! happen here unless the JSON structure is malformed.</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a>    <span class="n">core_copy</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span> <span class="c">! copy the settings (need them to know</span>
<a name="ln-1249"></a>                        <span class="c">! how to interpret the path)</span>
<a name="ln-1250"></a>
<a name="ln-1251"></a>    <span class="n">found</span> <span class="o">=</span> <span class="n">core_copy</span><span class="p">%</span><span class="n">valid_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="c">! call the low-level routine</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a>    <span class="k">call </span><span class="n">core_copy</span><span class="p">%</span><span class="n">destroy</span><span class="p">()</span> <span class="c">! just in case (but not really necessary)</span>
<a name="ln-1254"></a>
<a name="ln-1255"></a>    <span class="k">end function </span><span class="n">json_file_valid_path_op</span>
<a name="ln-1256"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1257"></a>
<a name="ln-1258"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1259"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1260"></a><span class="c">!</span>
<a name="ln-1261"></a><span class="c">!  Alternate version of [[json_file_valid_path_op]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1262"></a>
<a name="ln-1263"></a>    <span class="k">function </span><span class="n">wrap_json_file_valid_path_op</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">me</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1264"></a>
<a name="ln-1265"></a>    <span class="k">implicit none</span>
<a name="ln-1266"></a>
<a name="ln-1267"></a><span class="k">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1268"></a>    <span class="k">class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">me</span>     <span class="c">!! the JSON file</span>
<a name="ln-1269"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1270"></a>
<a name="ln-1271"></a>    <span class="n">found</span> <span class="o">=</span> <span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">.</span><span class="n">in</span><span class="p">.</span> <span class="n">me</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>    <span class="k">end function </span><span class="n">wrap_json_file_valid_path_op</span>
<a name="ln-1274"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1275"></a>
<a name="ln-1276"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1277"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1278"></a><span class="c">!</span>
<a name="ln-1279"></a><span class="c">!  Returns true if the `path` is present in the JSON file.</span>
<a name="ln-1280"></a>
<a name="ln-1281"></a>    <span class="k">function </span><span class="n">json_file_valid_path</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1282"></a>
<a name="ln-1283"></a>    <span class="k">implicit none</span>
<a name="ln-1284"></a>
<a name="ln-1285"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1286"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1287"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1288"></a>
<a name="ln-1289"></a>    <span class="n">found</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">valid_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
<a name="ln-1290"></a>
<a name="ln-1291"></a>    <span class="k">end function </span><span class="n">json_file_valid_path</span>
<a name="ln-1292"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1295"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1296"></a><span class="c">!</span>
<a name="ln-1297"></a><span class="c">!  Alternate version of [[json_file_valid_path]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1298"></a>
<a name="ln-1299"></a>    <span class="k">function </span><span class="n">wrap_json_file_valid_path</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1300"></a>
<a name="ln-1301"></a>    <span class="k">implicit none</span>
<a name="ln-1302"></a>
<a name="ln-1303"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1304"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1305"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1306"></a>
<a name="ln-1307"></a>    <span class="n">found</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">valid_path</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<a name="ln-1308"></a>
<a name="ln-1309"></a>    <span class="k">end function </span><span class="n">wrap_json_file_valid_path</span>
<a name="ln-1310"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1313"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1314"></a><span class="c">!</span>
<a name="ln-1315"></a><span class="c">!  Rename a variable in a JSON file.</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a>    <span class="k">subroutine </span><span class="n">json_file_rename</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1318"></a>
<a name="ln-1319"></a>    <span class="k">implicit none</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1322"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1323"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>   <span class="c">!! the new name</span>
<a name="ln-1324"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1325"></a>
<a name="ln-1326"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="nb">rename</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a>    <span class="k">end subroutine </span><span class="n">json_file_rename</span>
<a name="ln-1329"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1330"></a>
<a name="ln-1331"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1332"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1333"></a><span class="c">!</span>
<a name="ln-1334"></a><span class="c">!  Alternate version of [[json_file_rename]], where &quot;path&quot; and &quot;name&quot; are kind=CDK.</span>
<a name="ln-1335"></a>
<a name="ln-1336"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_rename</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1337"></a>
<a name="ln-1338"></a>    <span class="k">implicit none</span>
<a name="ln-1339"></a>
<a name="ln-1340"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1341"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1342"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>   <span class="c">!! the new name</span>
<a name="ln-1343"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1344"></a>
<a name="ln-1345"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_rename</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1346"></a>
<a name="ln-1347"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_rename</span>
<a name="ln-1348"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1349"></a>
<a name="ln-1350"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1351"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1352"></a><span class="c">!</span>
<a name="ln-1353"></a><span class="c">!  Wrapper for [[json_file_rename]] where &quot;path&quot; is kind=CDK).</span>
<a name="ln-1354"></a>
<a name="ln-1355"></a>    <span class="k">subroutine </span><span class="n">json_file_rename_path_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1356"></a>
<a name="ln-1357"></a>    <span class="k">implicit none</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1360"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1361"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">name</span>   <span class="c">!! the new name</span>
<a name="ln-1362"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1363"></a>
<a name="ln-1364"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_rename</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">name</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1365"></a>
<a name="ln-1366"></a>    <span class="k">end subroutine </span><span class="n">json_file_rename_path_ascii</span>
<a name="ln-1367"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1370"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1371"></a><span class="c">!</span>
<a name="ln-1372"></a><span class="c">!  Wrapper for [[json_file_rename]] where &quot;name&quot; is kind=CDK).</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a>    <span class="k">subroutine </span><span class="n">json_file_rename_name_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1375"></a>
<a name="ln-1376"></a>    <span class="k">implicit none</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1379"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1380"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>   <span class="c">!! the new name</span>
<a name="ln-1381"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if the variable was found</span>
<a name="ln-1382"></a>
<a name="ln-1383"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_rename</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="n">found</span><span class="p">)</span>
<a name="ln-1384"></a>
<a name="ln-1385"></a>    <span class="k">end subroutine </span><span class="n">json_file_rename_name_ascii</span>
<a name="ln-1386"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1387"></a>
<a name="ln-1388"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1389"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1390"></a><span class="c">!  date: 2/3/2014</span>
<a name="ln-1391"></a><span class="c">!</span>
<a name="ln-1392"></a><span class="c">!  Get a [[json_value]] pointer to an object from a JSON file.</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a>    <span class="k">subroutine </span><span class="n">json_file_get_object</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1395"></a>
<a name="ln-1396"></a>    <span class="k">implicit none</span>
<a name="ln-1397"></a>
<a name="ln-1398"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1399"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1400"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>      <span class="c">!! pointer to the variable</span>
<a name="ln-1401"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-1402"></a>
<a name="ln-1403"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1404"></a>
<a name="ln-1405"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_object</span>
<a name="ln-1406"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1407"></a>
<a name="ln-1408"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1409"></a><span class="c">!&gt;</span>
<a name="ln-1410"></a><span class="c">!  Alternate version of [[json_file_get_object]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1411"></a>
<a name="ln-1412"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_object</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1413"></a>
<a name="ln-1414"></a>    <span class="k">implicit none</span>
<a name="ln-1415"></a>
<a name="ln-1416"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1417"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>    <span class="c">!! the path to the variable</span>
<a name="ln-1418"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span>       <span class="c">!! pointer to the variable</span>
<a name="ln-1419"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>   <span class="c">!! if it was really found</span>
<a name="ln-1420"></a>
<a name="ln-1421"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">found</span><span class="p">)</span>
<a name="ln-1422"></a>
<a name="ln-1423"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_object</span>
<a name="ln-1424"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1427"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1428"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-1429"></a><span class="c">!</span>
<a name="ln-1430"></a><span class="c">!  Get an integer value from a JSON file.</span>
<a name="ln-1431"></a>
<a name="ln-1432"></a>    <span class="k">subroutine </span><span class="n">json_file_get_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1433"></a>
<a name="ln-1434"></a>    <span class="k">implicit none</span>
<a name="ln-1435"></a>
<a name="ln-1436"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1437"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>    <span class="c">!! the path to the variable</span>
<a name="ln-1438"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>     <span class="c">!! value</span>
<a name="ln-1439"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>   <span class="c">!! if it was really found</span>
<a name="ln-1440"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1441"></a>
<a name="ln-1442"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1443"></a>
<a name="ln-1444"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_integer</span>
<a name="ln-1445"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1446"></a>
<a name="ln-1447"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1448"></a><span class="c">!&gt;</span>
<a name="ln-1449"></a><span class="c">!  Alternate version of [[json_file_get_integer]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1450"></a>
<a name="ln-1451"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1452"></a>
<a name="ln-1453"></a>    <span class="k">implicit none</span>
<a name="ln-1454"></a>
<a name="ln-1455"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1456"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1457"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>    <span class="c">!! value</span>
<a name="ln-1458"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-1459"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1460"></a>
<a name="ln-1461"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1462"></a>
<a name="ln-1463"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_integer</span>
<a name="ln-1464"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1465"></a>
<a name="ln-1466"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1467"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1468"></a><span class="c">!  date: 1/20/2014</span>
<a name="ln-1469"></a><span class="c">!</span>
<a name="ln-1470"></a><span class="c">!  Get an integer vector from a JSON file.</span>
<a name="ln-1471"></a>
<a name="ln-1472"></a>    <span class="k">subroutine </span><span class="n">json_file_get_integer_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1473"></a>
<a name="ln-1474"></a>    <span class="k">implicit none</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1477"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1478"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>    <span class="c">!! the value vector</span>
<a name="ln-1479"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-1480"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_integer_vec</span>
<a name="ln-1485"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1486"></a>
<a name="ln-1487"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1488"></a><span class="c">!&gt;</span>
<a name="ln-1489"></a><span class="c">!  Alternate version of [[json_file_get_integer_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1490"></a>
<a name="ln-1491"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_integer_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1492"></a>
<a name="ln-1493"></a>    <span class="k">implicit none</span>
<a name="ln-1494"></a>
<a name="ln-1495"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1496"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1497"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1498"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1499"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1500"></a>
<a name="ln-1501"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1502"></a>
<a name="ln-1503"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_integer_vec</span>
<a name="ln-1504"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1505"></a>
<a name="ln-1506"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1507"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1508"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-1509"></a><span class="c">!</span>
<a name="ln-1510"></a><span class="c">!  Get a real(RK) variable value from a JSON file.</span>
<a name="ln-1511"></a>
<a name="ln-1512"></a>    <span class="k">subroutine </span><span class="n">json_file_get_real</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1513"></a>
<a name="ln-1514"></a>    <span class="k">implicit none</span>
<a name="ln-1515"></a>
<a name="ln-1516"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1517"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1518"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1519"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1520"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>        <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1521"></a>
<a name="ln-1522"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1523"></a>
<a name="ln-1524"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_real</span>
<a name="ln-1525"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1526"></a>
<a name="ln-1527"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1528"></a><span class="c">!&gt;</span>
<a name="ln-1529"></a><span class="c">!  Alternate version of [[json_file_get_real]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1530"></a>
<a name="ln-1531"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_real</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1532"></a>
<a name="ln-1533"></a>    <span class="k">implicit none</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1536"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1537"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1538"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1539"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>         <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1540"></a>
<a name="ln-1541"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1542"></a>
<a name="ln-1543"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_real</span>
<a name="ln-1544"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1545"></a>
<a name="ln-1546"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1547"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1548"></a><span class="c">!  date: 1/19/2014</span>
<a name="ln-1549"></a><span class="c">!</span>
<a name="ln-1550"></a><span class="c">!  Get a real(RK) vector from a JSON file.</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>    <span class="k">subroutine </span><span class="n">json_file_get_real_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1553"></a>
<a name="ln-1554"></a>    <span class="k">implicit none</span>
<a name="ln-1555"></a>
<a name="ln-1556"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1557"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1558"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1559"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>              <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1560"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1561"></a>
<a name="ln-1562"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1563"></a>
<a name="ln-1564"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_real_vec</span>
<a name="ln-1565"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1566"></a>
<a name="ln-1567"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1568"></a><span class="c">!&gt;</span>
<a name="ln-1569"></a><span class="c">!  Alternate version of [[json_file_get_real_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1570"></a>
<a name="ln-1571"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_real_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>    <span class="k">implicit none</span>
<a name="ln-1574"></a>
<a name="ln-1575"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1576"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1577"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1578"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>              <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1579"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1580"></a>
<a name="ln-1581"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1582"></a>
<a name="ln-1583"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_real_vec</span>
<a name="ln-1584"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1585"></a>
<a name="ln-1586"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-1587"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1588"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1589"></a><span class="c">!  date: 1/21/2019</span>
<a name="ln-1590"></a><span class="c">!</span>
<a name="ln-1591"></a><span class="c">!  Alternate version of [[json_file_get_real]] where `val` is `real32`.</span>
<a name="ln-1592"></a>
<a name="ln-1593"></a>    <span class="k">subroutine </span><span class="n">json_file_get_real32</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1594"></a>
<a name="ln-1595"></a>    <span class="k">implicit none</span>
<a name="ln-1596"></a>
<a name="ln-1597"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1598"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1599"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1600"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1601"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1602"></a>
<a name="ln-1603"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1604"></a>
<a name="ln-1605"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_real32</span>
<a name="ln-1606"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1607"></a>
<a name="ln-1608"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1609"></a><span class="c">!&gt;</span>
<a name="ln-1610"></a><span class="c">!  Alternate version of [[json_file_get_real32]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1611"></a>
<a name="ln-1612"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_real32</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1613"></a>
<a name="ln-1614"></a>    <span class="k">implicit none</span>
<a name="ln-1615"></a>
<a name="ln-1616"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1617"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1618"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1619"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1620"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1621"></a>
<a name="ln-1622"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1623"></a>
<a name="ln-1624"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_real32</span>
<a name="ln-1625"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1626"></a>
<a name="ln-1627"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1628"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1629"></a><span class="c">!  date: 1/21/2019</span>
<a name="ln-1630"></a><span class="c">!</span>
<a name="ln-1631"></a><span class="c">!  Alternate version of [[json_file_get_real_vec]] where `vec` is `real32`.</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a>    <span class="k">subroutine </span><span class="n">json_file_get_real32_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1634"></a>
<a name="ln-1635"></a>    <span class="k">implicit none</span>
<a name="ln-1636"></a>
<a name="ln-1637"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1638"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1639"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1640"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1641"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1644"></a>
<a name="ln-1645"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_real32_vec</span>
<a name="ln-1646"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1647"></a>
<a name="ln-1648"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1649"></a><span class="c">!&gt;</span>
<a name="ln-1650"></a><span class="c">!  Alternate version of [[json_file_get_real32_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_real32_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>    <span class="k">implicit none</span>
<a name="ln-1655"></a>
<a name="ln-1656"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1657"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1658"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1659"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1660"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1661"></a>
<a name="ln-1662"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1663"></a>
<a name="ln-1664"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_real32_vec</span>
<a name="ln-1665"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1666"></a><span class="cp">#endif</span>
<a name="ln-1667"></a>
<a name="ln-1668"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-1669"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1670"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1671"></a><span class="c">!  date: 1/21/2019</span>
<a name="ln-1672"></a><span class="c">!</span>
<a name="ln-1673"></a><span class="c">!  Alternate version of [[json_file_get_real]] where `val` is `real64`.</span>
<a name="ln-1674"></a>
<a name="ln-1675"></a>    <span class="k">subroutine </span><span class="n">json_file_get_real64</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1676"></a>
<a name="ln-1677"></a>    <span class="k">implicit none</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1680"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1681"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1682"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1683"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1684"></a>
<a name="ln-1685"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_real64</span>
<a name="ln-1688"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1689"></a>
<a name="ln-1690"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1691"></a><span class="c">!&gt;</span>
<a name="ln-1692"></a><span class="c">!  Alternate version of [[json_file_get_real64]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_real64</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1695"></a>
<a name="ln-1696"></a>    <span class="k">implicit none</span>
<a name="ln-1697"></a>
<a name="ln-1698"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1699"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1700"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1701"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1702"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1703"></a>
<a name="ln-1704"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1705"></a>
<a name="ln-1706"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_real64</span>
<a name="ln-1707"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1710"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1711"></a><span class="c">!  date: 1/21/2019</span>
<a name="ln-1712"></a><span class="c">!</span>
<a name="ln-1713"></a><span class="c">!  Alternate version of [[json_file_get_real_vec]] where `vec` is `real64`.</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a>    <span class="k">subroutine </span><span class="n">json_file_get_real64_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a>    <span class="k">implicit none</span>
<a name="ln-1718"></a>
<a name="ln-1719"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1720"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1721"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1722"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1723"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1724"></a>
<a name="ln-1725"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1726"></a>
<a name="ln-1727"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_real64_vec</span>
<a name="ln-1728"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1729"></a>
<a name="ln-1730"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1731"></a><span class="c">!&gt;</span>
<a name="ln-1732"></a><span class="c">!  Alternate version of [[json_file_get_real64_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1733"></a>
<a name="ln-1734"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_real64_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1735"></a>
<a name="ln-1736"></a>    <span class="k">implicit none</span>
<a name="ln-1737"></a>
<a name="ln-1738"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1739"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1740"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1741"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1742"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1743"></a>
<a name="ln-1744"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1745"></a>
<a name="ln-1746"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_real64_vec</span>
<a name="ln-1747"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1748"></a><span class="cp">#endif</span>
<a name="ln-1749"></a>
<a name="ln-1750"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1751"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1752"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-1753"></a><span class="c">!</span>
<a name="ln-1754"></a><span class="c">!  Get a logical(LK) value from a JSON file.</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a>    <span class="k">subroutine </span><span class="n">json_file_get_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">default</span><span class="p">)</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a>    <span class="k">implicit none</span>
<a name="ln-1759"></a>
<a name="ln-1760"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1761"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1762"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>    <span class="c">!! value</span>
<a name="ln-1763"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-1764"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1765"></a>
<a name="ln-1766"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1767"></a>
<a name="ln-1768"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_logical</span>
<a name="ln-1769"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1770"></a>
<a name="ln-1771"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1772"></a><span class="c">!&gt;</span>
<a name="ln-1773"></a><span class="c">!  Alternate version of [[json_file_get_logical]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1774"></a>
<a name="ln-1775"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">default</span><span class="p">)</span>
<a name="ln-1776"></a>
<a name="ln-1777"></a>    <span class="k">implicit none</span>
<a name="ln-1778"></a>
<a name="ln-1779"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1780"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>   <span class="c">!! the path to the variable</span>
<a name="ln-1781"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>    <span class="c">!! value</span>
<a name="ln-1782"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>  <span class="c">!! if it was really found</span>
<a name="ln-1783"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1786"></a>
<a name="ln-1787"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_logical</span>
<a name="ln-1788"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1789"></a>
<a name="ln-1790"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1791"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1792"></a><span class="c">!  date: 1/20/2014</span>
<a name="ln-1793"></a><span class="c">!</span>
<a name="ln-1794"></a><span class="c">!  Get a logical(LK) vector from a JSON file.</span>
<a name="ln-1795"></a>
<a name="ln-1796"></a>    <span class="k">subroutine </span><span class="n">json_file_get_logical_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1797"></a>
<a name="ln-1798"></a>    <span class="k">implicit none</span>
<a name="ln-1799"></a>
<a name="ln-1800"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1801"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1802"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1803"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1804"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1805"></a>
<a name="ln-1806"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1807"></a>
<a name="ln-1808"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_logical_vec</span>
<a name="ln-1809"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1810"></a>
<a name="ln-1811"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1812"></a><span class="c">!&gt;</span>
<a name="ln-1813"></a><span class="c">!  Alternate version of [[json_file_get_logical_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_logical_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1816"></a>
<a name="ln-1817"></a>    <span class="k">implicit none</span>
<a name="ln-1818"></a>
<a name="ln-1819"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1820"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1821"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! the value vector</span>
<a name="ln-1822"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1823"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1824"></a>
<a name="ln-1825"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_logical_vec</span>
<a name="ln-1828"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1829"></a>
<a name="ln-1830"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1831"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1832"></a><span class="c">!  date: 12/9/2013</span>
<a name="ln-1833"></a><span class="c">!</span>
<a name="ln-1834"></a><span class="c">!  Get a character string from a json file.</span>
<a name="ln-1835"></a><span class="c">!  The output val is an allocatable character string.</span>
<a name="ln-1836"></a>
<a name="ln-1837"></a>    <span class="k">subroutine </span><span class="n">json_file_get_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1838"></a>
<a name="ln-1839"></a>    <span class="k">implicit none</span>
<a name="ln-1840"></a>
<a name="ln-1841"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1842"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1843"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1844"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1845"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1846"></a>
<a name="ln-1847"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1848"></a>
<a name="ln-1849"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_string</span>
<a name="ln-1850"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1851"></a>
<a name="ln-1852"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1853"></a><span class="c">!&gt;</span>
<a name="ln-1854"></a><span class="c">!  Alternate version of [[json_file_get_string]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1857"></a>
<a name="ln-1858"></a>    <span class="k">implicit none</span>
<a name="ln-1859"></a>
<a name="ln-1860"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1861"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1862"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>   <span class="c">!! value</span>
<a name="ln-1863"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1864"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">val</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1867"></a>
<a name="ln-1868"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_string</span>
<a name="ln-1869"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1872"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1873"></a><span class="c">!  date: 1/19/2014</span>
<a name="ln-1874"></a><span class="c">!</span>
<a name="ln-1875"></a><span class="c">!  Get a string vector from a JSON file.</span>
<a name="ln-1876"></a>
<a name="ln-1877"></a>    <span class="k">subroutine </span><span class="n">json_file_get_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a>    <span class="k">implicit none</span>
<a name="ln-1880"></a>
<a name="ln-1881"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1882"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1883"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! value vector</span>
<a name="ln-1884"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                              <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1885"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1888"></a>
<a name="ln-1889"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_string_vec</span>
<a name="ln-1890"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1891"></a>
<a name="ln-1892"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1893"></a><span class="c">!&gt;</span>
<a name="ln-1894"></a><span class="c">!  Alternate version of [[json_file_get_string_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1895"></a>
<a name="ln-1896"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1897"></a>
<a name="ln-1898"></a>    <span class="k">implicit none</span>
<a name="ln-1899"></a>
<a name="ln-1900"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1901"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">path</span>  <span class="c">!! the path to the variable</span>
<a name="ln-1902"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>   <span class="c">!! value vector</span>
<a name="ln-1903"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                              <span class="kd">::</span> <span class="n">found</span> <span class="c">!! if it was really found</span>
<a name="ln-1904"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
<a name="ln-1907"></a>
<a name="ln-1908"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_string_vec</span>
<a name="ln-1909"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1912"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1913"></a><span class="c">!  date: 12/17/2016</span>
<a name="ln-1914"></a><span class="c">!</span>
<a name="ln-1915"></a><span class="c">!  Get an (allocatable length) string vector from a JSON file.</span>
<a name="ln-1916"></a><span class="c">!  This is just a wrapper for [[json_get_alloc_string_vec_by_path]].</span>
<a name="ln-1917"></a>
<a name="ln-1918"></a>    <span class="k">subroutine </span><span class="n">json_file_get_alloc_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">ilen</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">default_ilen</span><span class="p">)</span>
<a name="ln-1919"></a>
<a name="ln-1920"></a>    <span class="k">implicit none</span>
<a name="ln-1921"></a>
<a name="ln-1922"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1923"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span> <span class="c">!! the path to the variable</span>
<a name="ln-1924"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span> <span class="c">!! value vector</span>
<a name="ln-1925"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ilen</span> <span class="c">!! the actual length</span>
<a name="ln-1926"></a>                                                             <span class="c">!! of each character</span>
<a name="ln-1927"></a>                                                             <span class="c">!! string in the array</span>
<a name="ln-1928"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1929"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1930"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">default_ilen</span> <span class="c">!! the actual</span>
<a name="ln-1931"></a>                                                                 <span class="c">!! length of `default`</span>
<a name="ln-1932"></a>
<a name="ln-1933"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">ilen</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">default_ilen</span><span class="p">)</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a>    <span class="k">end subroutine </span><span class="n">json_file_get_alloc_string_vec</span>
<a name="ln-1936"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1937"></a>
<a name="ln-1938"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1939"></a><span class="c">!&gt;</span>
<a name="ln-1940"></a><span class="c">!  Alternate version of [[json_file_get_alloc_string_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-1941"></a><span class="c">!  This is just a wrapper for [[wrap_json_get_alloc_string_vec_by_path]].</span>
<a name="ln-1942"></a>
<a name="ln-1943"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_get_alloc_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">ilen</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">default_ilen</span><span class="p">)</span>
<a name="ln-1944"></a>
<a name="ln-1945"></a>    <span class="k">implicit none</span>
<a name="ln-1946"></a>
<a name="ln-1947"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1948"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span> <span class="c">!! the path to the variable</span>
<a name="ln-1949"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>  <span class="c">!! value vector</span>
<a name="ln-1950"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ilen</span> <span class="c">!! the actual length</span>
<a name="ln-1951"></a>                                                             <span class="c">!! of each character</span>
<a name="ln-1952"></a>                                                             <span class="c">!! string in the array</span>
<a name="ln-1953"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">found</span>
<a name="ln-1954"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">default</span>
<a name="ln-1955"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">default_ilen</span> <span class="c">!! the actual</span>
<a name="ln-1956"></a>                                                                 <span class="c">!! length of `default`</span>
<a name="ln-1957"></a>
<a name="ln-1958"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">get</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">vec</span><span class="p">,</span> <span class="n">ilen</span><span class="p">,</span> <span class="n">found</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">default_ilen</span><span class="p">)</span>
<a name="ln-1959"></a>
<a name="ln-1960"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_get_alloc_string_vec</span>
<a name="ln-1961"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1962"></a>
<a name="ln-1963"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-1964"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-1965"></a><span class="c">!</span>
<a name="ln-1966"></a><span class="c">!  Add a [[json_value]] pointer as the root object to a JSON file.</span>
<a name="ln-1967"></a><span class="c">!</span>
<a name="ln-1968"></a><span class="c">!### Note</span>
<a name="ln-1969"></a><span class="c">!</span>
<a name="ln-1970"></a><span class="c">!  This is mostly equivalent to:</span>
<a name="ln-1971"></a><span class="c">!```fortran</span>
<a name="ln-1972"></a><span class="c">!    f = [[json_file]](p)</span>
<a name="ln-1973"></a><span class="c">!```</span>
<a name="ln-1974"></a><span class="c">!  But without the finalization calls.</span>
<a name="ln-1975"></a><span class="c">!</span>
<a name="ln-1976"></a><span class="c">!  And:</span>
<a name="ln-1977"></a><span class="c">!```fortran</span>
<a name="ln-1978"></a><span class="c">!    if (destroy_original) call [[json_file]]%destroy()</span>
<a name="ln-1979"></a><span class="c">!    call [[json_file]]%add(&#39;$&#39;,p)</span>
<a name="ln-1980"></a><span class="c">!```</span>
<a name="ln-1981"></a>
<a name="ln-1982"></a>    <span class="k">subroutine </span><span class="n">json_file_add</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">destroy_original</span><span class="p">)</span>
<a name="ln-1983"></a>
<a name="ln-1984"></a>    <span class="k">implicit none</span>
<a name="ln-1985"></a>
<a name="ln-1986"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-1987"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">p</span>    <span class="c">!! pointer to the variable to add</span>
<a name="ln-1988"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">destroy_original</span> <span class="c">!! if the file currently contains</span>
<a name="ln-1989"></a>                                                             <span class="c">!! an associated pointer, it is</span>
<a name="ln-1990"></a>                                                             <span class="c">!! destroyed. [Default is True]</span>
<a name="ln-1991"></a>
<a name="ln-1992"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span> <span class="kd">::</span> <span class="n">destroy</span>   <span class="c">!! if `me%p` is to be destroyed</span>
<a name="ln-1993"></a>
<a name="ln-1994"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">destroy_original</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-1995"></a><span class="k">        </span><span class="n">destroy</span> <span class="o">=</span> <span class="n">destroy_original</span>
<a name="ln-1996"></a>    <span class="k">else</span>
<a name="ln-1997"></a><span class="k">        </span><span class="n">destroy</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">! default</span>
<a name="ln-1998"></a>    <span class="k">end if</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a><span class="k">    if</span> <span class="p">(</span><span class="n">destroy</span><span class="p">)</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">destroy</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">)</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>    <span class="n">me</span><span class="p">%</span><span class="n">p</span> <span class="o">=&gt;</span> <span class="n">p</span>
<a name="ln-2003"></a>
<a name="ln-2004"></a>    <span class="k">end subroutine </span><span class="n">json_file_add</span>
<a name="ln-2005"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2006"></a>
<a name="ln-2007"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2008"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2009"></a><span class="c">!</span>
<a name="ln-2010"></a><span class="c">!  Add a [[json_value]] pointer to an object to a JSON file.</span>
<a name="ln-2011"></a>
<a name="ln-2012"></a>    <span class="k">subroutine </span><span class="n">json_file_add_object</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2013"></a>
<a name="ln-2014"></a>    <span class="k">implicit none</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2017"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2018"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">p</span>            <span class="c">!! pointer to the variable to add</span>
<a name="ln-2019"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2020"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2021"></a>
<a name="ln-2022"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2023"></a>
<a name="ln-2024"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2025"></a>
<a name="ln-2026"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_object</span>
<a name="ln-2027"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2028"></a>
<a name="ln-2029"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2030"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2031"></a><span class="c">!</span>
<a name="ln-2032"></a><span class="c">!  Alternate version of [[json_file_add_object]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2033"></a>
<a name="ln-2034"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_object</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2035"></a>
<a name="ln-2036"></a>    <span class="k">implicit none</span>
<a name="ln-2037"></a>
<a name="ln-2038"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2039"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2040"></a>    <span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">p</span>            <span class="c">!! pointer to the variable to add</span>
<a name="ln-2041"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2042"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2043"></a>
<a name="ln-2044"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_object</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">p</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2045"></a>
<a name="ln-2046"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_object</span>
<a name="ln-2047"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2048"></a>
<a name="ln-2049"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2050"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2051"></a><span class="c">!</span>
<a name="ln-2052"></a><span class="c">!  Add an integer value to a JSON file.</span>
<a name="ln-2053"></a>
<a name="ln-2054"></a>    <span class="k">subroutine </span><span class="n">json_file_add_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2055"></a>
<a name="ln-2056"></a>    <span class="k">implicit none</span>
<a name="ln-2057"></a>
<a name="ln-2058"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2059"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2060"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2061"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2062"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2063"></a>
<a name="ln-2064"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2065"></a>
<a name="ln-2066"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_integer</span>
<a name="ln-2069"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2070"></a>
<a name="ln-2071"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2072"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2073"></a><span class="c">!</span>
<a name="ln-2074"></a><span class="c">!  Alternate version of [[json_file_add_integer]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2075"></a>
<a name="ln-2076"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2077"></a>
<a name="ln-2078"></a>    <span class="k">implicit none</span>
<a name="ln-2079"></a>
<a name="ln-2080"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2081"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2082"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2083"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2084"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2085"></a>
<a name="ln-2086"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_integer</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2087"></a>
<a name="ln-2088"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_integer</span>
<a name="ln-2089"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2092"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2093"></a><span class="c">!</span>
<a name="ln-2094"></a><span class="c">!  Add an integer vector to a JSON file.</span>
<a name="ln-2095"></a>
<a name="ln-2096"></a>    <span class="k">subroutine </span><span class="n">json_file_add_integer_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a>    <span class="k">implicit none</span>
<a name="ln-2099"></a>
<a name="ln-2100"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2101"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2102"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2103"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2104"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2105"></a>
<a name="ln-2106"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2107"></a>
<a name="ln-2108"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2109"></a>
<a name="ln-2110"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_integer_vec</span>
<a name="ln-2111"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2112"></a>
<a name="ln-2113"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2114"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2115"></a><span class="c">!</span>
<a name="ln-2116"></a><span class="c">!  Alternate version of [[json_file_add_integer_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2117"></a>
<a name="ln-2118"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_integer_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2119"></a>
<a name="ln-2120"></a>    <span class="k">implicit none</span>
<a name="ln-2121"></a>
<a name="ln-2122"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2123"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2124"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2125"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2126"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2127"></a>
<a name="ln-2128"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_integer_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_integer_vec</span>
<a name="ln-2131"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2132"></a>
<a name="ln-2133"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2134"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2135"></a><span class="c">!</span>
<a name="ln-2136"></a><span class="c">!  Add a real(RK) variable value to a JSON file.</span>
<a name="ln-2137"></a>
<a name="ln-2138"></a>    <span class="k">subroutine </span><span class="n">json_file_add_real</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2139"></a>
<a name="ln-2140"></a>    <span class="k">implicit none</span>
<a name="ln-2141"></a>
<a name="ln-2142"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2143"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2144"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2145"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2146"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2147"></a>
<a name="ln-2148"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2149"></a>
<a name="ln-2150"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2151"></a>
<a name="ln-2152"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_real</span>
<a name="ln-2153"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2154"></a>
<a name="ln-2155"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2156"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2157"></a><span class="c">!</span>
<a name="ln-2158"></a><span class="c">!  Alternate version of [[json_file_add_real]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2159"></a>
<a name="ln-2160"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_real</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2161"></a>
<a name="ln-2162"></a>    <span class="k">implicit none</span>
<a name="ln-2163"></a>
<a name="ln-2164"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2165"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2166"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2167"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2168"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_real</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2171"></a>
<a name="ln-2172"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_real</span>
<a name="ln-2173"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2174"></a>
<a name="ln-2175"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2176"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2177"></a><span class="c">!</span>
<a name="ln-2178"></a><span class="c">!  Add a real(RK) vector to a JSON file.</span>
<a name="ln-2179"></a>
<a name="ln-2180"></a>    <span class="k">subroutine </span><span class="n">json_file_add_real_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a>    <span class="k">implicit none</span>
<a name="ln-2183"></a>
<a name="ln-2184"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2185"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2186"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2187"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2188"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2189"></a>
<a name="ln-2190"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2191"></a>
<a name="ln-2192"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2193"></a>
<a name="ln-2194"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_real_vec</span>
<a name="ln-2195"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2196"></a>
<a name="ln-2197"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2198"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2199"></a><span class="c">!</span>
<a name="ln-2200"></a><span class="c">!  Alternate version of [[json_file_add_real_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2201"></a>
<a name="ln-2202"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_real_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2203"></a>
<a name="ln-2204"></a>    <span class="k">implicit none</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2207"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2208"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2209"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2210"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2211"></a>
<a name="ln-2212"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_real_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2213"></a>
<a name="ln-2214"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_real_vec</span>
<a name="ln-2215"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2216"></a>
<a name="ln-2217"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-2218"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2219"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2220"></a><span class="c">!</span>
<a name="ln-2221"></a><span class="c">!  Alternate version of [[json_file_add_real]] where `val` is `real32`.</span>
<a name="ln-2222"></a>
<a name="ln-2223"></a>    <span class="k">subroutine </span><span class="n">json_file_add_real32</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2224"></a>
<a name="ln-2225"></a>    <span class="k">implicit none</span>
<a name="ln-2226"></a>
<a name="ln-2227"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2228"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2229"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2230"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2231"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_real32</span>
<a name="ln-2236"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2237"></a>
<a name="ln-2238"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2239"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2240"></a><span class="c">!</span>
<a name="ln-2241"></a><span class="c">!  Alternate version of [[json_file_add_real32]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2242"></a>
<a name="ln-2243"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_real32</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2244"></a>
<a name="ln-2245"></a>    <span class="k">implicit none</span>
<a name="ln-2246"></a>
<a name="ln-2247"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2248"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2249"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2250"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2251"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2252"></a>
<a name="ln-2253"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_real32</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2254"></a>
<a name="ln-2255"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_real32</span>
<a name="ln-2256"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2257"></a>
<a name="ln-2258"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2259"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2260"></a><span class="c">!</span>
<a name="ln-2261"></a><span class="c">!  Alternate version of [[json_file_add_real_vec]] where `vec` is `real32`.</span>
<a name="ln-2262"></a>
<a name="ln-2263"></a>    <span class="k">subroutine </span><span class="n">json_file_add_real32_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2264"></a>
<a name="ln-2265"></a>    <span class="k">implicit none</span>
<a name="ln-2266"></a>
<a name="ln-2267"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2268"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2269"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2270"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2271"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2272"></a>
<a name="ln-2273"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_real32_vec</span>
<a name="ln-2276"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2279"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2280"></a><span class="c">!</span>
<a name="ln-2281"></a><span class="c">!  Alternate version of [[json_file_add_real32_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2282"></a>
<a name="ln-2283"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_real32_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>    <span class="k">implicit none</span>
<a name="ln-2286"></a>
<a name="ln-2287"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2288"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2289"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2290"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2291"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2292"></a>
<a name="ln-2293"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_real32_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2294"></a>
<a name="ln-2295"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_real32_vec</span>
<a name="ln-2296"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2297"></a><span class="cp">#endif</span>
<a name="ln-2298"></a>
<a name="ln-2299"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-2300"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2301"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2302"></a><span class="c">!</span>
<a name="ln-2303"></a><span class="c">!  Alternate version of [[json_file_add_real]] where `val` is `real64`.</span>
<a name="ln-2304"></a>
<a name="ln-2305"></a>    <span class="k">subroutine </span><span class="n">json_file_add_real64</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2306"></a>
<a name="ln-2307"></a>    <span class="k">implicit none</span>
<a name="ln-2308"></a>
<a name="ln-2309"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2310"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2311"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2312"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2313"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2314"></a>
<a name="ln-2315"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2316"></a>
<a name="ln-2317"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_real64</span>
<a name="ln-2318"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2319"></a>
<a name="ln-2320"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2321"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2322"></a><span class="c">!</span>
<a name="ln-2323"></a><span class="c">!  Alternate version of [[json_file_add_real64]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2324"></a>
<a name="ln-2325"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_real64</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2326"></a>
<a name="ln-2327"></a>    <span class="k">implicit none</span>
<a name="ln-2328"></a>
<a name="ln-2329"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2330"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2331"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2332"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2333"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2334"></a>
<a name="ln-2335"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_real64</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2336"></a>
<a name="ln-2337"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_real64</span>
<a name="ln-2338"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2339"></a>
<a name="ln-2340"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2341"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2342"></a><span class="c">!</span>
<a name="ln-2343"></a><span class="c">!  Alternate version of [[json_file_add_real_vec]] where `vec` is `real64`.</span>
<a name="ln-2344"></a>
<a name="ln-2345"></a>    <span class="k">subroutine </span><span class="n">json_file_add_real64_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2346"></a>
<a name="ln-2347"></a>    <span class="k">implicit none</span>
<a name="ln-2348"></a>
<a name="ln-2349"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2350"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2351"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2352"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2353"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2354"></a>
<a name="ln-2355"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2356"></a>
<a name="ln-2357"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_real64_vec</span>
<a name="ln-2358"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2359"></a>
<a name="ln-2360"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2361"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2362"></a><span class="c">!</span>
<a name="ln-2363"></a><span class="c">!  Alternate version of [[json_file_add_real64_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2364"></a>
<a name="ln-2365"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_real64_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2366"></a>
<a name="ln-2367"></a>    <span class="k">implicit none</span>
<a name="ln-2368"></a>
<a name="ln-2369"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2370"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2371"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2372"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2373"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2374"></a>
<a name="ln-2375"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_real64_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2376"></a>
<a name="ln-2377"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_real64_vec</span>
<a name="ln-2378"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2379"></a><span class="cp">#endif</span>
<a name="ln-2380"></a>
<a name="ln-2381"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2382"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2383"></a><span class="c">!</span>
<a name="ln-2384"></a><span class="c">!  Add a logical(LK) value to a JSON file.</span>
<a name="ln-2385"></a>
<a name="ln-2386"></a>    <span class="k">subroutine </span><span class="n">json_file_add_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2387"></a>
<a name="ln-2388"></a>    <span class="k">implicit none</span>
<a name="ln-2389"></a>
<a name="ln-2390"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2391"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2392"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2393"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2394"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2395"></a>
<a name="ln-2396"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2397"></a>
<a name="ln-2398"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2399"></a>
<a name="ln-2400"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_logical</span>
<a name="ln-2401"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2402"></a>
<a name="ln-2403"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2404"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2405"></a><span class="c">!</span>
<a name="ln-2406"></a><span class="c">!  Alternate version of [[json_file_add_logical]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2407"></a>
<a name="ln-2408"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2409"></a>
<a name="ln-2410"></a>    <span class="k">implicit none</span>
<a name="ln-2411"></a>
<a name="ln-2412"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2413"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2414"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2415"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2416"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2417"></a>
<a name="ln-2418"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_logical</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2419"></a>
<a name="ln-2420"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_logical</span>
<a name="ln-2421"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2422"></a>
<a name="ln-2423"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2424"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2425"></a><span class="c">!</span>
<a name="ln-2426"></a><span class="c">!  Add a logical(LK) vector to a JSON file.</span>
<a name="ln-2427"></a>
<a name="ln-2428"></a>    <span class="k">subroutine </span><span class="n">json_file_add_logical_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2429"></a>
<a name="ln-2430"></a>    <span class="k">implicit none</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2433"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2434"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2435"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2436"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2439"></a>
<a name="ln-2440"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2441"></a>
<a name="ln-2442"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_logical_vec</span>
<a name="ln-2443"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2444"></a>
<a name="ln-2445"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2446"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2447"></a><span class="c">!</span>
<a name="ln-2448"></a><span class="c">!  Alternate version of [[json_file_add_logical_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2449"></a>
<a name="ln-2450"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_logical_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>    <span class="k">implicit none</span>
<a name="ln-2453"></a>
<a name="ln-2454"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2455"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2456"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2457"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2458"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2459"></a>
<a name="ln-2460"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_logical_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">)</span>
<a name="ln-2461"></a>
<a name="ln-2462"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_logical_vec</span>
<a name="ln-2463"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2464"></a>
<a name="ln-2465"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2466"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2467"></a><span class="c">!</span>
<a name="ln-2468"></a><span class="c">!  Add a character string to a json file.</span>
<a name="ln-2469"></a>
<a name="ln-2470"></a>    <span class="k">subroutine </span><span class="n">json_file_add_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2471"></a>
<a name="ln-2472"></a>    <span class="k">implicit none</span>
<a name="ln-2473"></a>
<a name="ln-2474"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2475"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2476"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2477"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2478"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>    <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2479"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2480"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2481"></a>                                                        <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2482"></a>
<a name="ln-2483"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2484"></a>
<a name="ln-2485"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2486"></a>
<a name="ln-2487"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_string</span>
<a name="ln-2488"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2489"></a>
<a name="ln-2490"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2491"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2492"></a><span class="c">!</span>
<a name="ln-2493"></a><span class="c">!  Alternate version of [[json_file_add_string]], where &quot;path&quot; and &quot;val&quot; are kind=CDK.</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2496"></a>
<a name="ln-2497"></a>    <span class="k">implicit none</span>
<a name="ln-2498"></a>
<a name="ln-2499"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2500"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2501"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2502"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2503"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2504"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2505"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2506"></a>                                                         <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2507"></a>
<a name="ln-2508"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_string</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2509"></a>                                    <span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2510"></a>
<a name="ln-2511"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_string</span>
<a name="ln-2512"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2513"></a>
<a name="ln-2514"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2515"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2516"></a><span class="c">!</span>
<a name="ln-2517"></a><span class="c">!  Wrapper for [[json_file_add_string]] where &quot;path&quot; is kind=CDK).</span>
<a name="ln-2518"></a>
<a name="ln-2519"></a>    <span class="k">subroutine </span><span class="n">json_file_add_string_path_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2520"></a>                                                    <span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a>    <span class="k">implicit none</span>
<a name="ln-2523"></a>
<a name="ln-2524"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2525"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2526"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2527"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2528"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2529"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2530"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2531"></a>                                                         <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2532"></a>
<a name="ln-2533"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2534"></a>
<a name="ln-2535"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_string</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2536"></a>                                    <span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2537"></a>
<a name="ln-2538"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_string_path_ascii</span>
<a name="ln-2539"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2540"></a>
<a name="ln-2541"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2542"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2543"></a><span class="c">!</span>
<a name="ln-2544"></a><span class="c">!  Wrapper for [[json_file_add_string]] where &quot;val&quot; is kind=CDK).</span>
<a name="ln-2545"></a>
<a name="ln-2546"></a>    <span class="k">subroutine </span><span class="n">json_file_add_string_value_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2547"></a>                                                    <span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2548"></a>
<a name="ln-2549"></a>    <span class="k">implicit none</span>
<a name="ln-2550"></a>
<a name="ln-2551"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2552"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2553"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>          <span class="c">!! value</span>
<a name="ln-2554"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2555"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2556"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2557"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2558"></a>                                                         <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2559"></a>
<a name="ln-2560"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2561"></a>
<a name="ln-2562"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_string</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2563"></a>                                    <span class="n">was_created</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2564"></a>
<a name="ln-2565"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_string_value_ascii</span>
<a name="ln-2566"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2567"></a>
<a name="ln-2568"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2569"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2570"></a><span class="c">!</span>
<a name="ln-2571"></a><span class="c">!  Add a string vector to a JSON file.</span>
<a name="ln-2572"></a>
<a name="ln-2573"></a>    <span class="k">subroutine </span><span class="n">json_file_add_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2574"></a>                                            <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2575"></a>
<a name="ln-2576"></a>    <span class="k">implicit none</span>
<a name="ln-2577"></a>
<a name="ln-2578"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2579"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2580"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2581"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2582"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2583"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">ilen</span>         <span class="c">!! the string lengths of each</span>
<a name="ln-2584"></a>                                                                     <span class="c">!! element in `value`. If not present,</span>
<a name="ln-2585"></a>                                                                     <span class="c">!! the full `len(value)` string is added</span>
<a name="ln-2586"></a>                                                                     <span class="c">!! for each element.</span>
<a name="ln-2587"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for each element</span>
<a name="ln-2588"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for each element</span>
<a name="ln-2589"></a>                                                                     <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2590"></a>
<a name="ln-2591"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">))</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">create_object</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">ck_</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c">! create root</span>
<a name="ln-2592"></a>
<a name="ln-2593"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">add_by_path</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2594"></a>
<a name="ln-2595"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_string_vec</span>
<a name="ln-2596"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2597"></a>
<a name="ln-2598"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2599"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2600"></a><span class="c">!</span>
<a name="ln-2601"></a><span class="c">!  Alternate version of [[json_file_add_string_vec]], where &quot;path&quot; and &quot;vec&quot; are kind=CDK.</span>
<a name="ln-2602"></a>
<a name="ln-2603"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_add_string_vec</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2604"></a>                                                <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2605"></a>
<a name="ln-2606"></a>    <span class="k">implicit none</span>
<a name="ln-2607"></a>
<a name="ln-2608"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2609"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2610"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2611"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2612"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2613"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">ilen</span>         <span class="c">!! the string lengths of each</span>
<a name="ln-2614"></a>                                                                     <span class="c">!! element in `value`. If not present,</span>
<a name="ln-2615"></a>                                                                     <span class="c">!! the full `len(value)` string is added</span>
<a name="ln-2616"></a>                                                                     <span class="c">!! for each element.</span>
<a name="ln-2617"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for each element</span>
<a name="ln-2618"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for each element</span>
<a name="ln-2619"></a>                                                                     <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2620"></a>
<a name="ln-2621"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_string_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">vec</span><span class="p">),</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2622"></a>                                        <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2623"></a>
<a name="ln-2624"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_add_string_vec</span>
<a name="ln-2625"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2628"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2629"></a><span class="c">!</span>
<a name="ln-2630"></a><span class="c">!  Alternate version of [[json_file_add_string_vec]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2631"></a>
<a name="ln-2632"></a>    <span class="k">subroutine </span><span class="n">json_file_add_string_vec_path_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2633"></a>                                                    <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2634"></a>
<a name="ln-2635"></a>    <span class="k">implicit none</span>
<a name="ln-2636"></a>
<a name="ln-2637"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2638"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2639"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2640"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2641"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                 <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2642"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">ilen</span>         <span class="c">!! the string lengths of each</span>
<a name="ln-2643"></a>                                                                     <span class="c">!! element in `value`. If not present,</span>
<a name="ln-2644"></a>                                                                     <span class="c">!! the full `len(value)` string is added</span>
<a name="ln-2645"></a>                                                                     <span class="c">!! for each element.</span>
<a name="ln-2646"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for each element</span>
<a name="ln-2647"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for each element</span>
<a name="ln-2648"></a>                                                                     <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2649"></a>
<a name="ln-2650"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_string_vec</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2651"></a>                                        <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2652"></a>
<a name="ln-2653"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_string_vec_path_ascii</span>
<a name="ln-2654"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2655"></a>
<a name="ln-2656"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2657"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2658"></a><span class="c">!</span>
<a name="ln-2659"></a><span class="c">!  Alternate version of [[json_file_add_string_vec]], where &quot;vec&quot; is kind=CDK.</span>
<a name="ln-2660"></a>
<a name="ln-2661"></a>    <span class="k">subroutine </span><span class="n">json_file_add_string_vec_vec_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">vec</span><span class="p">,</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2662"></a>                                                    <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2663"></a>
<a name="ln-2664"></a>    <span class="k">implicit none</span>
<a name="ln-2665"></a>
<a name="ln-2666"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2667"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">path</span>         <span class="c">!! the path to the variable</span>
<a name="ln-2668"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vec</span>          <span class="c">!! the value vector</span>
<a name="ln-2669"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">found</span>        <span class="c">!! if the variable was found</span>
<a name="ln-2670"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">optional</span>                  <span class="kd">::</span> <span class="n">was_created</span>  <span class="c">!! if the variable had to be created</span>
<a name="ln-2671"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">ilen</span>         <span class="c">!! the string lengths of each</span>
<a name="ln-2672"></a>                                                                      <span class="c">!! element in `value`. If not present,</span>
<a name="ln-2673"></a>                                                                      <span class="c">!! the full `len(value)` string is added</span>
<a name="ln-2674"></a>                                                                      <span class="c">!! for each element.</span>
<a name="ln-2675"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                   <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for each element</span>
<a name="ln-2676"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>                   <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for each element</span>
<a name="ln-2677"></a>                                                                      <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">json_file_add_string_vec</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">vec</span><span class="p">),</span><span class="n">found</span><span class="p">,&amp;</span>
<a name="ln-2680"></a>                                        <span class="n">was_created</span><span class="p">,</span><span class="n">ilen</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2681"></a>
<a name="ln-2682"></a>    <span class="k">end subroutine </span><span class="n">json_file_add_string_vec_vec_ascii</span>
<a name="ln-2683"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2684"></a>
<a name="ln-2685"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2686"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2687"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-2688"></a><span class="c">!</span>
<a name="ln-2689"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-2690"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-2691"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-2692"></a><span class="c">!</span>
<a name="ln-2693"></a><span class="c">!### See also</span>
<a name="ln-2694"></a><span class="c">!  * [[json_update_integer]]</span>
<a name="ln-2695"></a>
<a name="ln-2696"></a>    <span class="k">subroutine </span><span class="n">json_file_update_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2697"></a>
<a name="ln-2698"></a>    <span class="k">implicit none</span>
<a name="ln-2699"></a>
<a name="ln-2700"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2701"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2702"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2703"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2704"></a>
<a name="ln-2705"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2706"></a>
<a name="ln-2707"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_integer</span>
<a name="ln-2708"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2709"></a>
<a name="ln-2710"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2711"></a><span class="c">!&gt;</span>
<a name="ln-2712"></a><span class="c">!  Alternate version of [[json_file_update_integer]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2713"></a>
<a name="ln-2714"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_integer</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2715"></a>
<a name="ln-2716"></a>    <span class="k">implicit none</span>
<a name="ln-2717"></a>
<a name="ln-2718"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2719"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2720"></a>    <span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2721"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2722"></a>
<a name="ln-2723"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2724"></a>
<a name="ln-2725"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_integer</span>
<a name="ln-2726"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2729"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2730"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-2731"></a><span class="c">!</span>
<a name="ln-2732"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-2733"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-2734"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-2735"></a><span class="c">!</span>
<a name="ln-2736"></a><span class="c">!### See also</span>
<a name="ln-2737"></a><span class="c">!  * [[json_update_logical]]</span>
<a name="ln-2738"></a>
<a name="ln-2739"></a>    <span class="k">subroutine </span><span class="n">json_file_update_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2740"></a>
<a name="ln-2741"></a>    <span class="k">implicit none</span>
<a name="ln-2742"></a>
<a name="ln-2743"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2744"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2745"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2746"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2747"></a>
<a name="ln-2748"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_logical</span>
<a name="ln-2751"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2754"></a><span class="c">!&gt;</span>
<a name="ln-2755"></a><span class="c">!  Alternate version of [[json_file_update_logical]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2756"></a>
<a name="ln-2757"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_logical</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2758"></a>
<a name="ln-2759"></a>    <span class="k">implicit none</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2762"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2763"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2764"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2765"></a>
<a name="ln-2766"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2767"></a>
<a name="ln-2768"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_logical</span>
<a name="ln-2769"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2770"></a>
<a name="ln-2771"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2772"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2773"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-2774"></a><span class="c">!</span>
<a name="ln-2775"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-2776"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-2777"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-2778"></a>
<a name="ln-2779"></a>    <span class="k">subroutine </span><span class="n">json_file_update_real</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2780"></a>
<a name="ln-2781"></a>    <span class="k">implicit none</span>
<a name="ln-2782"></a>
<a name="ln-2783"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2784"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2785"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                 <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2786"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2787"></a>
<a name="ln-2788"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2789"></a>
<a name="ln-2790"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_real</span>
<a name="ln-2791"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2792"></a>
<a name="ln-2793"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2794"></a><span class="c">!&gt;</span>
<a name="ln-2795"></a><span class="c">!  Alternate version of [[json_file_update_real]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2796"></a>
<a name="ln-2797"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_real</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2798"></a>
<a name="ln-2799"></a>    <span class="k">implicit none</span>
<a name="ln-2800"></a>
<a name="ln-2801"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2802"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2803"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">RK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2804"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2807"></a>
<a name="ln-2808"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_real</span>
<a name="ln-2809"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2810"></a>
<a name="ln-2811"></a><span class="cp">#ifndef REAL32</span>
<a name="ln-2812"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2813"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2814"></a><span class="c">!  date: 1/21/2019</span>
<a name="ln-2815"></a><span class="c">!</span>
<a name="ln-2816"></a><span class="c">!  Alternate version of [[json_file_update_real]] where `val` is `real32`.</span>
<a name="ln-2817"></a>
<a name="ln-2818"></a>    <span class="k">subroutine </span><span class="n">json_file_update_real32</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2819"></a>
<a name="ln-2820"></a>    <span class="k">implicit none</span>
<a name="ln-2821"></a>
<a name="ln-2822"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2823"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2824"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2825"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2826"></a>
<a name="ln-2827"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">RK</span><span class="p">),</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2828"></a>
<a name="ln-2829"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_real32</span>
<a name="ln-2830"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2831"></a>
<a name="ln-2832"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2833"></a><span class="c">!&gt;</span>
<a name="ln-2834"></a><span class="c">!  Alternate version of [[json_file_update_real32]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2835"></a>
<a name="ln-2836"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_real32</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2837"></a>
<a name="ln-2838"></a>    <span class="k">implicit none</span>
<a name="ln-2839"></a>
<a name="ln-2840"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2841"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2842"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2843"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2844"></a>
<a name="ln-2845"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2846"></a>
<a name="ln-2847"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_real32</span>
<a name="ln-2848"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2849"></a><span class="cp">#endif</span>
<a name="ln-2850"></a>
<a name="ln-2851"></a><span class="cp">#ifdef REAL128</span>
<a name="ln-2852"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2853"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2854"></a><span class="c">!  date: 1/21/2019</span>
<a name="ln-2855"></a><span class="c">!</span>
<a name="ln-2856"></a><span class="c">!  Alternate version of [[json_file_update_real]] where `val` is `real64`.</span>
<a name="ln-2857"></a>
<a name="ln-2858"></a>    <span class="k">subroutine </span><span class="n">json_file_update_real64</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a>    <span class="k">implicit none</span>
<a name="ln-2861"></a>
<a name="ln-2862"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2863"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2864"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2865"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="kt">real</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">RK</span><span class="p">),</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2868"></a>
<a name="ln-2869"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_real64</span>
<a name="ln-2870"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2871"></a>
<a name="ln-2872"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2873"></a><span class="c">!&gt;</span>
<a name="ln-2874"></a><span class="c">!  Alternate version of [[json_file_update_real64]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2875"></a>
<a name="ln-2876"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_real64</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2877"></a>
<a name="ln-2878"></a>    <span class="k">implicit none</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2881"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2882"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2883"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2884"></a>
<a name="ln-2885"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">)</span>
<a name="ln-2886"></a>
<a name="ln-2887"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_real64</span>
<a name="ln-2888"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2889"></a><span class="cp">#endif</span>
<a name="ln-2890"></a>
<a name="ln-2891"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2892"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2893"></a><span class="c">!  date: 1/10/2015</span>
<a name="ln-2894"></a><span class="c">!</span>
<a name="ln-2895"></a><span class="c">!  Given the path string, if the variable is present in the file,</span>
<a name="ln-2896"></a><span class="c">!  and is a scalar, then update its value.</span>
<a name="ln-2897"></a><span class="c">!  If it is not present, then create it and set its value.</span>
<a name="ln-2898"></a><span class="c">!</span>
<a name="ln-2899"></a><span class="c">!### See also</span>
<a name="ln-2900"></a><span class="c">!  * [[json_update_string]]</span>
<a name="ln-2901"></a>
<a name="ln-2902"></a>    <span class="k">subroutine </span><span class="n">json_file_update_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2903"></a>
<a name="ln-2904"></a>    <span class="k">implicit none</span>
<a name="ln-2905"></a>
<a name="ln-2906"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2907"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2908"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2909"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2910"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2911"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>     <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2912"></a>                                                        <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2913"></a>
<a name="ln-2914"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span> <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2915"></a>
<a name="ln-2916"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_string</span>
<a name="ln-2917"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2918"></a>
<a name="ln-2919"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2920"></a><span class="c">!&gt;</span>
<a name="ln-2921"></a><span class="c">!  Alternate version of [[json_file_update_string]], where &quot;path&quot; and &quot;val&quot; are kind=CDK.</span>
<a name="ln-2922"></a>
<a name="ln-2923"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_update_string</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2924"></a>
<a name="ln-2925"></a>    <span class="k">implicit none</span>
<a name="ln-2926"></a>
<a name="ln-2927"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2928"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2929"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2930"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2931"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2932"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2933"></a>                                                         <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2934"></a>
<a name="ln-2935"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2936"></a>
<a name="ln-2937"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_update_string</span>
<a name="ln-2938"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2939"></a>
<a name="ln-2940"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2941"></a><span class="c">!&gt;</span>
<a name="ln-2942"></a><span class="c">!  Alternate version of [[json_file_update_string]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-2943"></a>
<a name="ln-2944"></a>    <span class="k">subroutine </span><span class="n">json_file_update_string_name_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2945"></a>
<a name="ln-2946"></a>    <span class="k">implicit none</span>
<a name="ln-2947"></a>
<a name="ln-2948"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2949"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2950"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2951"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2952"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2953"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2954"></a>                                                         <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2955"></a>
<a name="ln-2956"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2957"></a>
<a name="ln-2958"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_string_name_ascii</span>
<a name="ln-2959"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2960"></a>
<a name="ln-2961"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2962"></a><span class="c">!&gt;</span>
<a name="ln-2963"></a><span class="c">!  Alternate version of [[json_file_update_string]], where &quot;val&quot; is kind=CDK.</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a>    <span class="k">subroutine </span><span class="n">json_file_update_string_val_ascii</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2966"></a>
<a name="ln-2967"></a>    <span class="k">implicit none</span>
<a name="ln-2968"></a>
<a name="ln-2969"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2970"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span> <span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span>
<a name="ln-2971"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">val</span>
<a name="ln-2972"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">found</span>
<a name="ln-2973"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">trim_str</span>     <span class="c">!! if TRIM() should be called for the `val`</span>
<a name="ln-2974"></a>    <span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>      <span class="kd">::</span> <span class="n">adjustl_str</span>  <span class="c">!! if ADJUSTL() should be called for the `val`</span>
<a name="ln-2975"></a>                                                         <span class="c">!! (note that ADJUSTL is done before TRIM)</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">update</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="n">found</span><span class="p">,</span><span class="n">trim_str</span><span class="p">,</span><span class="n">adjustl_str</span><span class="p">)</span>
<a name="ln-2978"></a>
<a name="ln-2979"></a>    <span class="k">end subroutine </span><span class="n">json_file_update_string_val_ascii</span>
<a name="ln-2980"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2981"></a>
<a name="ln-2982"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-2983"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-2984"></a><span class="c">!  date: 6/11/2016</span>
<a name="ln-2985"></a><span class="c">!</span>
<a name="ln-2986"></a><span class="c">!  Traverse the JSON structure in the file.</span>
<a name="ln-2987"></a><span class="c">!  This routine calls the user-specified [[json_traverse_callback_func]]</span>
<a name="ln-2988"></a><span class="c">!  for each element of the structure.</span>
<a name="ln-2989"></a>
<a name="ln-2990"></a>    <span class="k">subroutine </span><span class="n">json_file_traverse</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">traverse_callback</span><span class="p">)</span>
<a name="ln-2991"></a>
<a name="ln-2992"></a>    <span class="k">implicit none</span>
<a name="ln-2993"></a>
<a name="ln-2994"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">me</span>
<a name="ln-2995"></a>    <span class="k">procedure</span><span class="p">(</span><span class="n">json_traverse_callback_func</span><span class="p">)</span> <span class="kd">::</span> <span class="n">traverse_callback</span>
<a name="ln-2996"></a>
<a name="ln-2997"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">traverse</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">traverse_callback</span><span class="p">)</span>
<a name="ln-2998"></a>
<a name="ln-2999"></a>    <span class="k">end subroutine </span><span class="n">json_file_traverse</span>
<a name="ln-3000"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-3003"></a><span class="c">!&gt; author: Jacob Williams</span>
<a name="ln-3004"></a><span class="c">!  date: 7/7/2018</span>
<a name="ln-3005"></a><span class="c">!</span>
<a name="ln-3006"></a><span class="c">!  Remove a variable from a JSON file.</span>
<a name="ln-3007"></a><span class="c">!</span>
<a name="ln-3008"></a><span class="c">!@note This is just a wrapper to [[remove_if_present]].</span>
<a name="ln-3009"></a>
<a name="ln-3010"></a>    <span class="k">subroutine </span><span class="n">json_file_remove</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
<a name="ln-3011"></a>
<a name="ln-3012"></a>    <span class="k">implicit none</span>
<a name="ln-3013"></a>
<a name="ln-3014"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">me</span>
<a name="ln-3015"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span> <span class="c">!! the path to the variable</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">core</span><span class="p">%</span><span class="n">remove_if_present</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
<a name="ln-3018"></a>
<a name="ln-3019"></a>    <span class="k">end subroutine </span><span class="n">json_file_remove</span>
<a name="ln-3020"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-3021"></a>
<a name="ln-3022"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-3023"></a><span class="c">!&gt;</span>
<a name="ln-3024"></a><span class="c">!  Alternate version of [[json_file_remove]], where &quot;path&quot; is kind=CDK.</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a>    <span class="k">subroutine </span><span class="n">wrap_json_file_remove</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
<a name="ln-3027"></a>
<a name="ln-3028"></a>    <span class="k">implicit none</span>
<a name="ln-3029"></a>
<a name="ln-3030"></a><span class="k">    class</span><span class="p">(</span><span class="n">json_file</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">me</span>
<a name="ln-3031"></a>    <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CDK</span><span class="p">,</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">path</span> <span class="c">!! the path to the variable</span>
<a name="ln-3032"></a>
<a name="ln-3033"></a>    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">remove</span><span class="p">(</span><span class="n">to_unicode</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
<a name="ln-3034"></a>
<a name="ln-3035"></a>    <span class="k">end subroutine </span><span class="n">wrap_json_file_remove</span>
<a name="ln-3036"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-3037"></a>
<a name="ln-3038"></a><span class="c">!*****************************************************************************************</span>
<a name="ln-3039"></a>    <span class="k">end module </span><span class="n">json_file_module</span>
<a name="ln-3040"></a><span class="c">!*****************************************************************************************</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-08-16 23:17  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> JSON-Fortran was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>